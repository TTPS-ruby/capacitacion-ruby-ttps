<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>TTPS: ruby</title>

  <meta name="viewport" content="width=device-width"/>

  <link rel="stylesheet" href="./css/reset.css" type="text/css"/>
  <link rel="stylesheet" href="./css/showoff.css" type="text/css"/>

  <link type="text/css" href="./css/fg.menu.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/theme/ui.all.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/sh_style.css" rel="stylesheet" />

  <script type="text/javascript" src="./js/jquery-1.7.2.min.js"></script>
  <script type="text/javascript" src="./js/jquery.cycle.all.js"></script>
	<script type="text/javascript" src="./js/jquery-print.js"></script>
  <script type="text/javascript" src="./js/jquery.batchImageLoad.js"></script>

  <script type="text/javascript" src="./js/jquery.doubletap-0.1.js"></script>

  <script type="text/javascript" src="./js/fg.menu.js"></script>
  <script type="text/javascript" src="./js/showoff.js"></script>
  <script type="text/javascript" src="./js/jTypeWriter.js"> </script>
  <script type="text/javascript" src="./js/sh_main.min.js"></script>
  <script type="text/javascript" src="./js/core.js"></script>
  <script type="text/javascript" src="./js/showoffcore.js"></script>
  <script type="text/javascript" src="./js/coffee-script.js"></script>

  
    
      <script type="text/javascript" src="./js/sh_lang/sh_ruby.min.js"></script>
    
      <script type="text/javascript" src="./js/sh_lang/sh_java.min.js"></script>
    
      <script type="text/javascript" src="./js/sh_lang/sh_html.min.js"></script>
    
      <script type="text/javascript" src="./js/sh_lang/sh_sql.min.js"></script>
    
      <script type="text/javascript" src="./js/sh_lang/sh_bash.min.js"></script>
    
      <script type="text/javascript" src="./js/sh_lang/sh_yaml.min.js"></script>
    
  

  
    <link rel="stylesheet" href="./file/base.css" type="text/css"/>
  

  

  <script type="text/javascript">
  $(function(){
      setupPreso(false, './');
  });
  </script>

</head>

<body>

<a tabindex="0" href="#search-engines" class="fg-button fg-button-icon-right ui-widget ui-state-default ui-corner-all" id="navmenu"><span class="ui-icon ui-icon-triangle-1-s"></span>slides</a>
<div id="navigation" class="hidden"></div>

<div id="help">
  <table>
    <tr><td class="key">z, ?</td><td>toggle help (this)</td></tr>
    <tr><td class="key">space, &rarr;</td><td>next slide</td></tr>
    <tr><td class="key">shift-space, &larr;</td><td>previous slide</td></tr>
    <tr><td class="key">d</td><td>toggle debug mode</td></tr>
    <tr><td class="key">## &lt;ret&gt;</td><td>go to slide #</td></tr>
    <tr><td class="key">c, t</td><td>table of contents (vi)</td></tr>
    <tr><td class="key">f</td><td>toggle footer</td></tr>
    <tr><td class="key">r</td><td>reload slides</td></tr>
    <tr><td class="key">n</td><td>toggle notes</td></tr>
    <tr><td class="key">p</td><td>run preshow</td></tr>
    <tr><td class="key">P</td><td>toggle pause</td></tr>
  </table>
</div>

<div class="buttonNav">
  <input type="submit" onClick="prevStep();" value="prev"/>
  <input type="submit" onClick="nextStep();" value="next"/>
</div>

<div id="preso">loading presentation...</div>
<div id="footer">
  <span id="slideInfo"></span>
  <span id="debugInfo"></span>
  <span id="notesInfo"></span>
</div>

<div id="slides" class="offscreen" style="display:none;">
<div class="slide" data-transition="none"><div class="content center" ref="00-presentacion/01_slide/1">
<p><img src="./file/00-presentacion/ruby.png" alt="Ruby logo"/>

<h1>Tecnolog&#xED;as de Producci&#xF3;n de Software</h1>

<h2>Opci&#xF3;n Ruby</h2>
</p>
</div>
</div><div class="slide" data-transition="uncover">
  <div class="content smbullets" ref="00-presentacion/01_slide/2">
<h1>La c&#xE1;tedra</h1>

<ul>
<li><strong>Profesor:</strong> Lic. Christian A. Rodr&#xED;guez 
<a href="mailto:car@info.unlp.edu.ar" title="car@info.unlp.edu.ar"><img src="./file/00-presentacion/mail.png" alt="car@info.unlp.edu.ar"/>
<a href="https://twitter.com/car_unlp" title="twitter"><img src="./file/00-presentacion/twitter.png" alt="twitter"/>
<a href="https://github.com/chrodriguez" title="github"><img src="./file/00-presentacion/github.png" alt="github"/></a>
<li><strong>JTP:</strong> APU Fernando L&#xF3;pez
<a href="mailto:flopez@linti.unlp.edu.ar" title="flopez@linti.unlp.edu.ar"><img src="./file/00-presentacion/mail.png" alt="flopez@linti.unlp.edu.ar"/>
<a href="https://github.com/fernandolopez" title="github"><img src="./file/00-presentacion/github.png" alt="github"/></a>
<li><strong>Ayudantes:</strong> 

<ul>
<li>Lic. Patricio Mac Adden
<a href="mailto:patriciomacadden@gmail.com" title="patriciomacadden@gmail.com"><img src="./file/00-presentacion/mail.png" alt="patriciomacadden@gmail.com"/>
<a href="https://twitter.com/maxawen" title="twitter"><img src="./file/00-presentacion/twitter.png" alt="twitter"/>
<a href="https://github.com/patriciomacadden" title="github"><img src="./file/00-presentacion/github.png" alt="github"/></a>
<li>Fernando Martinez
<a href="mailto:fernando.martinez@live.com.ar" title="rapofran@gmail.com"><img src="./file/00-presentacion/mail.png" alt="fernando.martinez@live.com.ar"/>
<a href="https://twitter.com/F_3r" title="twitter"><img src="./file/00-presentacion/twitter.png" alt="twitter"/>
<a href="https://github.com/f-3r" title="github"><img src="./file/00-presentacion/github.png" alt="github"/></a>
</a></a>
</li>
</a>
</a>
</li></ul></li></a></li></a></a></li></ul></div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="00-presentacion/01_slide/3">
<h1>Horarios de cursada</h1>

<ul>
<li><strong>Lunes de 19 a 21 Aula 1-1</strong></li>
<li><strong>Jueves de 19 a 21 Aula 1-1</strong></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="00-presentacion/01_slide/4">
<h1>Programa</h1>

<ul>
<li>Metodolog&#xED;as &#xE1;giles</li>
<li>Sistemas de control de versiones: GIT</li>
<li>El lenguaje Ruby

<ul>
<li>Introducci&#xF3;n</li>
<li>VMs: MRI, Rubinius, jRuby</li>
<li>Preparaci&#xF3;n del entorno</li>
<li>Objetos, arreglos, hashes, s&#xED;mbolos, tipos est&#xE1;ndar</li>
<li>Estructuras de control</li>
<li>Bloques e iteradores</li>
<li>E/S estandar</li>
<li>Clases de objetos, m&#xE9;todos y variables</li>
<li>M&#xF3;dulos y mixins</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="00-presentacion/01_slide/5">
<h1>Programa</h1>

<ul>
<li>TDD</li>
<li>Gemas: rubygems</li>
<li>Rake</li>
<li>Bundler</li>
<li>HTTP</li>
<li>La web

<ul>
<li>Rack</li>
<li>Sinatra</li>
<li>ORMs</li>
<li>Rails</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="00-presentacion/01_slide/6">
<h1>Modalidad de cursada</h1>

<ul>
<li>Clases te&#xF3;rico pr&#xE1;cticas: generalmente avanzaremos con las teor&#xED;as los d&#xED;as
Lunes, dejando los Jueves para consultas o talleres pr&#xE1;cticos</li>
<li>Aprobaci&#xF3;n de la cursada: <em>ser&#xE1; necesario aprobar</em>

<ul>
<li>Entregas de un ejercicio por pr&#xE1;ctico que se desarrollar&#xE1; en clase. Habr&#xE1;
una evaluaci&#xF3;n por pr&#xE1;ctico (salvo el primero)</li>
<li>Trabajo pr&#xE1;ctico final integrador</li>
</ul></li>
<li>Aprobaci&#xF3;n de la materia mediante extensi&#xF3;n del trabajo pr&#xE1;ctico y coloquio</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="00-presentacion/01_slide/7">
<h1>Bibliograf&#xED;a / Recursos</h1>

<ul>
<li>A medida que se presenten los temas se indicar&#xE1;n las fuentes apropiadas</li>
<li>Todo el material se encuentra bajo licencia <strong>Creative Commons</strong>:</li>
</ul>

<p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.es"><img alt="Licencia Creative Commons" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png"/></a><br/><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">TTPS - Opcion
Ruby</span> por <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Christian A. Rodriguez</span> se encuentra bajo
una <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.es">Licencia
Creative Commons Atribuci&#xF3;n-NoComercial-CompartirIgual 3.0 Unported</a>.</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="01-agiles/01_slide/1">
<h1>Metodolog&#xED;as &#xC1;giles</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="01-agiles/01_slide/2">
<h1>Temas</h1>

<ul>
<li>Introducci&#xF3;n al proceso del software</li>
<li>Metodolog&#xED;as Tradicionales</li>
<li>Metodolog&#xED;as &#xC1;giles</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="01-agiles/02_proceso_software/1">
<h1>Introducci&#xF3;n al proceso del software</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="01-agiles/02_proceso_software/2">
<h1>Mejora de los procesos de producci&#xF3;n</h1>

<ul>
<li>Todo proyecto necesita ser ejecutado y entregado bajo ciertas restricciones</li>
<li>Estas restricciones son:

<ul>
<li>Alcance</li>
<li>Plazo</li>
<li>Costo</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="01-agiles/02_proceso_software/3">
<h1>Mejora de los procesos de producci&#xF3;n</h1>

<p><img src="./file/01-agiles/triangulo-gestion-proyectos.png" alt="triangulo"/>

<ul>
<li>Tri&#xE1;ngulo de la Gesti&#xF3;n de Proyectos

<ul>
<li>Cada lado del tri&#xE1;ngulo representa una restricci&#xF3;n</li>
<li>Un lado no podr&#xE1; ser modificado sin impactar a los otros</li>
</ul></li>
</ul>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets incremental" ref="01-agiles/02_proceso_software/4">
<h1>&#xBF;Qu&#xE9; es lo que queremos conseguir?</h1>

<ul>
<li>Mayor <strong>productividad</strong>

<ul>
<li><em>Relaci&#xF3;n entre los resultados y el tiempo utilizado para obtenerlos</em></li>
</ul></li>
<li>Mayor <strong>calidad</strong>

<ul>
<li><em>Que el producto final satisfaga las necesidades del usuario</em></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets incremental" ref="01-agiles/02_proceso_software/5">
<h1>&#xC1;mbitos de mejora en Ingenier&#xED;a de software</h1>

<ul>
<li><strong>Notaci&#xF3;n:</strong> lenguajes</li>
<li><strong>Herramientas:</strong> IDEs, frameworks</li>
<li><strong>Procesos:</strong> <em>metodolog&#xED;as</em></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="01-agiles/02_proceso_software/6">
<h1>Un modelo de proceso a <em>medida</em></h1>

<ul>
<li><span class="letter_box" style="background-color: yellow">P</span> Planificaci&#xF3;n</li>
<li><span class="letter_box" style="background-color: #FFCC33">R</span> Requisitos</li>
<li><span class="letter_box" style="background-color: #FF3366">D</span>
Arquitectura y dise&#xF1;o</li>
<li><span class="letter_box" style="background-color: #CCCCFF">C</span>
Codificaci&#xF3;n (programaci&#xF3;n)</li>
<li><span class="letter_box" style="background-color: #66FF99">T</span> Testeo de
aceptaci&#xF3;n</li>
<li><span class="letter_box" style="background-color: #B0B0B0">D</span> Despliegue
(deployment)</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content" ref="01-agiles/02_proceso_software/7">
<h1>Proceso secuencial</h1>

<h2>En este ejemplo no hay solapamiento</h2>

<p><img src="./file/01-agiles/01-proceso-secuencial.png" alt="proceso secuencial"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content" ref="01-agiles/02_proceso_software/8">
<h1>Proceso en cascada</h1>

<h2>Es mejor solapar trabajo</h2>

<p><img src="./file/01-agiles/02-proceso-cascada.png" alt="proceso en cascada"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content" ref="01-agiles/02_proceso_software/9">
<h1>Proceso incremental</h1>

<p><img src="./file/01-agiles/03-proceso-incremental.png" alt="proceso incremental"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content" ref="01-agiles/02_proceso_software/10">
<h1>Proceso incremental</h1>

<h2>Mejor hacer <em>todo</em> incremental</h2>

<p><img src="./file/01-agiles/04-proceso-incremental-completo.png" alt="proceso incremental"/>

<p><em>Pero... &#xBF;C&#xF3;mo planificar sin saber qu&#xE9; hacer?</em></p>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content" ref="01-agiles/02_proceso_software/11">
<h1>Proceso incremental con fase de exploraci&#xF3;n</h1>

<p><img src="./file/01-agiles/05-proceso-incremental-exploracion.png" alt="proceso incremental"/>

<p><em>&#xBF;Si deseamos obtener validaciones frecuentes con el cliente?</em></p>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content" ref="01-agiles/02_proceso_software/12">
<h1>Proceso iterativo e incremental</h1>

<p><img src="./file/01-agiles/06-proceso-iterativo-incremental.png" alt="proceso incremental">
<em>&#xBF;Y con pruebas de regresi&#xF3;n entre iteraciones?</em></img>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="01-agiles/02_proceso_software/13">
<p><img src="./file/01-agiles/07-proceso-iterativo-incremental-regresion.png" alt="proceso incremental"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="01-agiles/02_proceso_software/14">
<h1>Modelos de proceso y metodolog&#xED;as</h1>

<ul>
<li>Aportan disciplina a la Ingenier&#xED;a de Software</li>
<li>Un modelo de proceso es una estrategia <em>global</em> respecto de c&#xF3;mo
abordar un proyecto</li>
<li>Una <strong>metodolog&#xED;a</strong> define <strong>Qui&#xE9;n</strong> debe hacer <strong>Qu&#xE9;</strong>, <strong>Cu&#xE1;ndo</strong> y <strong>C&#xF3;mo</strong>
debe hacerlo

<ul>
<li>Metodolog&#xED;as tradicionales</li>
<li>Metodolog&#xED;as &#xE1;giles</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="01-agiles/02_proceso_software/15">
<h1>Actividad</h1>

<h2>The Hard Choice Game</h2>

<p class="notes">Se requieren unos 40 minutos para realizar la actividad. Se trata de una
sencilla e interesante actividad para ilustrar el concepto de Deuda T&#xE9;cnica.
Pero m&#xE1;s all&#xE1; de dicho prop&#xF3;sito, esta actividad permite motivar al inicio de un curso, 
lo diferente que es una estrategia de trabajo en equipo respecto de una estrategia 
de trabajo individual. Ver m&#xE1;s en https://github.com/TTPS-ruby/capacitacion-ruby-ttps/blob/master/actividades/01-agiles/hard_choices.md</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="01-agiles/02_proceso_software/16">
<h1>Sobre el juego</h1>

<h2>Reglas b&#xE1;sicas</h2>

<ul>
<li>Armar grupos de no m&#xE1;s de 5 personas y no menos de 2</li>
<li>Cada persona utilizar&#xE1; una ficha y lanzar&#xE1; en turnos el los dados</li>
<li>Arrancar&#xE1; el jugador que lance el n&#xFA;mero m&#xE1;s alto</li>
<li>Los turnos son en sentido horario</li>
<li>Al llegar a la meta:

<ul>
<li>El primer jugador en llegar obtiene <strong>5 puntos</strong></li>
<li>El segundo <strong>2 puntos</strong></li>
<li>El tercero <strong>1 punto</strong></li>
</ul></li>
<li>El juego termina cuando hayan llegado tres jugadores a la meta, el resto <strong>no
cuenta</strong></li>
<li>No es necesario caer exactamente en la celda de la meta para finalizar</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="01-agiles/02_proceso_software/17">
<h1>Sobre el juego</h1>

<h2>Puntuaci&#xF3;n</h2>

<ul>
<li>Cuando se cae en una celda de herramienta se <strong>recoge una tarjeta de
herramienta</strong>

<ul>
<li><em>Las tarjetas de herramienta dar&#xE1;n un punto adicional en el c&#xF3;mputo del
jugador</em></li>
</ul></li>
<li>Cuando se cae o pasa por un puente se recoge una tarjeta de puente. 

<ul>
<li><em>Las tarjetas de puente restar&#xE1;n un punto en el c&#xF3;mputo del jugador</em></li>
</ul></li>
<li>Un jugador en su turno puede <strong>cambiar de direcci&#xF3;n</strong>, es decir, puede volver
hacia atr&#xE1;s para intentar caer en una celda de herramienta <em>luego de haber
lanzado los dados</em></li>
<li>Caer sobre la ficha de otro jugador le devuelve al inicio :-)</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="01-agiles/02_proceso_software/18">
<h1>Empieza el juego</h1>

<h2>Ronda 1</h2>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="01-agiles/02_proceso_software/19">
<h1>Nueva jugada</h1>

<h2>Ronda 2: cambian las reglas</h2>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="01-agiles/02_proceso_software/20">
<h1>Nuevas reglas</h1>

<ul>
<li>Solo jugamos por 6 minutos</li>
<li>Ajustamos el
<a href="http://www.online-stopwatch.com/full-screen-stopwatch/">cron&#xF3;metro</a></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets incremental" ref="01-agiles/02_proceso_software/21">
<h1>Conclusiones</h1>

<ul>
<li>&#xBF;Qu&#xE9; estrategias utilizaron?</li>
<li>&#xBF;Como fu&#xE9; el comportamiento de los participantes en cada tablero?

<ul>
<li><strong>Ronda 1:</strong> relajaci&#xF3;n, apat&#xED;a y ego&#xED;smo. La argentinidad al palo...</li>
<li><strong>Ronda 2:</strong> tensi&#xF3;n, colaboraci&#xF3;n e incluso sacrificio si alguien dej&#xF3; de 
jugar</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets incremental small" ref="01-agiles/02_proceso_software/22">
<h1>Comparamos con un proyecto de software</h1>

<ul>
<li>El tiempo establecido es el plazo del proyecto.

<ul>
<li>Hay muchas formas de llegar a la meta</li>
</ul></li>
<li>Recoger herramientas es aplicar buenas pr&#xE1;cticas de ingenier&#xED;a de software</li>
<li>Utilizar puentes o atajos es saltarse dichas buenas pr&#xE1;cticas 

<ul>
<li>No esforzarse por conseguir una arquitectura ideal</li>
</ul></li>
<li><strong><em>Sin embargo, para el &#xE9;xito del proyecto puede que no sea tan determinante una
buena arquitectura respecto de entregar un producto que cumple con las expectativas
del cliente y en el plazo oportuno</em></strong>

<ul>
<li><em>No se puede estar eternamente eligiendo herramientas</em></li>
<li><em>Tampoco tiene sentido llegar a la meta con un producto muy pobre en arquitectura lo cual
puede ocasionar problemas en el posterior mantenimiento</em></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="01-agiles/03_intro_tradicional/1">
<h1>Metodolog&#xED;as Tradicionales</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="01-agiles/03_intro_tradicional/2">
<h1>Introducci&#xF3;n</h1>

<ul>
<li><strong>RUP (Rational Unified Process)</strong> es la metodolog&#xED;a tardicional m&#xE1;s conocida
y mejor documentada</li>
<li>Actualmente es un producto de IBM, pero su esencia est&#xE1; descrita en el libro
<em><a href="http://books.google.com.ar/books/about/The_Unified_Software_Development_Process.html?id=p6-KQlg9IVUC&amp;redir_esc=y">The Unified Software Development
Process</a></em> </li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="01-agiles/03_intro_tradicional/3">
<h1>Elementos RUP</h1>

<h2>Workflows o disciplinas</h2>

<ul>
<li><strong>Workflows primarios</strong>

<ul>
<li>Business Modeling (Modado del Negocio)</li>
<li>Requirements (Requisitos)</li>
<li>Analysis &amp; Design (An&#xE1;lisis y Dise&#xF1;o)</li>
<li>Implementation (Implementaci&#xF3;n)</li>
<li>Test (Pruebas)</li>
<li>Deployment (Despliegue)</li>
</ul></li>
<li><strong>Workflows de Apoyo</strong>

<ul>
<li>Environment (Entorno)</li>
<li>Project Management (Gesti&#xF3;n del Proyecto)</li>
<li>Configuration &amp; Change Management (Gesti&#xF3;n de
Configuraci&#xF3;n y Cambios)</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="01-agiles/03_intro_tradicional/4">
<h1>Elementos RUP</h1>

<h2>Roles y actividades</h2>

<ul>
<li>Analyst

<ul>
<li>Business-Process Analyst</li>
<li>Business Designer</li>
<li>Business-Model Reviewer</li>
<li>Requirements Reviewer</li>
<li>System Analyst</li>
<li>Use-Case Specifier</li>
<li>User-Interface Designer</li>
</ul></li>
<li>Developer

<ul>
<li>Architect</li>
<li>Architecture Reviewer</li>
<li>Capsule Designer</li>
<li>Code Reviewer</li>
<li>Database Designer</li>
<li>Design Reviewer</li>
<li>Designer</li>
<li>Implementer</li>
<li>Integrator</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="01-agiles/03_intro_tradicional/5">
<h1>Elementos RUP</h1>

<h2>Roles y actividades</h2>

<ul>
<li>Testing professional

<ul>
<li>Test Designer</li>
<li>Tester</li>
</ul></li>
<li>Manager

<ul>
<li>Change Control Manager</li>
<li>Configuration Manager</li>
<li>Deployment Manager</li>
<li>Process Engineer</li>
<li>Project Manager</li>
<li>Project Reviewer</li>
</ul></li>
<li>Other

<ul>
<li>Course Developer</li>
<li>Graphic Artist</li>
<li>Stakeholder</li>
<li>System Administrator</li>
<li>Technical Writer</li>
<li>Tool Specialist</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="01-agiles/03_intro_tradicional/6">
<h1>Caracter&#xED;sticas esenciales de RUP</h1>

<ul>
<li>Proceso Dirigido por los Casos de Uso</li>
<li>Proceso Iterativo e Incremental</li>
<li>Proceso Centrado en la Arquitectura</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="01-agiles/03_intro_tradicional/7">
<h1>Proceso Dirigido por los Casos de Uso</h1>

<h2>&#xBF;Como es el proceso?</h2>

<p><img src="./file/01-agiles/08-rup-casos-de-uso.png" alt="Proceso dirigido por los casos de uso"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="01-agiles/03_intro_tradicional/8">
<h1>Proceso Iterativo e Incremental</h1>

<ul>
<li>El ciclo de vida iterativo se basa en la evoluci&#xF3;n de prototipos ejecutables 
que se muestran a los usuarios y clientes</li>
<li>En el ciclo de vida iterativo a cada iteraci&#xF3;n se reproduce el ciclo de vida 
en cascada a menor escala</li>
<li>Los objetivos de una iteraci&#xF3;n se establecen en funci&#xF3;n de la evaluaci&#xF3;n de 
las iteraciones precedentes</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="01-agiles/03_intro_tradicional/9">
<h1>Proceso Iterativo e Incremental</h1>

<p>Para cada caso de uso implementado en la iteraci&#xF3;n, sus actividades se encadenan
en una mini cascada</p>

<p><img src="./file/01-agiles/09-rup-mini-cascada.png" alt="mini cascada"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="01-agiles/03_intro_tradicional/10">
<h1>Proceso Centrado en la arquitectura</h1>

<ul>
<li>La arquitectura de un sistema es la organizaci&#xF3;n o estructura de sus partes m&#xE1;s 
relevantes</li>
<li>Una arquitectura ejecutable es una implementaci&#xF3;n parcial del sistema, construida 
para demostrar algunas funciones y propiedades</li>
<li>RUP establece refinamientos sucesivos de una arquitectura ejecutable, construida 
como un prototipo evolutivo</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="01-agiles/04_intro_agiles/1">
<h1>Metodolog&#xED;as &#xC1;giles</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content" ref="01-agiles/04_intro_agiles/2">
<h1>Ser &#xE1;gile es actuar seg&#xFA;n el manifiesto &#xE1;gil</h1>

<h2>Manifiesto por el Desarrollo &#xC1;gil de Software</h2>

<p>Estamos descubriendo formas mejores de desarrollar
software tanto por nuestra propia experiencia como
ayudando a terceros. A trav&#xE9;s de este trabajo hemos
aprendido a valorar:</p>

<p><strong>Individuos e interacciones</strong> <em>sobre procesos y herramientas</em>
<strong>Software funcionando</strong> <em>sobre documentaci&#xF3;n extensiva</em>
<strong>Colaboraci&#xF3;n con el cliente</strong> <em>sobre negociaci&#xF3;n contractual</em>
<strong>Respuesta ante el cambio</strong> <em>sobre seguir un plan</em></p>

<p>Esto es, aunque valoramos los elementos de la derecha,
valoramos m&#xE1;s los de la izquierda.</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="01-agiles/04_intro_agiles/3">
<h1>Principios del Manifiesto &#xC1;gil</h1>

<ul>
<li><p>Nuestra mayor prioridad es satisfacer al cliente
mediante la entrega temprana y continua de software
con valor.</p></li>
<li><p>Aceptamos que los requisitos cambien, incluso en etapas 
tard&#xED;as del desarrollo. Los procesos &#xC1;giles aprovechan
el cambio para proporcionar ventaja competitiva al 
cliente.</p></li>
<li><p>Entregamos software funcional frecuentemente, entre dos
semanas y dos meses, con preferencia al periodo de 
tiempo m&#xE1;s corto posible.</p></li>
<li><p>Los responsables de negocio y los desarrolladores
trabajamos juntos de forma cotidiana durante todo
el proyecto.</p></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="01-agiles/04_intro_agiles/4">
<h1>Principios del Manifiesto &#xC1;gil</h1>

<ul>
<li><p>Los proyectos se desarrollan en torno a individuos 
motivados. Hay que darles el entorno y el apoyo que 
necesitan, y confiarles la ejecuci&#xF3;n del trabajo. </p></li>
<li><p>El m&#xE9;todo m&#xE1;s eficiente y efectivo de comunicar 
informaci&#xF3;n al equipo de desarrollo y entre sus 
miembros es la conversaci&#xF3;n cara a cara.</p></li>
<li><p>El software funcionando es la medida principal de 
progreso.</p></li>
<li><p>Los procesos &#xC1;giles promueven el desarrollo 
sostenible. Los promotores, desarrolladores y usuarios
debemos ser capaces de mantener un ritmo constante 
de forma indefinida.</p></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="01-agiles/04_intro_agiles/5">
<h1>Principios del Manifiesto &#xC1;gil</h1>

<ul>
<li><p>La atenci&#xF3;n continua a la excelencia t&#xE9;cnica y al 
buen dise&#xF1;o mejora la Agilidad.</p></li>
<li><p>La simplicidad, o el arte de maximizar la cantidad de
trabajo no realizado, es esencial.</p></li>
<li><p>Las mejores arquitecturas, requisitos y dise&#xF1;os
emergen de equipos auto-organizados.</p></li>
<li><p>A intervalos regulares el equipo reflexiona sobre
c&#xF3;mo ser m&#xE1;s efectivo para a continuaci&#xF3;n ajustar y
perfeccionar su comportamiento en consecuencia.</p></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="01-agiles/04_intro_agiles/6">
<h1>&#xBF;Por qu&#xE9; surgen las metodolog&#xED;as &#xE1;giles?</h1>

<ul>
<li>Dificultades para implantar metodolog&#xED;as
tradicionales. Procesos ceremoniosos, herramientas y
notaciones de modelado sofisticadas (UML)</li>
<li>El enfoque &#xE1;gil es una soluci&#xF3;n a medida para un
segmento importante de proyectos de desarrollo de
software</li>
<li><em>"Aceptar el cambio" ...</em></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="01-agiles/04_intro_agiles/7">
<h1>Metodolog&#xED;as y t&#xE9;cnicas &#xE1;giles m&#xE1;s populares</h1>

<ul>
<li><strong>Kanban</strong>, <em>Andrew J. Davison</em></li>
<li><strong>Scrum</strong>, <em>Ken Schwaber &amp; Jeff Sutherland</em></li>
<li><strong>Extreme Programming</strong>, <em>Kent Beck</em></li>
<li><strong>Lean Software Development</strong>, <em>Mary Poppendieck</em></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="01-agiles/05_scrum/1">
<h1>SCRUM</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content" ref="01-agiles/05_scrum/2">
<h1>Introducci&#xF3;n</h1>

<p>SCRUM se basa en lo que se conoce como <strong>Sprints</strong></p>

<p><em>Un sprint concentra el esfuerzo durante un per&#xED;odo corto de tiempo hacia metas
prefijadas</em></p>

<p><img src="./file/01-agiles/10-scrum-01.png" alt="sprint"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="01-agiles/05_scrum/3">
<h1>Introducci&#xF3;n</h1>

<ul>
<li>El <strong>Product Owner (PO)</strong> compila todos los pedidos planificados para el producto y
prioriza las funcionalidades</li>
<li>El resultado del trabajo del PO es el <strong>Product Backlog</strong>, una lista de tareas
o <strong>TODO</strong> que constantemente se prioriza. Antes de cada Sprint, las tareas de
mayor prioridad son introducidas al <strong>Spring Backlog</strong></li>
<li>En conjunto con el usuario, los miembros del proyecto forman un <strong>Scrum Team</strong>
integrado por 5-9 personas. Luego de reuniones con el PO, se determina el
objetivo del Sprint y la funcionalidad priorizada, se explota en tareas
detalladas.

<ul>
<li>Notar que el cliente es parte del Scrum Team</li>
<li>El Scrum Team es auto-organizado y los miembros tienen una
responsabilidad conjunta en torno a los resultados</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="01-agiles/05_scrum/4">
<h1>Introducci&#xF3;n</h1>

<ul>
<li>El <strong>Scrum Master</strong> coordina al equipo de desarrollo, evitando cualquier
posible impedimento, y constantemente trata de asegurar que el equipo se
encuentre en las mejores circunstancias posibles de forma de poder cumplir con
el objetivo fijado para el Sprint

<ul>
<li>No es necesario que sea t&#xE9;cnico</li>
</ul></li>
<li>Cada Sprint realza el valor del producto, agregando nuevas funcionalidades y
mejoras que pueden entregarse al cliente</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="01-agiles/05_scrum/5">
<h1>Roles</h1>

<h2>Scrum Team</h2>

<ul>
<li>Son quienes resuelven problemas y dise&#xF1;an soluciones. Normalmente se compone de
5 a 9 integrantes - <em>este n&#xFA;mero de personas en un grupo ha demostrado ser el
adecuado para este tipo de trabajos</em></li>
<li>Los miembros deciden c&#xF3;mo organizar el trabajo y c&#xF3;mo se realiza distribuci&#xF3;n
de tareas. No hay roles fijados - <em>todos podr&#xE1;n cambiar de tareas con
cualquier otro miembro</em>. Esto no implica que no existan miembros que sean
expertos en determinado campo.</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="01-agiles/05_scrum/6">
<h1>Roles</h1>

<h2>Product Owner</h2>

<ul>
<li>Es la voz del cliente</li>
<li>Asegura que el Scrum Team trabaje con una adecuada perspectiva del negocio</li>
<li>Es quien administra el Product Backlog - <em>una lista de tareas pendientes donde
todas las especificaciones para el producto son expresadas indicando cu&#xE1;n
rentables considera que son</em>

<ul>
<li>El documento debe ser visible por toda la organizaci&#xF3;n de forma tal que
<strong>todos</strong> est&#xE9;n al tanto de qu&#xE9; se espera en futuras versiones del producto</li>
</ul></li>
<li>El PO generalmente es el cliente, pero puede ser parte interna de la
organizaci&#xF3;n. </li>
<li>Es aconsejable que el PO tenga un perfil comercial y conozca bien los procesos
de negocio</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="01-agiles/05_scrum/7">
<h1>Roles</h1>

<h2>Scrum Master</h2>

<ul>
<li>Es una combinaci&#xF3;n de los roles de: mentor, mediador, resolver problemas y portero.</li>
<li>Debe tener breves reuniones diarias con el equipo - <em>Daily Scrums</em></li>
<li>Cuando alguien externo al proyecto introduce un tema importante para discutir
con el equipo, el Scrum Master trata de asegurar que los integrantes se distraigan 
lo menos posible</li>
<li>Debe mantener la postura de <em>aqu&#xED; y ahora</em> en relaci&#xF3;n al trabajo</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="01-agiles/05_scrum/8">
<h1>Roles</h1>

<h2>Scrum Master</h2>

<ul>
<li>Focaliza sus esfuerzos en facilitar al equipo con las mejores circunstancias
para alcanzar las metas acordadas para el Sprint</li>
<li>Luego de cada Sprint, el Scrum Master mantiene una reuni&#xF3;n de evaluaci&#xF3;n con
el equipo completo - <em>Retrospectiva del Sprint</em>

<ul>
<li>Se analizan experiencias y obtienen conclusiones</li>
<li>El objetivo es elevar el conocimiento global del equipo y motivar antes del
pr&#xF3;ximo Sprint</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="01-agiles/05_scrum/9">
<h1>Procesos</h1>

<h2>Creando el backlog</h2>

<ul>
<li>El PO recompila todos los requerimientos y especificaciones que son la base
de los cambios a introducir al producto: nuevas funcionalidades y correcci&#xF3;n
de errores</li>
<li>De aqu&#xED; se obtiene una lista priorizada de aquellos cambios que se desean
porque tienen valor para la organizacion.</li>
<li>Al inicio de cada Sprint el PO deber&#xED;a <em>congelar</em> los principales items de la
lista y presentarlos al equipo de Scrum</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="01-agiles/05_scrum/10">
<h1>Procesos</h1>

<h2>El Sprint</h2>

<ul>
<li>De los d&#xED;as destinados a cada sprint (generalmente 15-30 d&#xED;as), los primeros
se utilizan para crear el <em>Sprint Backlog</em></li>
<li>Cuando se determian las tareas y tiempo para realizarlas, el PO deja de
participar</li>
<li>El equipo trabajar&#xE1; bajo su propia responsabilidad</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="01-agiles/05_scrum/11">
<h1>Procesos</h1>

<h2>Scrum diario</h2>

<ul>
<li>Cada d&#xED;a, a la misma hora, el Scrum Master con el equipo tienen una breve
reunoi&#xF3;n</li>
<li>El prop&#xF3;sito es el de <em>eliminar</em> todos los impedimentos de velocidad en el
grupo</li>
<li>Cada participante deber&#xED;a, de alguna manera, responder a las siguientes
preguntas:

<ul>
<li>&#xBF;Qu&#xE9; es lo que hizo desde la &#xFA;ltima reuni&#xF3;n?</li>
<li>&#xBF;Qu&#xE9; har&#xE1; desde ahora hasta la pr&#xF3;xima reuni&#xF3;n?</li>
<li>&#xBF;Hay algo que no permita avanzar en lo planificado?</li>
</ul></li>
</ul>

<p><em>Las dos primeras preguntas ofrecen a los participantes una visi&#xF3;n global del
avance del proyecto. La tercera, sirve para solucionar problemas</em></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="01-agiles/05_scrum/12">
<h1>M&#xE9;tricas</h1>

<ul>
<li>Las tareas en el Sprint Backlog deben estimarse en cantidad de horas

<ul>
<li>El Sprint Backlog entonces tiene una cantidad de horas pendientes</li>
</ul></li>
<li>Diariamente podemos analizar el avance del equipo usando un gr&#xE1;fico conocido
como <strong>burn-down</strong></li>
</ul>

<p><img src="./file/01-agiles/10-scrum-02.png" alt="burndown"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content" ref="01-agiles/05_scrum/13">
<h1>SCRUM en 10 minutos</h1>

<h2>Un video &#xE1;gil</h2>

<div style="text-align: center">
<iframe width="560" height="315" src="//www.youtube.com/embed/XU0llRltyFM" frameborder="0"> </iframe>
</div>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="01-agiles/06_referencias">
<h1>Referencias</h1>

<ul>
<li>http://agilemanifesto.org/</li>
<li>http://tastycupcakes.org/</li>
<li>http://agilismoatwork.blogspot.com.ar/</li>
<li>http://psw.tuneupprocess.com/</li>
<li>http://softhouseeducation.com/en/produkt/scrum-five-minutes</li>
<li>http://www.mountaingoatsoftware.com/</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="02-git/01_basics/1">
<h1>GIT</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/01_basics/2">
<h1>Caracter&#xED;sticas</h1>

<ul>
<li>Snapshots, no diferencias</li>
<li>Casi todas las operaciones son locales</li>
<li>Tiene integridad</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/01_basics/3">
<h1>Los 3 estados</h1>

<ul>
<li>Working directory</li>
<li>Staging area</li>
<li>Git directory (Repositorio)</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content" ref="02-git/01_basics/4">
<h1>Operaciones locales</h1>

<p><img src="./file/02-git/18333fig0106-tn.png" alt="local-operations"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/01_basics/5">
<h1>Obteniendo un repositorio git</h1>

<ul>
<li>Inicializar un repositorio en un directorio existente</li>
</ul>

<p><code>
$ git init
</code></p>

<ul>
<li>Clonando un repositorio existente</li>
</ul>

<p><code>
$ git clone https://github.com/rails/rails.git
</code></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content" ref="02-git/01_basics/6">
<h1>Ciclo de vida de un archivo</h1>

<p><img src="./file/02-git/18333fig0201-tn.png" alt="file-status-lifecycle"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/01_basics/7">
<h1>Remotos</h1>

<ul>
<li>Son repositorios externos (ejemplo: de coworkers).</li>
<li>Puede haber n remotos</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="02-git/01_basics/8">
<h1>El workflow completo</h1>

<p><img src="./file/02-git/git-workflow.png" alt="workflow completo git"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/1">
<h1>&#xBF;Qu&#xE9; es un branch?</h1>

<ul>
<li>Es un puntero a un commit</li>
</ul>

<p><img src="./file/02-git/18333fig0304-tn.png" alt="what-a-branch-is"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/2">
<h1>&#xBF;Y c&#xF3;mo sabe git en que branch estamos actualmente?</h1>

<ul>
<li>Otro puntero: HEAD</li>
</ul>

<p><img src="./file/02-git/18333fig0305-tn.png" alt="head"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/3">
<h1>Cambiando de branch</h1>

<p><code>
$ git checkout testing
</code></p>

<p><img src="./file/02-git/18333fig0306-tn.png" alt="checkout"/>

<ul>
<li>Lo &#xFA;nico que hace es cambiar HEAD!</li>
</ul>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/4">
<h1>Haciendo cambios en un branch</h1>

<p><code>
$ vi test.rb
</code></p>

<p><code>
$ git commit -am 'made a change'
</code></p>

<p><img src="./file/02-git/18333fig0307-tn.png" alt="changing-branches"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/5">
<h1>Volviendo a master</h1>

<p><code>
$ git checkout master
</code></p>

<p><img src="./file/02-git/18333fig0308-tn.png" alt="master"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/6">
<h1>Haciendo cambios en master</h1>

<p><code>
$ vi test.rb
</code></p>

<p><code>
$ git commit -am 'made other changes'
</code></p>

<p><img src="./file/02-git/18333fig0309-tn.png" alt="more-changes"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/7">
<h1>Branching y merging</h1>

<p><img src="./file/02-git/18333fig0310-tn.png" alt="first"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/8">
<h1>Branching y merging</h1>

<p><img src="./file/02-git/18333fig0311-tn.png" alt="second"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/9">
<h1>Branching y merging</h1>

<p><img src="./file/02-git/18333fig0312-tn.png" alt="third"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/10">
<h1>Branching y merging</h1>

<p><img src="./file/02-git/18333fig0313-tn.png" alt="fourth"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/11">
<h1>Branching y merging: fast-forward</h1>

<p><code>
$ git checkout master
</code></p>

<p><code>
$ git merge hotfix
</code></p>

<p><img src="./file/02-git/18333fig0314-tn.png" alt="fifth"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/12">
<h1>Branching y merging</h1>

<p><img src="./file/02-git/18333fig0315-tn.png" alt="sixth"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/13">
<h1>Branching y merging: merge made by recursive</h1>

<p><code>
$ git checkout master
</code></p>

<p><code>
$ git merge iss53
</code></p>

<p><img src="./file/02-git/18333fig0316-tn.png" alt="seventh"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/14">
<h1>Branching y merging</h1>

<p><img src="./file/02-git/18333fig0317-tn.png" alt="eighth"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/15">
<h1>Merge: Conflictos</h1>

<ul>
<li>Remotos</li>
</ul>

<p><img src="./file/02-git/18333fig0322-tn.png" alt="remote"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/16">
<h1>Merge: Conflictos</h1>

<p><img src="./file/02-git/18333fig0323-tn.png" alt="remote-2"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/17">
<h1>Merge: Conflictos</h1>

<p><img src="./file/02-git/18333fig0324-tn.png" alt="remote-3"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/18">
<h1>Merge: rebasing</h1>

<ul>
<li>Tomar un patch del cambio y re-aplicarlo en otro branch</li>
</ul>

<p><img src="./file/02-git/18333fig0327-tn.png" alt="rebasing"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/19">
<h1>Merge: rebasing</h1>

<p><code>
$ git checkout experiment
</code></p>

<p><code>
$ git rebase master
</code></p>

<p><img src="./file/02-git/18333fig0329-tn.png" alt="rebasing-2"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/20">
<h1>Merge: rebasing</h1>

<p><img src="./file/02-git/18333fig0330-tn.png" alt="rebasing-2"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="02-git/02_branches/21">
<h1>Merge: rebasing</h1>

<ul>
<li>La historia es m&#xE1;s limpia</li>
<li>Simula una historia lineal</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="02-git/04_referencias">
<h1>Referencias</h1>

<ul>
<li><p>Lecturas</p>

<ul>
<li><a href="http://git-scm.com/book">Pro Git</a></li>
<li><a href="https://www.kernel.org/pub/software/scm/git/docs/gittutorial.html">Git tutorial</a></li>
</ul></li>
<li><p>Juegos:</p>

<ul>
<li><a href="http://try.github.io/">tryGit</a></li>
<li><a href="https://github.com/Gazler/githug">GitHug</a></li>
<li><a href="http://pcottle.github.io/learnGitBranching">Learn git branching</a></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="03-presentacion-ruby/01_historia/1">
<p><img src="./file/03-presentacion-ruby/01-dosis-ruby.png" alt="dosis"/>

<h1>Una dosis r&#xE1;pida de ruby</h1>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="03-presentacion-ruby/01_historia/2">
<h1>Historia</h1>

<p><img src="./file/03-presentacion-ruby/02-yukihiro-matsumoto.jpg" alt="Yukihiro Matsumoto"/>

<h2>MATZ</h2>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="03-presentacion-ruby/01_historia/3">
<h1>MATZ</h1>

<ul>
<li><a href="http://en.wikipedia.org/wiki/Yukihiro_Matsumoto">Yukihiro Matsumoto</a>

<ul>
<li>En japon&#xE9;s: &#x677E;&#x672C;&#x884C;&#x5F18; (&#x307E;&#x3064;&#x3082;&#x3068;&#x3086;&#x304D;&#x3072;&#x308D;)</li>
<li>Matz m&#xE1;s simple</li>
<li>Empez&#xF3; el desarrollo de Ruby en 1993</li>
<li>En 1995 lanz&#xF3; la primera versi&#xF3;n</li>
<li>A&#xFA;n lidera el desarrollo de Ruby</li>
</ul></li>
<li>Su c&#xE9;lebre frase:</li>
</ul>

<p>Ruby is designed to make programmers <strong>HAPPY</strong></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="03-presentacion-ruby/01_historia/4">
<h1>&#xBF;C&#xF3;mo surge Ruby?</h1>

<ul>
<li>Fusi&#xF3;n de lenguajes

<ul>
<li>Smalltalk</li>
<li>Perl</li>
<li>LISP</li>
</ul></li>
<li>Hasta el 2001 conocido s&#xF3;lo en Jap&#xF3;n

<ul>
<li>El libro <a href="http://pragprog.com/book/ruby/programming-ruby">Programming Ruby</a> fue el 
impulsor del lenguaje fuera de Jap&#xF3;n</li>
<li>Tambi&#xE9;n conocido como PickAxe</li>
<li>La primera versi&#xF3;n puede <a href="http://ruby-doc.org/docs/ProgrammingRuby/">leerse en l&#xED;nea</a></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="03-presentacion-ruby/01_historia/5">
<p><img src="./file/03-presentacion-ruby/03-pickaxe.jpg" alt="pickaxe"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="03-presentacion-ruby/01_historia/6">
<h1>En el 2005, Dinamarca</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="03-presentacion-ruby/01_historia/7">
<h1>Aparece...</h1>

<p><img src="./file/03-presentacion-ruby/04-dhh.jpg" alt="DHH"/>

<h2>DHH</h2>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="03-presentacion-ruby/01_historia/8">
<h1>DHH</h1>

<ul>
<li><a href="http://en.wikipedia.org/wiki/David_Heinemeier_Hansson">David Heinemeier Hansson</a>

<ul>
<li>DHH m&#xE1;s simple</li>
<li>Creador de Rails</li>
</ul></li>
<li><a href="http://rubyonrails.org/">Rails</a>

<ul>
<li>Framework open source para desarrollo de aplicaciones web</li>
<li>Creado en 2004</li>
<li>Su primer versi&#xF3;n liberada (1.0) fue en 2005</li>
<li>Actualmente en la versi&#xF3;n 4.0</li>
</ul></li>
</ul>

<p><img src="./file/03-presentacion-ruby/05-rails.png" alt="Rails"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="03-presentacion-ruby/02_el-lenguaje/1">
<h1>El lenguaje</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets incremental" ref="03-presentacion-ruby/02_el-lenguaje/2">
<h1>Caracter&#xED;sticas</h1>

<ul>
<li>Din&#xE1;mico</li>
<li>Sintaxis concisa y expresiva </li>
<li>Orientado a objetos</li>
<li>Capacidades de metaprogramaci&#xF3;n</li>
<li>Caracter&#xED;sticas funcionales</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="03-presentacion-ruby/02_el-lenguaje/3">
<h1>Entendiendo Ruby</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="03-presentacion-ruby/02_el-lenguaje/4">
<h1>Sintaxis y convenciones</h1>

<pre class="sh_ruby"><code>
    NombreDeClaseOModulo

    CONSTANTE

    @nombre_de_atributo

    @@atributo_de_clase

    $variable_global

    nombre_de_metodo

    metodo_peligroso!

    metodo_que_pregunta?</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets execute" ref="03-presentacion-ruby/02_el-lenguaje/5">
<h1>Objetos</h1>

<h2>Todos los valores son <strong>objetos</strong></h2>

<pre class="sh_ruby"><code>"Aprendiendo ruby".length</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets execute" ref="03-presentacion-ruby/02_el-lenguaje/6">
<h1>Algunos ejemplos m&#xE1;s</h1>

<h2>Arreglos</h2>

<pre class="sh_ruby"><code>["Mateo", "Lola", "Lihue", "Clio"].sort</code></pre>

<h2>N&#xFA;meros</h2>

<pre class="sh_ruby"><code>-100.abs</code></pre>

<h2>nil</h2>

<pre class="sh_ruby"><code>nil.nil?</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets execute" ref="03-presentacion-ruby/02_el-lenguaje/7">
<h1>M&#xE1;s ejemplos</h1>

<h2>Todo es un objeto: parte 2</h2>

<pre class="sh_ruby"><code>1.object_id</code></pre>

<h2>Todo es un objeto: parte 3</h2>

<pre class="sh_ruby"><code>nil.object_id</code></pre>

<h2>Es simple y conciso</h2>

<pre class="sh_ruby"><code>([1,2,3] + [4,5,6]).last</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="03-presentacion-ruby/03_literales/1">
<h1>Hay muchos literales</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="03-presentacion-ruby/03_literales/2">
<h1>N&#xFA;meros literales</h1>

<pre class="sh_ruby"><code>3
3.14
1_999_235_243_888 == 1999235243888</code></pre>

<h2>Podemos usar binario, octal o hexadecimal</h2>

<pre class="sh_ruby"><code>0b1000_1000     #Binario =&gt; 132
010                 # Octal =&gt; 8
0x10                # Hexadecimal =&gt; 16</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets execute" ref="03-presentacion-ruby/03_literales/3">
<h1>Strings literales</h1>

<pre class="sh_ruby"><code>'sin interpolar'
"Interpolando: #{'Ja'*3}!"</code></pre>

<h2>Podemos usar otras formas</h2>

<pre class="sh_ruby"><code>%q/Hola/
%q!Chau!
%Q{Interpolando: #{3+3}}</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets execute" ref="03-presentacion-ruby/03_literales/4">
<h1>Strings como here document</h1>

<pre class="sh_ruby"><code>
un_string = &lt;&lt;EOS
    Este es un texto
    de mas de una linea
    que termina aqui
EOS

un_string.upcase</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="03-presentacion-ruby/03_literales/5">
<h1>S&#xED;mbolos</h1>

<ul>
<li>Son como variables prefijados con <strong>:</strong> (dos puntos)

<ul>
<li>Ejemplos: <code>:action</code>, <code>:line_items</code>, <code>:+</code></li>
</ul></li>
<li>No es necesario declararlos </li>
<li>Se garantiza que son &#xFA;nicos

<ul>
<li>No es necesario asignarles ning&#xFA;n valor</li>
</ul></li>
</ul>

<h2>Veamos un ejemplo</h2>

<pre class="sh_ruby"><code>:uno.object_id  # siempre devolver&#xE1; lo mismo
"uno".object_id # siempre devolver&#xE1; diferente</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="03-presentacion-ruby/03_literales/6">
<h1>Arreglos</h1>

<pre class="sh_ruby"><code>
['Hola', 'Chau]

%w(Hola Chau #{2+2})    # sin interpolar

%W(Hola Chau #{2+2})    # interpolando

[1,2,3,4]</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="03-presentacion-ruby/03_literales/7">
<h1>Hashes</h1>

<pre class="sh_ruby"><code># Versi&#xF3;n 1.8
{
    :nombre     =&gt; 'Christian',
    :apellido   =&gt; 'Rodriguez'
}
# Versi&#xF3;n &gt; 1.8
{
    nombre:     'Christian',
    apellido:   'Rodriguez'
}</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="03-presentacion-ruby/03_literales/8">
<h1>Expresiones regulares</h1>

<pre class="sh_ruby"><code>/^[a-zA-Z]+$/</code></pre>

<p><em>Explicaci&#xF3;n detallada en
<a href="http://www.ruby-doc.org/docs/ProgrammingRuby/html/language.html#UJ">Pickaxe</a></em></p>

<p><em>Para probar expresiones regulares puede usar <a href="http://rubular.com/">Rubular</a></em></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="03-presentacion-ruby/03_literales/9">
<h1>Rangos</h1>

<pre class="sh_ruby"><code>0..1
0..10
"a".."z"
"a"..."z"</code></pre>

<h2>Pueden convertirse en arreglos</h2>

<pre class="sh_ruby"><code>("a"..."z").to_a</code></pre>

<h2>Rangos como intervalos</h2>

<pre class="sh_ruby"><code>(1..10) === 5   # =&gt; true
(1..10) === 15   # =&gt; false
(1..10) === 3.1  # =&gt; true</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="03-presentacion-ruby/03_literales/10">
<h1>Lambdas</h1>

<pre class="sh_ruby"><code>uno = lambda { |n| n * 2 }

dos = -&gt;(n, m){ n * 2 + m }

tres    = -&gt;(n, m=0){ n * 2 + m}

# Entonces
uno.call 2          # =&gt; 4

dos.call 2,3        # =&gt; 7

tres.call 2         # =&gt; 4</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="03-presentacion-ruby/04_metodos/1">
<h1>M&#xE9;todos como operadores</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content execute" ref="03-presentacion-ruby/04_metodos/2">
<h1>&#xBF;C&#xF3;mo?</h1>

<pre class="sh_ruby"><code>10 - 2</code></pre>

<h2>Es equivalente a:</h2>

<pre class="sh_ruby"><code>10.send :-, 2</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content execute" ref="03-presentacion-ruby/04_metodos/3">
<h1>Otros m&#xE9;todos como operadores</h1>

<pre class="sh_ruby"><code>[1,2,3] - [1]</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="03-presentacion-ruby/05_expresiones/1">
<h1>Expresiones</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="03-presentacion-ruby/05_expresiones/2">
<h2>En Ruby toda expresi&#xF3;n retorna un valor</h2>
</div>
</div><div class="slide" data-transition="uncover"><div class="content execute" ref="03-presentacion-ruby/05_expresiones/3">
<h1>En estos casos retorna el valor esperado</h1>

<pre class="sh_ruby"><code>a = 3.14</code></pre>

<h2>Veamos como es el case</h2>

<pre class="sh_ruby"><code>estado = nil
#...
face =  case estado
                when "Feliz"  then ":)"
                when "Triste" then ":("
                else               ":|"
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content execute incremental" ref="03-presentacion-ruby/05_expresiones/4">
<h1>Y en este caso, &#xBF;qu&#xE9; retorna?</h1>

<pre class="sh_ruby"><code>def foo
    "bar"
end
# =&gt; nil</code></pre>

<p>Notar que la definici&#xF3;n de un m&#xE9;todo retorna nil</p>

<p><strong>Su ejecuci&#xF3;n retorna <code>"bar"</code></strong></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="03-presentacion-ruby/06_bloques/1">
<h1>Bloques</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="03-presentacion-ruby/06_bloques/2">
<h1>Rara vez usaremos un for / while</h1>

<pre class="sh_ruby"><code>3.times do |i|
    puts i
end
# 0
# 1
# 2
# =&gt; 3 (retorna el 3 que recibe .times)

3.times { |x| puts x }</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="03-presentacion-ruby/07_declarativo/1">
<h1>Programando declarativamente</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content execute" ref="03-presentacion-ruby/07_declarativo/2">
<h1>Ejemplos</h1>

<h2>Los pares</h2>

<pre class="sh_ruby"><code>(1..10).select { |n| n.even? }

# o lo que es igual:

(1..10).select(&amp; :even?)</code></pre>

<h2>Procesando cada elemento</h2>

<pre class="sh_ruby"><code>(1..10).map { |n| n*2 }

# o lo que es igual:

(1..10).collect { |n| n*2 }</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content execute" ref="03-presentacion-ruby/07_declarativo/3">
<h1>M&#xE1;s ejemplos</h1>

<h2>Sumatoria</h2>

<pre class="sh_ruby"><code>(1..100).reduce { |sum,n| sum + n }

# o lo que es igual:

(1..100).reduce(:+)</code></pre>

<h2>Lo verificamos:</h2>

<pre class="sh_ruby"><code># La formula de verificacion es: n*(n+1)/2

100*101/2</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content" ref="03-presentacion-ruby/07_declarativo/4">
<h1>Aumentando la fluidez</h1>

<pre class="sh_ruby"><code>File.open('my.txt').each do |line|

    puts line if line =~ /ruby/

end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="03-presentacion-ruby/08_duck_typing/1">
<h1>Duck typing</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="03-presentacion-ruby/08_duck_typing/2">
<h1>&#xBF;Qu&#xE9; es duck typing?</h1>

<ul>
<li>Es un t&#xE9;rmino empleado en <strong>OO</strong></li>
<li>Estilo de tipeo din&#xE1;mico donde:

<ul>
<li>Los m&#xE9;todos y propiedades determinan la sem&#xE1;ntica v&#xE1;lida</li>
<li>En vez de utilizar herencia o interfaces para indicar la propiedad: <strong>es un
..</strong></li>
</ul></li>
<li>El nombre del concepto se refiere al <em>duck test</em>, atribu&#xED;do a James Whitcomb
Riley que podr&#xED;a resumirse en:</li>
</ul>

<p><em>Si veo un p&#xE1;jaro que camina como pato, nada como pato y hace "cuack" como pato,
entonces llamar&#xE9; a ese p&#xE1;jaro un pato</em></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="03-presentacion-ruby/08_duck_typing/3">
<h1>En Java: versi&#xF3;n simple</h1>

<pre class="sh_java"><code>public interface DuckLike {
    Cuack cuack();
}
//...
public void doSomething(DuckLike d) {
    d.cuack();
//  ...
}</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smaller" ref="03-presentacion-ruby/08_duck_typing/4">
<h1>En Java: usando reflexi&#xF3;n</h1>

<pre class="sh_java"><code>import java.lang.reflect.InvocationHandler;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.lang.reflect.Proxy;

public class DuckTyping {

    interface Walkable  { void walk(); }
    interface Swimmable { void swim(); }
    interface Quackable { void quack(); }

    public static void main(String[] args) {
        Duck d = new Duck();
        Person p = new Person();

        as(Walkable.class, d).walk();   //duck can walk()
        as(Swimmable.class, d).swim();  //duck can swim() 
        as(Quackable.class, d).quack(); //duck can quack()

        as(Walkable.class, p).walk();   //person can walk()
        as(Swimmable.class, p).swim();  //person can swim() 
        // Gives Runtime Error
        as(Quackable.class, p).quack(); //person can't quack()
    }
//...</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smaller" ref="03-presentacion-ruby/08_duck_typing/5">
<h1>En Java: usando reflexi&#xF3;n (cont)</h1>

<pre class="sh_java"><code>    @SuppressWarnings("unchecked")
    static &lt;T&gt; T as(Class&lt;T&gt; t, final Object obj) {
        return (T) Proxy.newProxyInstance(t.getClassLoader(), 
            new Class[] {t},
            new InvocationHandler() {
                public Object invoke(Object proxy, 
                            Method method, 
                            Object[] args) throws Throwable {
                    try {
                        return obj.getClass()
                          .getMethod(method.getName(), 
                             method.getParameterTypes())
                          .invoke(obj, args);
                    } catch (NoSuchMethodException nsme) {
                        throw new NoSuchMethodError(
                          nsme.getMessage());
                    } catch (InvocationTargetException ite) {
                        throw ite.getTargetException();
                    }
                }
            });
    }
}
//....</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smaller" ref="03-presentacion-ruby/08_duck_typing/6">
<h1>En Java: usando reflexi&#xF3;n (cont)</h1>

<pre class="sh_java"><code>class Duck {
    public void walk()  {
        System.out.println("I'm Duck, I can walk...");
    }
    public void swim()  {
        System.out.println("I'm Duck, I can swim...");
    }
    public void quack() {
        System.out.println("I'm Duck, I can quack...");
    }
}

class Person {
    public void walk()  {
        System.out.println("I'm Person, I can walk...");
    }
    public void swim()  {
        System.out.println("I'm Person, I can swim...");
    }
    public void talk()  {
        System.out.println("I'm Person, I can talk...");
    }
}</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smaller" ref="03-presentacion-ruby/08_duck_typing/7">
<h1>En Ruby</h1>

<pre class="sh_ruby"><code>class Duck
    def quack
        puts "Quaaaaaack!"
    end
    def feathers
        puts "The duck has white and gray feathers."
    end
end
class Person
    def quack
        puts "The person imitates a duck."
    end
    def feathers
        puts "The person takes a feather from the ground"
    end
end
def in_the_forest duck
    duck.quack
    duck.feathers
end

donald = Duck.new
john = Person.new
in_the_forest donald
in_the_forest john</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="03-presentacion-ruby/09_mokey_patching/1">
<h1>Monkey patching</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="03-presentacion-ruby/09_mokey_patching/2">
<h1>&#xBF;Qu&#xE9; es monkey patching?</h1>

<ul>
<li>Modificar una clase din&#xE1;micamente</li>
<li>En tiempo de ejecuci&#xF3;n, agregar nuevos m&#xE9;todos a una clase o cambiar su
comportamiento</li>
<li>El t&#xE9;rmino surge de <strong>Gorilla Patch</strong> 

<ul>
<li><em>Monkey patch es menos intimidante</em></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="03-presentacion-ruby/09_mokey_patching/3">
<h1>Un ejemplo</h1>

<pre class="sh_ruby"><code>(1..10).even # da error: even no existe

class Range
    # Agregamos even a Range
    def even
      self.select(&amp; :even?)  
    end
end

(1..10).even # ahora no da error
# =&gt; [2,4,6,8,10]</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="03-presentacion-ruby/10_modulos/1">
<h1>M&#xF3;dulos</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="03-presentacion-ruby/10_modulos/2">
<h1>Como Namespace</h1>

<pre class="sh_ruby"><code>module MyAPI
    class User
    ...
    end

    def self.configuration
    ...
    end
end

user = MyAPI::User.new

puts MyAPI::configuration</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="03-presentacion-ruby/10_modulos/3">
<h1>Como Mixins</h1>

<p><em>Como las interfaces, pero con comportamiento</em></p>

<pre class="sh_ruby"><code>module MyLog
    def log(msg)
        puts "Log: #{msg}"
    end
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="03-presentacion-ruby/10_modulos/4">
<h1>Como usar un mixin</h1>

<pre class="sh_ruby"><code>class String; include MyLog; end

"hola".log("pepe")
#Log: pepe
# =&gt; nil </code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="03-presentacion-ruby/99_referencias/1">
<h1>Referencias</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="03-presentacion-ruby/99_referencias/2">
<h1>Referencias</h1>

<ul>
<li><a href="http://www.ruby-doc.org/docs/ProgrammingRuby/">PickAxe</a></li>
<li><a href="http://www.rubyinside.com/media/poignant-guide.pdf">why's (poignant) Guide to Ruby</a></li>
<li>Muy inspirado en la gran presentaci&#xF3;n de Jano Gonz&#xE1;lez presentada en la
RubyConf 2012 Argentina

<ul>
<li><a href="https://speakerdeck.com/janogonzalez/donde-estan-mis-interfaces">&#xBF;Donde est&#xE1;n mis interfaces?</a></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="04-VMs/01_vms/1">
<h1>Ruby VMs</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/01_vms/2">
<h1>MRI</h1>

<ul>
<li>Matz' Ruby Implementation</li>
<li>Tambi&#xE9;n llamada CRuby</li>
<li>Es la implementaci&#xF3;n de referencia del lenguaje</li>
<li>&#xDA;ltimas versiones

<ul>
<li>1.8.7-p375 (No usar!)</li>
<li>1.9.3-p547</li>
<li>2.0.0-p481</li>
<li>2.1.2</li>
<li>2.2.0-dev</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/01_vms/3">
<h1>JRuby</h1>

<ul>
<li>Ruby en la JVM</li>
<li>Es la alternativa m&#xE1;s madura a MRI en t&#xE9;rminos de compatibilidad con MRI</li>
<li>Combina lo mejor de la plataforma de la JVM con Ruby:

<ul>
<li>Concurrencia real</li>
<li>Interoperabilidad con librer&#xED;as Java</li>
</ul></li>
<li>&#xDA;ltimas versiones

<ul>
<li>jruby-1.7.14</li>
</ul></li>
<li>Modos

<ul>
<li>1.8.x</li>
<li>1.9.x (default)</li>
<li>2.0.x</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/01_vms/4">
<h1>Rubinius</h1>

<ul>
<li>Ruby escrito en (mayoritariamente) Ruby</li>
<li>La VM fue escrita en C++</li>
<li>El bytecode compiler y una gran parte de las clases Core de Ruby fueron escritas en Ruby</li>
<li>&#xDA;ltimas versiones

<ul>
<li>rbx-1.2.4: modos 1.8.7 y 1.9.3</li>
<li>rbx-2.0.0 (no lanzado): modos 1.8.7, 1.9.3 y 2.0.0</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/01_vms/5">
<h1>Otras implementaciones</h1>

<ul>
<li>IronRuby

<ul>
<li>Ruby en .NET</li>
<li>El proyecto est&#xE1; inactivo</li>
</ul></li>
<li>MacRuby

<ul>
<li>Ruby (1.9.3) implementado sobre las tecnolog&#xED;as de Mac OS X (Objective-C)</li>
<li>El proyecto no est&#xE1; tan activo</li>
</ul></li>
<li>MagLev: 

<ul>
<li>Ruby en la VM GemStone/S 3.1 de VMware (Smalltalk!)</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/01_vms/6">
<h1>MRI: Referencias</h1>

<ul>
<li><a href="http://ruby-lang.org">http://ruby-lang.org</a></li>
<li><a href="https://github.com/ruby/ruby">https://github.com/ruby/ruby</a></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/01_vms/7">
<h1>JRuby: Referencias</h1>

<ul>
<li><a href="http://jruby.org/">http://jruby.org/</a></li>
<li><a href="https://github.com/jruby/jruby">https://github.com/jruby/jruby</a></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/01_vms/8">
<h1>Rubinius: Referencias</h1>

<ul>
<li><a href="http://rubini.us/">http://rubini.us/</a></li>
<li><a href="https://github.com/rubinius/rubinius">https://github.com/rubinius/rubinius</a></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/01_vms/9">
<h1>Otras implementaciones: referencias</h1>

<ul>
<li><a href="http://ironruby.codeplex.com/">http://ironruby.codeplex.com/</a></li>
<li><a href="https://github.com/ironlanguages/main">https://github.com/ironlanguages/main</a></li>
<li><a href="http://macruby.org/">http://macruby.org/</a></li>
<li><a href="https://github.com/MacRuby/MacRuby">https://github.com/MacRuby/MacRuby</a></li>
<li><a href="http://maglev.github.io/">http://maglev.github.io/</a></li>
<li><a href="https://github.com/MagLev/maglev">https://github.com/MagLev/maglev</a></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="04-VMs/02_rbenv/1">
<h1>Historia</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/02_rbenv/2">
<h1>Muchas implementaciones</h1>

<h2>&#xBF;Cual usar?</h2>

<h2>&#xBF;Y si necesito o quiero usar m&#xE1;s de 1?</h2>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/02_rbenv/3">
<h1>Un peque&#xF1;o par&#xE9;ntesis</h1>

<h2>Gemas</h2>

<h2>Bundler</h2>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/02_rbenv/4">
<h1>RVM</h1>

<ul>
<li>Ruby Version Manager</li>
<li>Fue la primera herramienta para instalar, administrar y trabajar con m&#xFA;ltiples entornos de Ruby</li>
<li>Introduce el concepto de gemset</li>
<li>Modifica el comando <code>cd</code> para cambiar de versi&#xF3;n de ruby</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/02_rbenv/5">
<h1>rbenv</h1>

<ul>
<li>Ruby environment</li>
<li>Fue la primera alternativa a RVM y r&#xE1;pidamente se hizo muy popular</li>
<li>Es m&#xE1;s simple que RVM y ya no instala rubies ni usa gemsets</li>
<li>Se puede agregar funcionalidad con plugins</li>
<li>Utiliza shims para cambiar de versi&#xF3;n de ruby</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/02_rbenv/6">
<h1>chruby</h1>

<ul>
<li>Es el 3ro en discordia</li>
<li>Es muy minimalista (90 LOC!)</li>
<li>S&#xF3;lo cambia $PATH para cambiar de ruby</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/02_rbenv/7">
<h1>Instalando rbenv</h1>

<ul>
<li>Vamos a instalar rbenv con git</li>
<li>Vamos a instalar los siguientes plugins

<ul>
<li>ruby-build</li>
<li>rbenv-gem-rehash</li>
<li>rbenv-update</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/02_rbenv/8">
<h1>Instalando rbenv</h1>

<ul>
<li>Instalamos rbenv en <code>~/.rbenv</code></li>
</ul>

<p><code>
$ git clone https://github.com/sstephenson/rbenv.git ~/.rbenv
</code></p>

<ul>
<li>Agregamos <code>~/.rbenv/bin</code> a <code>$PATH</code></li>
</ul>

<p><code>
$ echo 'export PATH="$HOME/.rbenv/bin:$PATH"' &gt;&gt; ~/.bash_profile
</code></p>

<p>En ubuntu, hacer el <code>echo</code> en <code>.profile</code> en vez de <code>.bash_profile</code></p>

<ul>
<li>Agregamos <code>rbenv init</code> al shell para habilitar los shims y el autocompletado</li>
</ul>

<p><code>
$ echo 'eval "$(rbenv init -)"' &gt;&gt; ~/.bash_profile
</code></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/02_rbenv/9">
<h1>Instalando rbenv</h1>

<ul>
<li>Reiniciamos el shell</li>
</ul>

<p><code>
$ exec $SHELL -l
</code></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/02_rbenv/10">
<h1>Instalando ruby-build</h1>

<ul>
<li>Clonamos el plugin en el directorio <code>~/.rbenv/plugins</code></li>
</ul>

<p><code>
$ git clone https://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build
</code></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/02_rbenv/11">
<h1>Instalando rbenv-gem-rehash</h1>

<ul>
<li>Clonamos el plugin en el directorio <code>~/.rbenv/plugins</code></li>
</ul>

<p><code>
$ git clone https://github.com/sstephenson/rbenv-gem-rehash.git ~/.rbenv/plugins/rbenv-gem-rehash
</code></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/02_rbenv/12">
<h1>Instalando rbenv-update</h1>

<ul>
<li>Clonamos el plugin en el directorio <code>~/.rbenv/plugins</code></li>
</ul>

<p><code>
$ git clone https://github.com/rkh/rbenv-update.git ~/.rbenv/plugins/rbenv-update
</code></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/02_rbenv/13">
<h1>rbenv: Comandos</h1>

<ul>
<li><code>rbenv versions</code> muestra las versiones instaladas de ruby (con un * la versi&#xF3;n actual)</li>
<li><code>rbenv global</code> muestra o setea la versi&#xF3;n global de ruby</li>
</ul>

<p><code>
$ rbenv global # muestra la versi&#xF3;n global
</code></p>

<p><code>
$ rbenv global 2.0.0-p247 # setea la versi&#xF3;n 2.0.0-p247 como global
</code></p>

<ul>
<li><p><code>rbenv local</code> identico al comando anterior, pero para el directorio actual</p></li>
<li><p><code>rbenv install</code> instala rubies! (con <code>-l</code> listamos todas las versiones disponibles)</p></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="04-VMs/02_rbenv/14">
<h1>Referencias</h1>

<ul>
<li><a href="https://rvm.io/">https://rvm.io/</a></li>
<li><a href="https://github.com/sstephenson/rbenv">https://github.com/sstephenson/rbenv</a></li>
<li><a href="https://github.com/sstephenson/ruby-build">https://github.com/sstephenson/ruby-build</a></li>
<li><a href="https://github.com/sstephenson/rbenv-gem-rehash">https://github.com/sstephenson/rbenv-gem-rehash</a></li>
<li><a href="https://github.com/rkh/rbenv-update">https://github.com/rkh/rbenv-update</a></li>
<li><a href="https://github.com/postmodern/chruby">https://github.com/postmodern/chruby</a></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="05-clases-objetos-variables/01_objetos-y-atributos/1">
<h1>Clases, objetos y variables</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="05-clases-objetos-variables/01_objetos-y-atributos/2">
<h1>Empezamos por los objetos y sus atributos</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="05-clases-objetos-variables/01_objetos-y-atributos/3">
<h1>Introducci&#xF3;n</h1>

<ul>
<li><p>Luego de haber recibido una <em>dosis de Ruby</em> ya conocemos un poco sobre la
sint&#xE1;xis de este lenguaje</p></li>
<li><p>Para entender mejor los objetos, vamos a hacerlo mediante un ejemplo
<em>-tomado del libro Programming Ruby (Pick Axe)</em>:</p></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content" ref="05-clases-objetos-variables/01_objetos-y-atributos/4">
<h1>El problema...</h1>

<h2>Librer&#xED;a de reventa de libros</h2>

<p>Reventa de libros usuados que realiza control de stock semanalmente</p>

<p>Mediante lectores de c&#xF3;digos de barra se registra cada libro en las 
bibliotecas. Cada lector, genera un archivo separado por comas (CSV) que contiene 
una fila para cada libro registrado.</p>

<p>Cada fila contiene entre otros datos: ISBN del libro y precio. Un extracto del
archivo ser&#xED;a:</p>

<pre><code>"Date","ISBN","Amount"
"2008-04-12","978-1-9343561-0-4",39.45
"2008-04-13","978-1-9343561-6-6",45.67
"2008-04-14","978-1-9343560-7-4",36.95</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="05-clases-objetos-variables/01_objetos-y-atributos/5">
<h1>&#xBF;Qu&#xE9; tenemos que hacer?</h1>

<ul>
<li>Tomar todos los CSV de cada lectora y determinar cu&#xE1;ntos ejemplares de cada
t&#xED;tulo disponemos</li>
<li>Determinar adem&#xE1;s el monto total en libros que tenemos</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content" ref="05-clases-objetos-variables/01_objetos-y-atributos/6">
<h1>Creamos la clase <code>BookInStock</code></h1>

<p><em>Recordamos que los nombres de las clases deben comenzar con may&#xFA;sculas, los
m&#xE9;todos con min&#xFA;scula</em></p>

<pre class="sh_ruby"><code>class BookInStock
end</code></pre>

<p>Lo probamos:</p>

<pre class="sh_ruby"><code>a_book = BookInStock.new
another_book = BookInStock.new</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="05-clases-objetos-variables/01_objetos-y-atributos/7">
<h1>Pero...</h1>

<ul>
<li><p>En el ejemplo anterior: </p>

<ul>
<li>Se crean dos objetos diferentes de la clase <code>BookInStock</code>. </li>
<li>Podr&#xED;amos decir en esta primer instancia que son el mismo libro, o iguales porque nada los
distingue...</li>
</ul></li>
<li><p>Lo solucionamos obligando que la inicializaci&#xF3;n indique aquellos datos que distinga al
libro</p></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/01_objetos-y-atributos/8">
<h1>La nueva implementaci&#xF3;n</h1>

<pre class="sh_ruby"><code>class BookInStock
    def initialize(isbn, price)
        @isbn = isbn
        @price = Float(price)
    end
end</code></pre>

<ul>
<li>El m&#xE9;todo <code>initialize</code> es especial en Ruby </li>
<li>Cuando se invoca el m&#xE9;todo <code>new</code>, Ruby aloca memoria para alojar un objeto no
inicializado y luego invoca al m&#xE9;todo <code>initialize</code> <strong>pas&#xE1;ndole cada par&#xE1;metro
que fue enviado a <code>new</code></strong></li>
<li>Entonces <code>initialize</code> nos permite configurar el estado inicial de nuestros objetos</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/01_objetos-y-atributos/9">
<h1>Continuamos analizando <code>initialize</code></h1>

<ul>
<li>Vemos que se utilizan variables de instancia: 

<ul>
<li>Comienzan con <strong>@</strong></li>
<li>Esto permite que los valores recibidos como par&#xE1;metros no se pierdan luego
de ejecutar <code>initialize</code></li>
<li>Por ello almacenamos estos valores en variables de instancia</li>
</ul></li>
<li>Podr&#xED;amos pensar que <code>@isbn</code> e <code>isbn</code> est&#xE1;n relacionadas, pero:

<ul>
<li>No hay relaci&#xF3;n alguna m&#xE1;s que coinciden en el nombre</li>
<li>Pero ambas son variables diferentes, una con un nombre que comienza con
<strong>@</strong> y otra <strong>no</strong></li>
</ul></li>
<li>Notamos adem&#xE1;s que se realiza una peque&#xF1;a validaci&#xF3;n

<ul>
<li>El m&#xE9;todo
<a href="http://www.ruby-doc.org/core-2.0.0/Kernel.html#method-i-Float"><code>Float</code></a>
toma un argumento y lo convierte a <code>float</code>, terminando el programa si falla
la conversi&#xF3;n</li>
</ul></li>
</ul>

<p><em>Analizar c&#xF3;mo es que <code>Float</code> es un m&#xE9;todo</em></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/01_objetos-y-atributos/10">
<h1>Usamos los nuevos objetos</h1>

<pre class="sh_ruby"><code>b1 = BookInStock.new("isbn1", 3)
p b1
b2 = BookInStock.new("isbn2", 3.14)
p b2
b3 = BookInStock.new("isbn3", "5.67")
p b3</code></pre>

<ul>
<li>Usamos el m&#xE9;todo <code>p</code> porque imprime el estado interno de los objetos. </li>
<li><code>puts</code> por defecto imprime <code>#&lt;nombre_de_clase:id_objeto_en_hex&gt;</code>

<ul>
<li><code>to_s</code>, que es enviado a cualquier objeto que necesita convertirse a <code>string</code> </li>
</ul></li>
</ul>

<h2>Agregamos <code>to_s</code></h2>

<pre class="sh_ruby"><code>class BookInStock
    def to_s
        "ISBN: #{@isbn}, price: #{@price}"
    end
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/01_objetos-y-atributos/11">
<h1>Objetos y sus atributos</h1>

<ul>
<li>Un objeto como el mostrado anteriormente no permite que nadie acceda a sus
variables</li>
<li>Si bien es algo positivo encapsular, si no permitimos acceder a los datos que
mantienen el estado del objeto, el mismo se vuelve in&#xFA;til.</li>
<li>A las <em>ventanas</em> de acceso a los objetos las denominaremos <strong>atributos</strong></li>
<li>Modificaremos nuestra clase de <code>BookInStock</code> con el fin de agregar atributos
para <code>isbn</code> y <code>price</code> as&#xED; podemos contabilizarlos</li>
</ul>

<h2>Definici&#xF3;n de los atributos:</h2>

<pre class="sh_ruby"><code>class BookInStock
    def isbn
        @isbn 
    end

    def price
        @price
    end
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/01_objetos-y-atributos/12">
<h1>Acceso a los atributos</h1>

<ul>
<li>A los atributos anteriores se los denomina <code>accesor</code> porque mapean
directamente con las variables de instancia</li>
<li>Como escribir accesors es algo com&#xFA;n, Ruby provee un shortcut: <code>attr_reader</code></li>
</ul>

<h2>Usando <code>attr_reader</code></h2>

<pre class="sh_ruby"><code>class BookInStock
    attr_reader :isbn, :price

    def initialize(isbn, price)
        @isbn = isbn
        @price = Float(price)
    end
    # ..
end</code></pre>

<ul>
<li>Notar que se utilizan <strong>s&#xED;mbolos para los nombres de los m&#xE9;todos</strong></li>
<li>Suele confundirse con determinadas funciones presentes en otros lenguajes que
<code>attr_reader</code> define variables de instancia, y <strong>no lo hace</strong>

<ul>
<li>S&#xF3;lo los m&#xE9;todos de acceso como los que definimos inicialmente</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/01_objetos-y-atributos/13">
<h1>Atributos de escritura</h1>

<ul>
<li>No s&#xF3;lo leemos atributos: a veces necesitamos modificar un valor</li>
<li>Ruby permite modificar atributos definiendo un m&#xE9;todo terminado con <strong>el signo
igual</strong>:</li>
</ul>

<h2>Agregamos <code>price=</code></h2>

<pre class="sh_ruby"><code>class BookInStock
    attr_reader :isbn, :price

    def initialize(isbn, price)
        @isbn = isbn
        @price = Float(price)
    end

    def price=(new_price)
        @price = new_price
    end
    # ...
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/01_objetos-y-atributos/14">
<h1>Atributos de escritura</h1>

<pre class="sh_ruby"><code>book = BookInStock.new("isbn1", 33.80)
puts "ISBN = #{book.isbn}"
puts "Price = #{book.price}"
book.price = book.price * 0.75 # discount price
puts "New price = #{book.price}"</code></pre>

<ul>
<li>Al igual que con <code>attr_reader</code> ruby provee un shortcut para accessors de
s&#xF3;lo escritura: <code>attr_writer</code> (raramente usado)</li>
<li>Es m&#xE1;s com&#xFA;n utilizar <code>attr_accessor</code> que provee acceso R/W</li>
</ul>

<h2>La clase definitiva:</h2>

<pre class="sh_ruby"><code>class BookInStock

    attr_reader :isbn
    attr_accessor :price

    def initialize(isbn, price)
        @isbn = isbn
        @price = Float(price)
    end
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/01_objetos-y-atributos/15">
<h1>Atributos virtuales</h1>

<h2>Agregamos el precio en centavos</h2>

<pre class="sh_ruby"><code>class BookInStock
    attr_reader :isbn
    attr_accessor :price

    def initialize(isbn, price)
        @isbn = isbn
        @price = Float(price)
    end

    def price_in_cents
        Integer(price*100 + 0.5)
    end

    def price_in_cents=(cents)
        @price = cents / 100.0
    end
    # ...
end</code></pre>

<ul>
<li>Notamos que no hay correspondencia con variables de instancia como es el caso 
de <code>price</code> e <code>isbn</code></li>
<li>Pero el mapeo es con <code>price</code></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/01_objetos-y-atributos/16">
<h1>El lector de CSV</h1>

<ul>
<li>Repasamos qu&#xE9; debe realizar el programa a desarrollar:

<ul>
<li>Leer varios archivos CSV</li>
<li>Totalizar ejemplares iguales</li>
<li>Totalizar el precio de los libros en stock</li>
</ul></li>
</ul>

<h2>El esqueleto de <code>CsvReader</code></h2>

<pre class="sh_ruby"><code>class CsvReader
    def initialize
        # ...
    end

    def read_in_csv_data(csv_file_name)
    # ...
    end

    def total_value_in_stock
    # ...
    end

    def number_of_each_isbn
    # ...
    end
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/01_objetos-y-atributos/17">
<h1>&#xBF;C&#xF3;mo usr&#xED;amos CsvReader?</h1>

<pre class="sh_ruby"><code>reader = CsvReader.new
reader.read_in_csv_data("file1.csv")
reader.read_in_csv_data("file2.csv")
:               :               :
puts "Total value in stock = \
    #{reader.total_value_in_stock}"</code></pre>

<ul>
<li>Notamos que <code>CsvReader</code> debe ir acumulando lo que va leyendo de cada csv</li>
<li>Para ello mantendremos un arreglo de valores como variable de instancia</li>
<li>Para leer un CSV, Ruby provee de una simple librer&#xED;a que simplificar&#xE1; el
trabajo</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/01_objetos-y-atributos/18">
<h1>Comportamiento de CsvReader</h1>

<pre class="sh_ruby"><code>require 'csv'

class CsvReader

    def initialize
        @books_in_stock = []
    end

    def read_in_csv_data(csv_file_name)
        CSV.foreach(csv_file_name, headers: true) do |row|
            @books_in_stock &lt;&lt; 
                BookInStock.new(row["ISBN"], row["Amount"])
        end
    end
end</code></pre>

<ul>
<li>En <code>read_in_csv_data</code> la primer l&#xED;nea indica la apertura del archivo
<code>csv_file_name</code> y el par&#xE1;metro <code>headers: true</code> indica a la librer&#xED;a que la
primer l&#xED;nea del archivo son los encabezados de cada columna o campo</li>
<li>La librer&#xED;a pasar&#xE1; entonces cada fila le&#xED;da al bloque mostrado. Notar que el
acceso a cada campo se corresponde con los <strong>nombres de las columnas</strong></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="05-clases-objetos-variables/01_objetos-y-atributos/19">
<h1>Calculando el precio total</h1>

<pre class="sh_ruby"><code>class CsvReader

    # Luego veremos como usar inject...
    def total_value_in_stock
        sum = 0.0
        @books_in_stock.each do |book| 
            sum += book.price
        end
        sum
    end

end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="05-clases-objetos-variables/01_objetos-y-atributos/20">
<h1>Fragmentaci&#xF3;n de un programa</h1>

<ul>
<li>Dividimos el c&#xF3;digo en tres archivos

<ul>
<li><code>book_in_stock.rb</code>: contendr&#xE1; la clase <code>BookInStock</code></li>
<li><code>csv_reader.rb</code>: ser&#xE1; el c&#xF3;digo de <code>CsvReader</code></li>
<li><code>stock_stats.rb</code>: ser&#xE1; el programa principal</li>
</ul></li>
<li>Aparecer&#xE1;n dependencias entre ellos

<ul>
<li>Para cargar dependencias externas se utiliza: <code>require</code> y <code>require_relative</code></li>
</ul></li>
</ul>

<h2>El programa principal <code>stock_stats.rb</code></h2>

<pre class="sh_ruby"><code>require_relative 'csv_reader'

reader = CsvReader.new
ARGV.each do |csv_file_name|
    STDERR.puts "Processing #{csv_file_name}"
    reader.read_in_csv_data(csv_file_name)
end

puts "Total value = #{reader.total_value_in_stock}"</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="05-clases-objetos-variables/01_objetos-y-atributos/21">
<h1>Control de acceso</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="05-clases-objetos-variables/01_objetos-y-atributos/22">
<h1>Control de acceso</h1>

<ul>
<li>Al dise&#xF1;ar la interfaz de una clase es importante definir qu&#xE9; publicaremos al
mundo</li>
<li>Permitir demasiado acceso a nuestras clases, incrementar&#xE1; el riesgo de
<strong>acoplamiento</strong> de la aplicaci&#xF3;n

<ul>
<li>Los usuarios de una clase que se expone demasiado podr&#xED;an confiar en
detalles de implementaci&#xF3;n en vez de su interfaz l&#xF3;gica</li>
</ul></li>
<li>Ruby provee control de acceso a los m&#xE9;todos (que son quienes permitir&#xED;an
alterar el estado de un objeto)</li>
<li>Una regla importante es:

<ul>
<li>Nunca exponer m&#xE9;todos que puedan dejar un objeto en estado inv&#xE1;lido</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="05-clases-objetos-variables/01_objetos-y-atributos/23">
<h1>Niveles de protecci&#xF3;n</h1>

<ul>
<li><strong>P&#xFA;blicos:</strong> los m&#xE9;todos p&#xFA;blicos pueden invocarse por cualquiera (no hay
control de acceso). Los m&#xE9;todos son p&#xFA;blicos por defecto excepto initialize que
siempre es privado.</li>
<li><strong>Protegidos:</strong> pueden invocarse s&#xF3;lo por objetos de la clase que lo define y 
sus subclases. El acceso queda en la familia.</li>
<li><strong>Privados:</strong> estos m&#xE9;todos no pueden ser invocados con un receptor expl&#xED;cito: 
<em>el receptor es siempre el objeto actual, mejor conocido como <code>self</code></em>. Esto
significa que tampoco puede invocar el m&#xE9;todo privado de otra instancia de la
misma clase.</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="05-clases-objetos-variables/01_objetos-y-atributos/24">
<h1>Aplicando accesos</h1>

<pre class="sh_ruby"><code>class MyClass
    def method  #default is public
    #...
    end

    protected   # subsequent methods will be 'protected'

    def method2
    #...
    end

    private     # subsequent methods will be 'private'

    def method3
    #...
    end

    public      # subsequent methods will be 'public'

    def method4
    #...
    end
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="05-clases-objetos-variables/01_objetos-y-atributos/25">
<h1>Alternativamente</h1>

<pre class="sh_ruby"><code>class MyClass
    def method1
    end

    public :method1, :method4
    protected :method2
    private :method3
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="05-clases-objetos-variables/01_objetos-y-atributos/26">
<h1>Variables</h1>

<ul>
<li>Hemos usado variables en varias oportunidades</li>
<li>Se usan para no perder valores y poder referenciarlos nuevamente</li>
<li>Cada variable es una <strong>referencia</strong> a un objeto</li>
<li>Son lo &#xFA;nico que no son objetos en ruby: </li>
</ul>

<p><em>Is a variable an object?</em> <strong><em>In Ruby, the answer is no.</em></strong> <em>A variable is simply a
reference to an object. Objects float around in a big pool somewhere (the heap, most of the
time) and are pointed to by variables.</em></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="05-clases-objetos-variables/01_objetos-y-atributos/27">
<h1>Variables como alias</h1>

<h2>Analicemos el siguiente ejemplo</h2>

<pre class="sh_ruby"><code>person1 = "Tim"
person2 = person1
person1[0] = 'J'
puts "person1 is #{person1}"
puts "person2 is #{person2}"</code></pre>

<h2>Para evitarlo: <code>dup</code></h2>

<pre class="sh_ruby"><code>person1 = "Tim"
person2 = person1.dup
person1[0] = 'J'
puts "person1 is #{person1}"
puts "person2 is #{person2}"</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="05-clases-objetos-variables/01_objetos-y-atributos/28">
<h1>Freezando un objeto</h1>

<h2>Es posible freezar objetos</h2>

<pre class="sh_ruby"><code>person1 = "Tim"
person2 = person1
person1.freeze
person2[0] = 'J'</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/1">
<h1>Contenedores, bloques e iteradores</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/2">
<h1>Introducci&#xF3;n</h1>

<ul>
<li>Las colecciones representan elementos fundamentales de cualquier programa</li>
<li>Ruby provee dos clases que representan colecciones: 

<ul>
<li><code>array</code></li>
<li><code>hash</code> o  arreglo asociativo</li>
</ul></li>
<li>El correcto uso de estas colecciones es fundamental en la programaci&#xF3;n Ruby</li>
<li>Los bloques, combinados con colecciones se convierten en construcciones muy
poderosas para la iteraci&#xF3;n</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/3">
<h1>Array</h1>

<ul>
<li>La clase <code>Array</code> mantiene una colecci&#xF3;n de referencias a objetos. </li>
<li>Cada referencia a objeto ocupa una posici&#xF3;n en el arreglo, identificada por un
&#xED;ndice entero no negativo</li>
</ul>

<h2>Ejemplos de array</h2>

<pre class="sh_ruby"><code>a = [ 3.14159, "pie", 99 ]
a.class
a.length
a[0]
a[1]
a[2]
a[3]

b = Array.new
b.class
b.length
b[0] = "second"
b[1] = "array"
b</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/4">
<h1>Arrays y <code>[]</code></h1>

<ul>
<li>Los elementos de un arreglo se acceden con el operador <code>[]</code></li>
<li>Pero <code>[]</code> es un m&#xE9;todo (de instancia en la clase <code>Array</code>) y por tanto puede
implementarse por cualquier subclase</li>
<li>El primer &#xED;ndice de un arreglo es el cero</li>
<li>Un arreglo accedido en un &#xED;ndice positivo retorna el objeto referenciado en
esa posici&#xF3;n.

<ul>
<li>Si no hay objeto, retorna <code>nil</code></li>
</ul></li>
<li>Un arreglo accedido en un &#xED;ndice negativo, retorna el objeto contando desde el
final</li>
</ul>

<h2>Indices negativos</h2>

<pre class="sh_ruby"><code>a = [ 1, 7, 9]
a[-1]
a[-2]
a[-99]</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/5">
<h1>Arrays y <code>[]</code></h1>

<h2>Indexando con un par de valores</h2>

<pre class="sh_ruby"><code>a = [ 1, 3, 5, 7, 9 ]
a[1, 3]
a[3, 1]
a[-3, 2]</code></pre>

<p><em>Acceder arrays con dos valores indica <code>[start,count]</code> y retorna siempre un
nuevo <code>array</code></em></p>

<h2>Pueden usarse rangos</h2>

<pre class="sh_ruby"><code>a = [ 1, 3, 5, 7, 9]
a[1..3]
a[1...3]
a[3..3]
a[-3..-1]</code></pre>

<ul>
<li>El rango indica los &#xED;ndices <strong>desde</strong> y <strong>hasta</strong></li>
<li>Usando <code>..</code> se incluye el fin de rango</li>
<li>Usando <code>...</code> se <strong>excluye</strong> el extremo final</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/6">
<h1>Arrays y <code>[]=</code></h1>

<ul>
<li>El m&#xE9;todo <code>[]=</code> permite setear elementos de un array</li>
<li>Si se utiliza con un &#xFA;nico &#xED;ndice, entonces reemplaza su valor por lo que est&#xE9;
a la derecha de la asignaci&#xF3;n

<ul>
<li>Cualquier gap que haya quedado luego de <code>[]=</code> se completa con nil</li>
</ul></li>
</ul>

<h2>Un ejemplo</h2>

<pre class="sh_ruby"><code>a = [ 1, 3, 5, 7, 9 ]
a[1] = 'bat'
a[-3] = 'cat'
a[3] = [ 9, 8 ]
a[6] = 99</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/7">
<h1>Arrays y <code>[]=</code></h1>

<ul>
<li>Si se utiliza con dos valores (inicio, cantidad) o un rango, luego estos
elementos son reemplazados por lo que est&#xE9; a la derecha de la asignaci&#xF3;n

<ul>
<li>Si la cantidad de elementos a reemplazar es cero, entonces el valor 
es insertado en el array antes de la posici&#xF3;n inicial: <strong>no se eliminan 
elementos</strong></li>
<li>Si el valor a la <strong>derecha es un arreglo</strong>, sus elementos se utilizan en el 
reemplazo: el tama&#xF1;o del arreglo destino es actualizado si la cantidad de
elementos a la derecha difiere de los elementos a reemplazar</li>
</ul></li>
</ul>

<h2>Ejemplo clarificador</h2>

<pre class="sh_ruby"><code>a = [ 1, 3, 5, 7, 9 ]
a[2, 2] = 'cat'
a[2, 0] = 'dog'
a[1, 1] = [ 9, 8, 7 ]
a[0..3] = []
a[5..6] = 99, 98</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/8">
<h1>Arrays usados como pilas</h1>

<ul>
<li>Podomos invocar los siguientes m&#xE9;todos de <code>Array</code>

<ul>
<li><code>push</code></li>
<li><code>pop</code></li>
</ul></li>
</ul>

<h2>La Pila</h2>

<pre class="sh_ruby"><code>stack = []
stack.push "red"
stack.push "green"
stack.push "blue"
p stack
puts stack.pop
puts stack.pop
puts stack.pop
p stack</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/9">
<h1>Arrays usados como colas</h1>

<ul>
<li>Podemos invocar los siguientes m&#xE9;todos de <code>Array</code>

<ul>
<li><code>unshift</code></li>
<li><code>shift</code></li>
</ul></li>
</ul>

<h2>La Cola</h2>

<pre class="sh_ruby"><code>queue = []
queue.push "red"
queue.push "green"
puts queue.shift
puts queue.shift</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/10">
<h1>El principio y el final</h1>

<pre class="sh_ruby"><code>array = [ 1, 2, 3, 4, 5, 6, 7 ]
p array.first(4)
p array.last(4)</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/11">
<h1>Hashes</h1>

<ul>
<li>Los arreglos se indexan con enteros, los hashes con objetos

<ul>
<li>S&#xED;mbolos, strings, expresiones regulares, etc</li>
</ul></li>
<li>Cuando se almacena un valor en un hash, deben proveerse dos objetos:

<ul>
<li>El &#xED;ndice, generalmente llamado <em>key</em></li>
<li>La entrada a almacenar en dicho &#xED;ndice, generalmente llamado <em>valor</em></li>
</ul></li>
<li>El acceso a los valores referenciados por un hash se realiza por medio de los
<em>keys</em></li>
</ul>

<h2>Un ejemplo</h2>

<pre class="sh_ruby"><code>h = { 'dog' =&gt; 'canine', 'cat' =&gt; 'feline' }
h.length # =&gt; 3
h['dog'] # =&gt; "canine"
h['cow'] = 'bovine'
h[12] = 'dodecine'
h['cat'] = 99</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/12">
<h1>Acceso a los hashes</h1>

<ul>
<li>En el ejemplo anterior se utilizan strings como claves</li>
</ul>

<h2>Ejemplo con s&#xED;mbolos</h2>

<pre class="sh_ruby"><code># En ruby &gt;= 1.9
h = { dog: 'canine', cat: 'feline' }

# En ruby &lt; 1.9
h = { :dog =&gt; 'canine', :cat =&gt; 'feline' }</code></pre>

<ul>
<li>Comparado a los arreglos, los hashes tienen una ventaja: se indexan con
objetos</li>
<li>A partir de la versi&#xF3;n 1.9 adem&#xE1;s se recuerda el &#xF3;rden en que fueron
insertados los elementos

<ul>
<li>Cuando se itera sobre las entradas de un hash se respeta el orden de
inserci&#xF3;n</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/13">
<h1>Un ejemplo usando Array y Hash</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/14">
<h1>Frecuencia de palabras</h1>

<p><em>Calcular el n&#xFA;mero de veces que aparece una palabra en un texto</em></p>

<ul>
<li>El problema se divide en dos partes:

<ul>
<li>Separar el texto en palabras: <em>suena como un array</em></li>
<li>Luego contar cada palabra diferente: <em>suena como hash</em></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/15">
<h1>La soluci&#xF3;n</h1>

<h2>El m&#xE9;todo que obtiene las palabras</h2>

<pre class="sh_ruby"><code>def words_from_string(string)
    string.downcase.scan(/[\w']+/)
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/16">
<h1>La soluci&#xF3;n</h1>

<h2>El m&#xE9;todo que cuenta las palabras</h2>

<ul>
<li>Usaremos un hash, indexado por las palabras a contar</li>
<li>El valor ser&#xE1; la cantidad de ocurrencias 

<ul>
<li>Tendremos que incializar la primer ocurrencia en el valor 1 para luego sumar</li>
</ul></li>
</ul>

<h2>La primer idea...</h2>

<p><em>Asumimos que counts es un <code>Hash</code></em></p>

<pre class="sh_ruby"><code>if counts.has_key?(next_word)
    counts[next_word] += 1
else
    counts[next_word] = 1
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/17">
<h1>La soluci&#xF3;n</h1>

<ul>
<li>Podemos ordenar un poco la idea anterior

<ul>
<li><code>Hash.new</code> puede recibir como par&#xE1;metro el valor usado para incializar cada
valor del Hash. <em>(por ejemplo cuando se accede a un valor que no existe a&#xFA;n en
el Hash)</em></li>
</ul></li>
</ul>

<h2>La misma idea m&#xE1;s ordenada</h2>

<pre class="sh_ruby"><code>def count_frequency(word_list)
    counts = Hash.new(0)
    for word in word_list
        counts[word] += 1
    end
    counts
end</code></pre>

<p>Ver el ejemplo completo en la carpeta <code>samples/05/words_frequency</code></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/18">
<h1>Testeando nuestra soluci&#xF3;n</h1>

<ul>
<li>Aplicar un test r&#xE1;pido es una buena pr&#xE1;ctica.</li>
<li>Si bien lo veremos m&#xE1;s adelante, vamos introduciendo el concepto</li>
<li>Utilizaremos un framework de test llamado <code>Test::Unit</code> que ya incluye ruby como
parte de la librer&#xED;a est&#xE1;ndar</li>
<li>S&#xF3;lo explicaremos el m&#xE9;todo <code>assert_equal</code> que chequea si los dos par&#xE1;metros 
que se le env&#xED;an son iguales, indicando <strong>fuertemente</strong> si as&#xED; no
sucede</li>
<li>Utilizaremos <strong>afirmaciones</strong> <em>(en ingl&#xE9;s assertions)</em> para testear los dos
m&#xE9;todos implementados, uno por vez

<ul>
<li>He aqu&#xED; la raz&#xF3;n por la que se escribieron como m&#xE9;todos separados</li>
<li>Tener m&#xE9;todos diferentes permite testearlos en forma aislada</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/19">
<h1>Testeamos <code>words_from_string</code></h1>

<pre class="sh_ruby"><code>require_relative 'words_from_string.rb'
require 'minitest/autorun'

class TestWordsFromString &lt; Minitest::Test
    def test_empty_string
        assert_equal([], words_from_string(""))
        assert_equal([], words_from_string(" "))
    end
    def test_single_word
        assert_equal(["cat"], words_from_string("cat"))
        assert_equal(["cat"], words_from_string(" cat "))
    end
    def test_many_words
        assert_equal(["the", "cat", "sat", "on","the","mat"],
                words_from_string("the cat sat on the mat"))
    end
    def test_ignores_punctuation
        assert_equal(["the", "cat's", "mat"],
                words_from_string("&lt;the!&gt; cat's, -mat...-"))
    end
end</code></pre>

<p>En esta clase, los m&#xE9;todos que comienzan con <strong>test</strong> ser&#xE1;n corridos
por el framework de testing</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/20">
<h1>Testeamos <code>count_frequency</code></h1>

<pre class="sh_ruby"><code>require_relative 'count_frequency.rb'
require 'minitest/autorun'

class TestCountFrequency &lt; Minitest::Test
    def test_empty_list
        assert_equal({}, count_frequency([]))
    end
    def test_single_word
        assert_equal({"cat" =&gt; 1}, count_frequency(["cat"]))
    end
    def test_two_different_words
        assert_equal({"cat" =&gt; 1, "sat" =&gt; 1},
                    count_frequency(["cat", "sat"]))
    end
    def test_two_words_with_adjacent_repeat
        assert_equal({"cat" =&gt; 2, "sat" =&gt; 1},
                    count_frequency(["cat", "cat", "sat"]))
    end
    def test_two_words_with_non_adjacent_repeat
        assert_equal({"cat" =&gt; 2, "sat" =&gt; 1},
                    count_frequency(["cat", "sat", "cat"]))
    end
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/21">
<h1>Bloques e iteradores</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/22">
<h1>Introducci&#xF3;n</h1>

<h2>En <code>samples/05/words_frequency/top_five</code> usamos:</h2>

<pre class="sh_ruby"><code>for i in 0...5
    word = top_five[i][0]
    count = top_five[i][1]
    puts "#{word}: #{count}"
end</code></pre>

<p>En cualquier lenguaje esto es natural</p>

<h2>Mucho m&#xE1;s intuitivo es:</h2>

<pre class="sh_ruby"><code>top_five.each do |word, count|
    puts "#{word}: #{count}"
end

# o m&#xE1;s simple:
top_five.each { |word, count| puts "#{word}: #{count}" }</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/23">
<h1>Bloques</h1>

<ul>
<li>Un bloque es c&#xF3;digo encerrado entre llaves o las palabras claves <code>do</code> y <code>end</code></li>
<li>Ambas formas son id&#xE9;nticas, salvo por la precedencia 

<ul>
<li>Cuando el c&#xF3;digo del bloque entra en una l&#xED;nea usar {}</li>
<li>Cuando tiene m&#xE1;s de una l&#xED;nea usar <code>do</code> / <code>end</code></li>
</ul></li>
<li>Los bloques pueden verse como m&#xE9;todos an&#xF3;nimos</li>
<li>Pueden recibir par&#xE1;metros, que se explicitan entre barras verticales <code>|</code></li>
<li>El c&#xF3;digo de un bloque no se ejecuta cuando se define, sino que se almacenar&#xE1;
para ser ejecutado m&#xE1;s adelante</li>
<li>En ruby, los bloques s&#xF3;lo podr&#xE1;n usarse despu&#xE9;s de la <em>invocaci&#xF3;n</em> de alg&#xFA;n
m&#xE9;todo

<ul>
<li>Si el m&#xE9;todo recibe par&#xE1;metros, entonces aparecer&#xE1; luego de ellos</li>
<li>Podr&#xED;a verse incluso como un par&#xE1;metro extra que es pasado al m&#xE9;todo</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/24">
<h1>Ejemplo</h1>

<h2>Suma de los cuadrados de los n&#xFA;meros en un arreglo</h2>

<pre class="sh_ruby"><code>sum = 0
[1, 2, 3, 4].each do |value|
    square = value * value
    sum += square
end
puts sum</code></pre>

<ul>
<li>El bloque se invoca para cada elemento en el arreglo</li>
<li>El elemento del arreglo es pasado al bloque en la variable <code>value</code></li>
<li>La variable <code>sum</code> declarada fuera del bloque es actualizada dentro del bloque

<ul>
<li><strong>Regla importante:</strong> <em>si existe una variable en el bloque con el mismo
nombre que una variable dentro del alcance fuera del bloque, ambas ser&#xE1;n la
misma. En el ejemplo hay s&#xF3;lo una variable <code>sum</code></em></li>
<li>Veremos que el comportamiento mencionado podremos cambiarlo</li>
<li>Si una variable aparece s&#xF3;lo en el bloque, entonces ser&#xE1; local al mismo (como
<code>square</code>)</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/25">
<h1>Los casos no esperados</h1>

<pre class="sh_ruby"><code># assume Shape defined elsewhere
square = Shape.new(sides: 4) 
#
# .. lots of code
#
sum = 0
[1, 2, 3, 4].each do |value|
    square = value * value
    sum += square
end

puts sum
square.draw # BOOM!</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/26">
<h1>Mas casos</h1>

<h2>No sucede lo mismo con los argumentos al bloque</h2>

<pre class="sh_ruby"><code>value = "some shape"
[ 1, 2 ].each {|value| puts value }
puts value</code></pre>

<h2>Podemos solucionar el problema de <code>square</code></h2>

<pre class="sh_ruby"><code>square = "some shape"
sum = 0
[1, 2, 3, 4].each do |value; square|
    square = value * value # different variable
    sum += square
end
puts sum
puts square</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/27">
<h1>La magia de los bloques</h1>

<ul>
<li>Mencionamos que los bloques se utilizan de forma adyacente a la llamada a un
m&#xE9;todo y que no se ejecutan en el momento en que aparecen en el c&#xF3;digo</li>
<li>Para lograr este comportamiento, dentro de un m&#xE9;todo cualquiera, podremos
invocar un bloque

<ul>
<li>Los bloques se invocar&#xE1;n como si fueran m&#xE9;todos</li>
<li>Para invocar un bloque se utiliza la sentencia <code>yield</code></li>
<li>Al invocar <code>yield</code> ruby invocar&#xE1; al c&#xF3;digo del bloque </li>
<li>Cuando el bloque finaliza, ruby devuelve el c&#xF3;digo inmediatamente al
finalizar el llamado a <code>yield</code></li>
</ul></li>
</ul>

<h2>Un ejemplo</h2>

<pre class="sh_ruby"><code>def three_times
    yield
    yield
    yield
end
three_times { puts "Hola" }</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/28">
<h1>Par&#xE1;metros a un bloque</h1>

<ul>
<li>Cuando utilizamos yield podemos enviarle un par&#xE1;metro

<ul>
<li>El par&#xE1;metro enviado se mapea con el definido en el bloque entre las barras
verticales</li>
</ul></li>
<li>Un bloque puede retornar un valor y ser usado en el m&#xE9;todo</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/29">
<h1>Ejemplo de env&#xED;o de par&#xE1;metros</h1>

<pre class="sh_ruby"><code>def fib_up_to(max)
    i1, i2 = 1, 1
    while i1 &lt;= max
        yield i1
        i1, i2 = i2, i1+i2
    end
end

fib_up_to(1000) {|f| print f, " " }</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/30">
<h1>Ejemplo de uso del valor retornado</h1>

<pre class="sh_ruby"><code>class Array
    def my_find
        for i in 0...size
            value = self[i]
            return value if yield(value)
        end
        return nil
    end
end

(1..200).to_a.my_find {|x| x%5 == 0}
(1..200).to_a.my_find {|x| x == 0}</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/31">
<h1>Los iteradores</h1>

<ul>
<li>Las clases que implementan colecciones, como <code>Array</code> <em>hacen lo que hacen
mejor:</em>

<ul>
<li>Acceder a los elementos que contienen</li>
</ul></li>
<li>El comportamiento de qu&#xE9; hacer con cada elemento lo delegan a la aplicaci&#xF3;n

<ul>
<li>Permitiendo que nos concentremos s&#xF3;lo en un requerimiento particular</li>
<li>En los casos anteriores (<code>find</code>), ser&#xED;a encontrar un elemento para el cual
el criterio sea verdadero</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/32">
<h1>Los iteradores <code>each</code> y <code>collect</code></h1>

<ul>
<li>El iterador <code>each</code> es el m&#xE1;s simple 

<ul>
<li>Solo invoca <code>yield</code> para cada elemento</li>
</ul></li>
<li>El iterador <code>collect</code> tambi&#xE9;n conocido como <code>map</code> 

<ul>
<li>Invoca <code>yield</code> para cada elemento. El resultado lo guarda en un nuevo 
arreglo que es <strong>retornado</strong></li>
</ul></li>
</ul>

<h2>Ejemplos</h2>

<pre class="sh_ruby"><code>[ 1, 3, 5, 7, 9 ].each {|i| puts i }

["H", "A", "L"].collect {|x| x.succ }</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/33">
<h1>Otros usos de iteradores</h1>

<ul>
<li>Los iteradores no solo se usan con array y hash</li>
<li>Su l&#xF3;gica es muy utilizada en las clases de entrada / salida

<ul>
<li>Estas clases implementan una interfaz de iterador que retorna l&#xED;neas
sucesivas o bytes si trabajamos en bajo nivel</li>
</ul></li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>f = File.open("testfile")
f.each { |line| puts "The line is: #{line}"}
f.close</code></pre>

<h2>Y si necesitamos el &#xED;ndice</h2>

<pre class="sh_ruby"><code>f = File.open("testfile")
f.each_with_index do |line, index| 
    puts "Line #{index} is: #{line}" 
end
f.close</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/34">
<h1>El caso de <code>inject</code></h1>

<ul>
<li>Este iterador tiene un nombre <em>raro</em></li>
<li>Permite acumular un valor a lo largo de los miembros de una colecci&#xF3;n</li>
<li>Recibe un par&#xE1;metro que es el valor inicial para comenzar a acumular

<ul>
<li>Si no se especifica <strong>toma el primer elemento de la colecci&#xF3;n</strong></li>
</ul></li>
</ul>

<h2>Ejemplos</h2>

<pre class="sh_ruby"><code>[1,3,5,7].inject(0) {|sum, element| sum+element}
[1,3,5,7].inject {|sum, element| sum+element}

[1,3,5,7].inject(1) {|prod, element| prod*element}
[1,3,5,7].inject {|prod, element| prod*element}</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/35">
<h1>El caso de <code>inject</code></h1>

<h2>Generando m&#xE1;s m&#xED;stica para <code>inject</code></h2>

<pre class="sh_ruby"><code>
[1,3,5,7].inject(:+)


[1,3,5,7].inject 100, :+ 


[1,3,5,7].inject(:*)</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/36">
<h1>Enumerators</h1>

<ul>
<li>Los iteradores son muy c&#xF3;modos pero:

<ul>
<li>Son parte de la colecci&#xF3;n y no una clase a parte</li>
<li>En otros lenguajes (como Java), las colecciones no implementan sus
iteradores, sino que son clases separadas (como por ejemplo la interfaz 
Iterator de Java)</li>
<li>Es complicado iterar dos colecciones simult&#xE1;neamente</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/37">
<h1>Enumerators</h1>

<ul>
<li>La soluci&#xF3;n: clase <code>Enumerator</code>

<ul>
<li>Se obtiene de una colecci&#xF3;n con el m&#xE9;todo <code>to_enum</code> o <code>enum_for</code></li>
</ul></li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>a = [ 1, 3, "cat" ]
h = { dog: "canine", fox: "lupine" }
# Create Enumerators
enum_a = a.to_enum
enum_h = h.to_enum
enum_a.next     # =&gt; 1
enum_h.next     # =&gt; [ :dog, "canine" ]
enum_a.next     # =&gt; 3
enum_h.next     # =&gt; [ :fox, "lupine" ]</code></pre>

<p><em>Si un iterador se utiliza sin bloque, entonces retorna un iterador</em></p>

<pre class="sh_ruby"><code>a = [1,2,3].each
a.next</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/38">
<h1>El m&#xE9;todo <code>loop</code></h1>

<ul>
<li>Ejecuta el c&#xF3;digo que se encuentra dentro del bloque</li>
<li>Se puede salir con break cuando se cumple una condici&#xF3;n</li>
<li>Si hay iteradores, <code>loop</code> terminar&#xE1; cuando el Enumerator se quede sin valores</li>
</ul>

<h2>Ejemplos</h2>

<pre class="sh_ruby"><code>loop { puts "Hola" }

i=0
loop do
    puts i += 1
    break if i &gt;= 10
end

short_enum = [1, 2, 3].to_enum
long_enum = ('a'..'z').to_enum
loop { puts "#{short_enum.next} - #{long_enum.next}" }</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/39">
<h1>Usando <code>Enumerator</code> como objetos</h1>

<ul>
<li> Sabemos que es posible usar <code>each_with_index</code> en <code>Array</code></li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>result = []
[ 'a', 'b', 'c' ].each_with_index do |item, index| 
    result &lt;&lt; [item, index] 
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/40">
<h1>Usando <code>Enumerator</code> como objetos</h1>

<h2>&#xBF;Y si queremos hacer lo mismo con un <code>String</code>?</h2>

<ul>
<li>No existe <code>each_with_index</code> en <code>String</code></li>
<li>Pero s&#xED; existe <code>each_char</code> que es como <code>each</code> de <code>Array</code> pero sobre cada
caracter del string

<ul>
<li>Si no enviamos un bloque, retornar&#xE1; un <code>Enumerator</code></li>
</ul></li>
<li>La interfaz <code>Enumerable</code> define el m&#xE9;todo <code>each_with_index</code></li>
</ul>

<h2>El c&#xF3;digo quedar&#xED;a</h2>

<pre class="sh_ruby"><code>result = []
"cat".each_char.each_with_index do |item, index| 
        result &lt;&lt; [item, index] 
end
# Incluso Matz nos simplifico mas...
result = []
"cat".each_char.with_index do |item, index| 
        result &lt;&lt; [item, index] 
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/41">
<h1><code>Enumerator</code> como generadores</h1>

<ul>
<li>Podemos crear objetos enumerator expl&#xED;citamente en vez de hacerlo a partir de
una colecci&#xF3;n</li>
<li>Para ello es necesario utilizar un bloque en la creaci&#xF3;n

<ul>
<li>El c&#xF3;digo del bloque se usar&#xE1; por el objeto Enumerator cada vez que el
programa principal le solicite un nuevo valor</li>
<li>Este bloque no se ejecutar&#xE1; como otros bloques dado que su ejecuci&#xF3;n
se disparar&#xE1; cada vez que se solicita el siguiente valor</li>
<li>La ejecuci&#xF3;n del bloque se pausa y vuelve al programa principal cuando se
encuentra <code>yield</code></li>
<li>Cuando se solicita el siguiente valor, el c&#xF3;digo del bloque contin&#xFA;a a
partir de la l&#xED;nea siguiente al <code>yield</code></li>
</ul></li>
<li>Esto permite generar <strong>secuencias infinitas</strong> </li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/42">
<h1><code>Enumerator</code> como generadores</h1>

<pre class="sh_ruby"><code>fibonacci = Enumerator.new do |caller|
    i1, i2 = 1, 1
    loop do
        caller.yield i1
        i1, i2 = i2, i1+i2
    end
end

6.times { puts fibonacci.next }</code></pre>

<h2>Como <code>Enumerator</code> es <code>Enumerable</code></h2>

<pre class="sh_ruby"><code>fibonacci.first(1000).last</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/43">
<h1>Hay que tener cuidado!!</h1>

<ul>
<li>Cuidado con los enumerators que generan listas infinitas</li>
<li>Los metodos comunes de los enumeradores como <code>count</code> y <code>select</code> tratar&#xE1;n de
leer todos los elementos antes de retornar un valor

<ul>
<li>Podemos escribir la versi&#xF3;n de <code>select</code> adecuada a nuestra lista
infinita</li>
</ul></li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>def infinite_select(enum, &amp;block)
    Enumerator.new do |caller|
        enum.each do |value|
            caller.yield(value) if block.call(value)
        end
    end
end

p infinite_select(fibonacci) {|val| val % 2 == 0}.first(5)</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/44">
<h1>Haciendo algo m&#xE1;s conveniente</h1>

<ul>
<li>Podemos escribir filtros como <code>infinite_select</code> directamente en la clase
<code>Enumerator</code></li>
<li>Esto nos permitir&#xE1; encadenar filtros:</li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>class Enumerator
    def infinite_select(&amp;block)
        Enumerator.new do |caller|
            self.each do |value|
                caller.yield(value) if block.call(value)
            end
        end
    end
end

p fibonacci.
    infinite_select {|val| val % 2 == 0}.
    infinite_select {|val| val.to_s =~ /13\d$/ }.
    first(2)</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/45">
<h1>Bloques como transacciones</h1>

<ul>
<li>Podemos usar bloques para definir c&#xF3;digo que debe ejecutarse bajo ciertas
condiciones transaccionales.</li>
<li>Por ejemplo:

<ul>
<li>Abrir un archivo</li>
<li>Procesarlo</li>
<li>Cerrarlo</li>
</ul></li>
<li>Si bien esto podemos hacerlo secuencialmente, utilizando bloques simplificamos
mucho </li>
</ul>

<h2>Ejemplo b&#xE1;sico</h2>

<pre class="sh_ruby"><code>class File
    def self.open_and_process(*args)
        f = File.open(*args)
        yield f
        f.close()
    end
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/46">
<h1>Analizamos un poco...</h1>

<ul>
<li>El m&#xE9;todo de clase implementado fue desarrollado para que entienda los mismos
par&#xE1;metros que <code>File.open</code> </li>
<li>Para ello, lo que hicimos es pasar los par&#xE1;metros tal cual se enviaron a
<code>File.open</code>

<ul>
<li>Esto se logra definiendo como argumento al m&#xE9;todo <code>*args</code> que significa:
<em>tomar todos los argumentos enviados al m&#xE9;todo actual y colocarlos en un
arreglo llamado args</em></li>
<li>Luego llamamos a <code>File.open(*args)</code>. Utilizar *args vuelve a expandir los
elementos del arreglo a par&#xE1;metros individuales</li>
</ul></li>
<li>Esta t&#xE9;cnica es tan &#xFA;til, que <code>File.open</code> ya lo implementa

<ul>
<li>Adem&#xE1;s de usar <code>File.open</code> para abrir un archivo, podemos usarlo para
directamente procesarlo como lo hac&#xED;amos con <code>open_and_process</code></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/47">
<h1>Una versi&#xF3;n m&#xE1;s completa de <code>my_open</code></h1>

<pre class="sh_ruby"><code>class File
    def self.my_open(*args)
        result = file = File.new(*args)
        if block_given?
            result = yield file
            file.close
        end
        return result
    end
end</code></pre>

<ul>
<li>Podr&#xED;a suceder un error en el procesamiento</li>
<li>Para asegurar el cierre del archivo, se deben usar excepciones, que veremos 
m&#xE1;s adelante</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/48">
<h1>Los bloques pueden ser objetos</h1>

<ul>
<li>Recordamos que anteriormente mencionamos que los bloques son como un par&#xE1;metro
adicional pasado a un m&#xE9;todo</li>
<li>Adem&#xE1;s podremos hacer que los bloques sean par&#xE1;metros expl&#xED;citos

<ul>
<li>Si el &#xFA;ltimo par&#xE1;metro en un m&#xE9;todo se prefija con ampersand (como 
&amp;action), Ruby buscar&#xE1; el codigo de un bloque cuando el m&#xE9;todo es invocado</li>
<li>Este par&#xE1;metro podr&#xE1; utilizarse como cualquier otro</li>
</ul></li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>class ProcExample
    def pass_in_block(&amp;action)
        @stored_proc = action
    end
    def use_proc(parameter)
        @stored_proc.call(parameter)
    end
end

eg = ProcExample.new
eg.pass_in_block { |param| puts "The parameter is #{param}" }
eg.use_proc(99)</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/49">
<h1>Avanzando un poco m&#xE1;s...</h1>

<ul>
<li>Vemos que <code>call</code> invoca la ejecuci&#xF3;n del bloque </li>
<li>Muchos programas utilizan esta idea para implementar <strong>callbacks</strong></li>
<li>&#xBF;Qu&#xE9; pasar&#xED;a si retornamos el bloque?</li>
</ul>

<h2>Lo analizamos</h2>

<pre class="sh_ruby"><code>def create_block_object(&amp;block)
    block
end

bo = create_block_object do |param| 
    puts "You called me with #{param}"
end
bo.call 99
bo.call "cat"</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/50">
<h1><code>Proc</code> y <code>lambda</code></h1>

<ul>
<li>Devolver un bloque es tan &#xFA;til que en Ruby hay dos formas de hacerlo:

<ul>
<li><code>lamda</code> y <code>Proc.new</code> toman un bloque y retornan un objeto</li>
<li>El objeto retornado es de la clase <code>Proc</code></li>
<li>La diferencia entre <code>lambda</code> y <code>Proc.new</code> la veremos m&#xE1;s adelante, pero ya
hemos mencionado que <code>lambda</code> controla los par&#xE1;metros que requiere el
bloque, mientras que <code>Proc</code> no lo hace</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/51">
<h1>Los bloques pueden ser Closures</h1>

<ul>
<li>Recordamos haber mencionamos que los bloques pueden utilizar variables que
est&#xE1;n dentro del alcance del bloque</li>
<li>Veremos ahora un uso diferente de un bloque haciendo esto</li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>def n_times(thing)
    lambda {|n| thing * n }
end
p1 = n_times(10)
p1.call(3)
p1.call(4)
p2 = n_times("Hola ")
p2.call(3)</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/52">
<h1>&#xBF;Qu&#xE9; es un Closure?</h1>

<ul>
<li>El m&#xE9;todo <code>n_times</code> referencia el par&#xE1;metro <code>thing</code> que es usado por el bloque</li>
<li>Aunque en las llamadas a <code>call</code> (y por ende en la ejecuci&#xF3;n del bloque) el 
par&#xE1;metro <code>thing</code> est&#xE1; fuera del alcance, el par&#xE1;metro se mantiene accesible
dentro del bloque</li>
<li>Esto es un closure:

<ul>
<li>Variables en el alcance cercano que son referenciadas por el bloque se
mantienen accesibles por la vida del bloque y la vida del objeto Proc creado
para este bloque</li>
</ul></li>
</ul>

<h2>Otro ejemplo</h2>

<pre class="sh_ruby"><code>def what_do_i_do?
    value = 1
    lambda { value += value }
end

let_me_see = what_do_i_do?
let_me_see.call
let_me_see.call</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/53">
<h1>Notaci&#xF3;n alternativa</h1>

<h2>A partir de ruby 1.9</h2>

<pre class="sh_ruby"><code>lambda { |params| ... }

# es equivalente a

-&gt;params { ... }

# Y con par&#xE1;metros

proc1 = -&gt; arg {puts "proc1:#{arg}" }
proc2 = -&gt; arg1, arg2 {puts "proc2:#{arg1} y #{arg2}" }
proc3 = -&gt;(arg1, arg2) {puts "proc3:#{arg1} y #{arg2}" }

proc1.call "ant"
proc2.call "bee", "cat"
proc3.call "dog", "elk"</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/54">
<h1>Locas ideas</h1>

<h2>Reimplementamos un while usando bloques</h2>

<pre class="sh_ruby"><code>def my_while(cond, &amp;body)
    while cond.call
        body.call
    end
end

a = 0
my_while -&gt; { a &lt; 3 } do
    puts a
    a += 1
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="05-clases-objetos-variables/02_contenedores-bloques-iteradores/55">
<h1>Lista de par&#xE1;metros a un bloque</h1>

<ul>
<li>Los argumentos a un bloque, al igual que los argumentos a un m&#xE9;todo podr&#xE1;n ser:

<ul>
<li>Argumentos splat, que se reemplazan por un arreglo como vimos en un ejemplo
previo (usando *)</li>
<li>Inicializados con un valor por defecto</li>
<li>Bloques como par&#xE1;metro (usando &amp; en el &#xFA;ltimo par&#xE1;metro)</li>
</ul></li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>proc1 = lambda do |a, *b, &amp;block|
    puts "a = #{a.inspect}"
    puts "b = #{b.inspect}"
    block.call
end
proc1.call(1, 2, 3, 4) { puts "in block1" }

proc2 = -&gt; a, *b, &amp;block do
    puts "a = #{a.inspect}"
    puts "b = #{b.inspect}"
    block.call
end
proc2.call(1, 2, 3, 4) { puts "in block2" }</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/1">
<h1>Herencia, m&#xF3;dulos y mixins</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/2">
<h1>Introducci&#xF3;n</h1>

<ul>
<li>Uno de los principios aceptados sobre buen dise&#xF1;o es la eliminaci&#xF3;n de
duplicados innecesarios</li>
<li>Trataremos de lograr que cada concepto en nuestra aplicaci&#xF3;n sea expresado s&#xF3;lo
una vez en el c&#xF3;digo</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/3">
<h1>Herencia</h1>

<ul>
<li>Permite crear clases que son un refinamiento o especializaci&#xF3;n de otra clase</li>
<li>A esta clase se la llama <em>subclase</em> de la original</li>
<li>A la clase original se la llama <em>superclase</em> de la subclase</li>
<li>Tambi&#xE9;n se utilizan los t&#xE9;rminos: clase padre y clase hija</li>
<li>El mecanismo de herencia es simple:

<ul>
<li>Los hijos heredan todas las capacidades de la clase padre</li>
<li>Todos los m&#xE9;todos de instancia de la clase padre estar&#xE1;n disponibles en los
hijos</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/4">
<h1>Ejemplo de herencia</h1>

<pre class="sh_ruby"><code>class Parent
    def say_hello
        puts "Hello from #{self}"
    end
end

p = Parent.new
p.say_hello

# Subclass the parent...
class Child &lt; Parent
end

c = Child.new
c.say_hello</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/5">
<h1>Conociendo la herencia</h1>

<h2>El m&#xE9;todo <code>superclass</code> devuelve la clase padre</h2>

<pre class="sh_ruby"><code>puts "The superclass of Child is #{Child.superclass}"
puts "The superclass of Parent is #{Parent.superclass}"
puts "The superclass of Object is #{Object.superclass}"</code></pre>

<ul>
<li>Si no se define superclase, Ruby asume <code>Object</code>

<ul>
<li><code>to_s</code> est&#xE1; definido aqu&#xED;</li>
</ul></li>
<li><code>BasicObject</code> es utilizado en metaprogramaci&#xF3;n. 

<ul>
<li>Su padre es <code>nil</code></li>
<li>Es la ra&#xED;z: todas las clases lo tendran como ancestro </li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/6">
<h1>Veamos un ejemplo completo</h1>

<ul>
<li><code>GServer</code> es un servidor TCP/IP gen&#xE9;rico</li>
<li>Agregaremos funcionalidad b&#xE1;sica a nuestro servicio subclaseando GServer

<ul>
<li>El servicio mostrar&#xE1; las &#xFA;ltimas lineas del archivo de logs del sistema:
<code>/var/log/syslog</code></li>
</ul></li>
<li>GServer manipula todo lo relacionado a sockets TCP. 

<ul>
<li>Nosotros s&#xF3;lo indicaremos el puerto en la inicializaci&#xF3;n</li>
<li>Cuando un cliente se conecte, el objeto GServer invocar&#xE1; al m&#xE9;todo <code>serve</code></li>
<li>GServer no hace nada en el m&#xE9;todo que implementa <code>serve</code></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content small" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/7">
<h1>LogServer</h1>

<pre class="sh_ruby"><code>require 'gserver'
class LogServer &lt; GServer
    def initialize
        super(12345)
    end
    def serve(client)
        client.puts get_end_of_log_file
    end
    private
        def get_end_of_log_file
            File.open("/var/log/syslog") do |log|
                # back up 1000 characters from end
                log.seek(-1000, IO::SEEK_END)
                # ignore partial line
                log.gets
                # and return rest
                log.read
            end
        end
end

server = LogServer.new
server.start.join</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/8">
<h1>&#xBF;C&#xF3;mo hemos usado la herencia?</h1>

<ul>
<li><code>LogServer</code> hereda de <code>GServer</code></li>
<li>Esto indica que: 

<ul>
<li>LogServer es un GServer, compartiendo toda su funcionalidad</li>
<li>LogServer es una especializaci&#xF3;n</li>
</ul></li>
<li>La primer especializaci&#xF3;n es con <code>initialize</code>

<ul>
<li>Se fuerza el puerto a 12345</li>
<li>El puerto es un par&#xE1;metro del constructor de GServer</li>
<li>Para invocar el m&#xE9;todo constructor del padre, utilizamos <code>super</code></li>
<li>Cando se invoca <code>super</code>, Ruby env&#xED;a el m&#xE9;todo a la clase padre del objeto
actual, indicando que invoque el mismo m&#xE9;todo que se est&#xE1; ejecutando en el
hijo. Se enviar&#xE1;n los par&#xE1;metros que fueron pasados a <code>super</code></li>
</ul></li>
<li>La implementaci&#xF3;n de <code>serve</code> es algo com&#xFA;n en OO

<ul>
<li>El padre asume que ser&#xE1; subclaseado invocando un m&#xE9;todo que asume ser&#xE1;
implementado por sus hijos</li>
<li>Esto permite a la clase padre implementar lo m&#xE1;s pesado del procesamiento y
delegar a los hijos mediante callbacks funcionalidad extra</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets incremental" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/9">
<h1>&#xBF;C&#xF3;mo hemos usado la herencia?</h1>

<ul>
<li><p>Veremos m&#xE1;s adelante que esta pr&#xE1;ctica <strong><em>muy com&#xFA;n en OO</em></strong> no la convierte en <strong><em>un buen dise&#xF1;o</em></strong></p></li>
<li><p>En su lugar veremos <strong><em>mixins</em></strong></p></li>
<li><p>Pero para explicar mixins, antes tenemos que explicar <strong><em>m&#xF3;dulos</em></strong></p></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/10">
<h1>Modulos</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/11">
<h1>Modulos</h1>

<ul>
<li>Los m&#xF3;dulos son una forma de agrupar m&#xE9;todos, clases y constantes. </li>
<li>Proveen dos beneficios:

<ul>
<li>Proveen <strong>namespaces</strong> y previenen el solapamiento de nombres</li>
<li>Son la clave de los <strong>mixins</strong></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/12">
<h1>Namespaces</h1>

<ul>
<li>A medida que los programas crecen, surge c&#xF3;digo reusables</li>
<li>Es as&#xED; como aparecen las librer&#xED;as</li>
<li>Deseamos agrupar en archivos diferentes estas rutinas de forma tal
de poder reusarlas en programas distintos</li>
<li>Generalmente estas rutinas pertenecer&#xE1;n a una clase, o grupos de clases
interrelacionadas, que podr&#xED;amos disponer en un &#xFA;nico archivo

<ul>
<li>Sin embargo, a veces queremos agrupar cosas que no necesariamente forman una
clase</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/13">
<h1>Namespaces</h1>

<ul>
<li>Como una primer idea, podr&#xED;amos pensar en disponer todos los archivos que
componen nuestra librer&#xED;a y luego cargar el archivo en nuestro programa cuando
lo necesite</li>
<li>Esta idea tiene un problema si definimos funciones con nombres que son iguales 
a los de otra librer&#xED;a</li>
</ul>

<h2>La soluci&#xF3;n</h2>

<pre class="sh_ruby"><code>module Trig
    PI = 3.141592654
    def Trig.sin(x)
    # ..
    end
    def Trig.cos(x)
    # ..
    end
end
module Moral
    VERY_BAD = 0
    BAD = 1
    def Moral.sin(badness)
    # ...
    end
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/14">
<h1>&#xBF;Como se usa?</h1>

<pre class="sh_ruby"><code>y = Trig.sin(Trig::PI/4)
wrongdoing = Moral.sin(Moral::VERY_BAD)</code></pre>

<ul>
<li>As&#xED; como en los m&#xE9;todos de clase, se invocan los m&#xE9;todos de un m&#xF3;dulo
precedi&#xE9;ndolos con el nombre del m&#xF3;dulo y un punto</li>
<li>Las constantes se referencian con el nombre del m&#xF3;dulo y doble dos puntos (::)</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/15">
<h1>Mixins</h1>

<ul>
<li>En el ejemplo reciente, definimos m&#xE9;todos del m&#xF3;dulo que prefij&#xE1;bamos con el
nombre del m&#xF3;dulo: <code>Trig.cos</code></li>
<li>La primer asociaci&#xF3;n es que los m&#xE9;todos de un m&#xF3;dulo son como m&#xE9;todos de clase</li>
<li>La siguiente pregunta ser&#xED;a: <em>Si los m&#xE9;todos del m&#xF3;dulo son como m&#xE9;todos de
clase, qu&#xE9; ser&#xED;an los m&#xE9;todos de instancia de un m&#xF3;dulo?</em>

<ul>
<li>Un m&#xF3;dulo <strong>no puede tener instancias</strong> porque no es una clase</li>
<li>Podremos <strong>incluir</strong> un m&#xF3;dulo a una definici&#xF3;n de clase</li>
<li>Cuando esto sucede, los m&#xE9;todos de instancia definidos en el m&#xF3;dulo son
incluidos como m&#xE9;todos de instancia de la clase. Se <strong>mezclan</strong> (mixed in)</li>
<li>En efecto, los m&#xF3;dulos mixed in se comportan como superclases</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/16">
<h1>Ejemplo</h1>

<pre class="sh_ruby"><code>module Debug
    def who_am_i?
        "#{self.class.name}(\##{self.object_id}):#{self.to_s}"
    end
end

class Phonograph
    include Debug
    def initialize(n); @n=n; end
    def to_s; @n; end
end

class EightTrack
    include Debug
    def initialize(n); @n=n; end
    def to_s; @n; end
end

ph = Phonograph.new("West End Blues")
et = EightTrack.new("Surrealistic Pillow")
ph.who_am_i?
et.who_am_i?</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/17">
<h1>El uso de <code>include</code></h1>

<ul>
<li>El <code>include</code> en Ruby agrega una referencia al m&#xF3;dulo que agregar&#xE1; nuevos
m&#xE9;todos a nuestra clase</li>
<li>Si varias clases incluyen el mismo m&#xF3;dulo, todas tendran referencias al mismo</li>
<li>Si modificamos el m&#xF3;dulo durante la ejecuci&#xF3;n del programa, todas las clases
que inclu&#xED;an el m&#xF3;dulo tomar&#xE1;n los cambios autom&#xE1;ticamente</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/18">
<h1>El potencial</h1>

<ul>
<li>El potencial real de los mixins se obtiene cuando el c&#xF3;digo de un mixin
interact&#xFA;a con c&#xF3;digo de una clase que lo utiliza</li>
<li>Analizamos el caso de un mixin que es parte de la librer&#xED;a est&#xE1;ndar de Ruby,
<code>Comparable</code> 

<ul>
<li>Agrega los operadores de comparaci&#xF3;n: <code>&lt;</code>, <code>&lt;=</code>, <code>==</code>, <code>&gt;=</code>, <code>&gt;</code></li>
<li>Agrega el m&#xE9;todo <code>between?</code></li>
<li>Asume que la clase que utilice este mixin, implementar&#xE1; el m&#xE9;todo <code>&lt;=&gt;</code></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/19">
<h1>Lo probamos con la clase <code>Person</code></h1>

<pre class="sh_ruby"><code>class Person
    include Comparable
    attr_reader :name
    def initialize(name)
        @name = name
    end
    def to_s
        "#{@name}"
    end
    def &lt;=&gt;(other)
        self.name &lt;=&gt; other.name
    end
end
p1 = Person.new("Matz")
p2 = Person.new("Guido")
p3 = Person.new("Larry")
[p1, p2, p3].sort</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/20">
<h1>Iteradores y el m&#xF3;dulo <code>Enumerable</code></h1>

<ul>
<li>Si queremos que nuestra clase entienda los iteradores <code>each</code>, <code>include?</code>,
<code>find_all?</code>

<ul>
<li>Incluimos el m&#xF3;dulo <code>Enumerable</code></li>
<li>Implementamos el iterador <code>each</code></li>
</ul></li>
<li>Si adem&#xE1;s los elementos de nuestra colecci&#xF3;n implementan <code>&lt;=&gt;</code> entonces
  dispondremos de: 

<ul>
<li><code>min</code></li>
<li><code>max</code> </li>
<li><code>sort</code> </li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/21">
<h1>Composici&#xF3;n de m&#xF3;dulos</h1>

<h2>Creamos nuestra clase Enumerable</h2>

<pre class="sh_ruby"><code>class VowelFinder
    include Enumerable
    def initialize(string)
        @string = string
    end
    def each
        @string.scan(/[aeiou]/i) do |vowel|
            yield vowel
        end
    end
end
vf = VowelFinder.new "El murcielago tiene todas"
vf.inject(:+)</code></pre>

<h2>Lo mismo hacemos con otras colecciones</h2>

<pre class="sh_ruby"><code>[ 1, 2, 3, 4, 5 ].inject(:+)
( 'a'..'m').inject(:+)</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/22">
<h1>Creamos el m&#xF3;dulo <code>Summable</code></h1>

<pre class="sh_ruby"><code>module Summable
    def sum
        inject(:+)
    end
end</code></pre>

<h2>Lo aplicamos a las clases del ejemplo</h2>

<pre class="sh_ruby"><code>class Array; include Summable; end
class Range; include Summable; end
class VowelFinder; include Summable; end

[ 1, 2, 3, 4, 5 ].sum
('a'..'m').sum
vf.sum</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/23">
<h1>Variables de instancia en mixins</h1>

<ul>
<li>En ruby las variables de instancia se crean cuando se nombran por
primera vez </li>
<li>Esto significa que un Mixin podr&#xE1; crear variables de instancia si las nombra
por primera vez en la clase</li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>module Observable
    def observers
        @observer_list ||= []
    end
    def add_observer(obj)
        observers &lt;&lt; obj
    end
    def notify_observers
        observers.each {|o| o.update }
    end
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/24">
<h1>Variables de instancia en mixins</h1>

<ul>
<li>Sin embargo, este uso es <strong>riesgoso</strong></li>
<li>Los nombres de las variables pueden colisionar con otro nombre de la clase u
otros m&#xF3;dulos.</li>
<li>Un programa que caiga en este escenario dar&#xE1; resultados err&#xF3;neos y
dif&#xED;ciles de rasterar</li>
</ul>

<h2>Soluci&#xF3;n</h2>

<ul>
<li>La mayor&#xED;a de las veces, los modulos Mixins no usan variables de instancia,
sino accessors</li>
<li>En caso de necesitarlo, utilizar nombres que se prefijen con el nombre del
m&#xF3;dulo por ejemplo</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/25">
<h1>Resoluci&#xF3;n de nombres ambiguos de m&#xE9;todos</h1>

<ul>
<li><em>&#xBF;C&#xF3;mo se resuelve el nombre de un m&#xE9;todo que es el mismo en la clase, que 
es implementado en la superclase y adem&#xE1;s definido en uno o varios m&#xF3;dulos 
incluidos?</em>

<ul>
<li>Primero se busca si la clase del objeto lo implementa</li>
<li>Luego en los mixins incluidos por la clase. <em>Si tiene varios m&#xF3;dulos, el
&#xFA;ltimo ser&#xE1; el considerado</em></li>
<li>Luego en la superclase</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content small" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/26">
<h1>Caso 1</h1>

<pre class="sh_ruby"><code>module MyModule
    def test
        "Module"
    end
end

class Parent
    def test
        "Parent"
    end
end

class Child &lt; Parent
    include MyModule
    def test
        "Child"
    end
end

t = Child.new
p t.test</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content small" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/27">
<h1>Caso 2</h1>

<pre class="sh_ruby"><code>module MyModule
    def test
        "Module"
    end
end

class Parent
    def test
        "Parent"
    end
end

class Child &lt; Parent
    include MyModule
end

t = Child.new
p t.test</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content small" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/28">
<h1>Caso 3</h1>

<pre class="sh_ruby"><code>module MyModule
    def test1
        "Module"
    end
end

class Parent
    def test
        "Parent"
    end
end

class Child &lt; Parent
    include MyModule
end

t = Child.new
p t.test</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/29">
<h1>Herencia, Mixins y Dise&#xF1;o</h1>

<ul>
<li>Herencia y Mixins ambos permiten escribir c&#xF3;digo en un &#xFA;nico lugar</li>
<li><em>&#xBF;Cu&#xE1;ndo usar cada uno?</em>

<ul>
<li>El uso de herencia debe aplicarse cuando se cumple la propiedade <strong>es un</strong></li>
<li>La herencia puede asociarse con la creaci&#xF3;n de clases, que ser&#xED;a como 
agregar nuevos tipos al lenguaje</li>
<li>Al usar herencia <strong>deber&#xED;amos en todo momento poder reemplazar por un objeto
de la subclase</strong> donde se usaba un objeto de la superclase. <em>Los hijos deben
hacer honor a los contratos asumidos por el padre</em></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="05-clases-objetos-variables/03_herencia-modulos-mixins/30">
<h1>Herencia, Mixins y Dise&#xF1;o</h1>

<ul>
<li>La realidad dice que el uso de herencia no siempre se usa para representar la
relaci&#xF3;n <em>es un</em>

<ul>
<li>En realidad muchas veces se utiliza <strong>mal</strong> en situaciones que representan 
una relaci&#xF3;n de <em>posee un</em> o <em>utiliza un</em></li>
<li>El mundo se crea a partir de <strong>composiciones</strong> m&#xE1;s que de restricciones de
herencia estrictas</li>
</ul></li>
<li>Dado que la herencia era el &#xFA;nico mecanismo disponible para compartir c&#xF3;digo,
nos volvimos <strong>vagos</strong> y empezamos a afirmar cosas como: <em>Que una Persona</em> <strong><em>es un</em></strong> <em>DatabaseWrapper</em>

<ul>
<li>Pero una persona no es un DatabaseWrapper</li>
<li>Una Persona <strong>usa</strong> un DatabaseWrapper para proveer persistencia</li>
</ul></li>
<li>La herencia adem&#xE1;s representa un gran acomplamiento entre dos componentes.
Cambiar la herencia ser&#xED;a algo complejo en cualquier programa mediano</li>
<li><strong>Debemos utilizar composici&#xF3;n cada vez que encontramos una relaci&#xF3;n:</strong> A
<em>usa</em> B o A <em>tiene un</em> B

<ul>
<li>Nuestra persona no ser&#xED;a un DatabseWrapper, incluir&#xED;a la funcionalidad para
persistir y recuperar una persona</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="06-tipos-estandar/01_tipos-estandar/1">
<h1>Tipos est&#xE1;ndar</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="06-tipos-estandar/01_tipos-estandar/2">
<h1>N&#xFA;meros</h1>

<ul>
<li>Los n&#xFA;meros que soporta Ruby son: 

<ul>
<li>Enteros</li>
<li>Punto flotante</li>
<li>Racionales</li>
<li>Complejos</li>
</ul></li>
<li>Los enteros se manejan internamente por Ruby como binarios.

<ul>
<li>Se representan con Fixnum en el rango de (-2^30..2^30-1 o -2^62..2^62-1)</li>
<li>Fuera del rango anterior, Ruby utiliza Bignum</li>
<li>El proceso es transparente </li>
</ul></li>
<li>Es importante considerar que los strings no se convierten autom&#xE1;ticamente a
enteros: <code>'1' + '2' =&gt; '12'</code></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="06-tipos-estandar/01_tipos-estandar/3">
<h1>&#xBF;C&#xF3;mo interact&#xFA;an?</h1>

<pre class="sh_ruby"><code>1 + 2               # =&gt; 3
1 + 2.0             # =&gt; 3.0
1.0 + 2             # =&gt; 3.0
1.0 + Complex(1,2)  # =&gt; (2.0,2i)
1 + Rational(2,3)   # =&gt; (5/3)
1.0 + Rational(2,3) # =&gt; 1.66666666666665

# Y cuando se divide:

1.0/2               # =&gt; 0.5
1/2.0               # =&gt; 0.5
1/2                 # =&gt; 0</code></pre>

<p>Probar la divisi&#xF3;n requiriendo <code>mathn</code></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="06-tipos-estandar/01_tipos-estandar/4">
<h1>Strings y el encoding</h1>

<ul>
<li>A partir de ruby 1.9, cada string tiene asociada una codificaci&#xF3;n</li>
<li>Por defecto, la codificaci&#xF3;n asociada a un literal string depender&#xE1; de la 
codificaci&#xF3;n del archivo fuente donde se especific&#xF3;

<ul>
<li>Sin especificar la codificaci&#xF3;n de un fuente ruby, se asume: <code>US-ASCII</code> en
1.9 y <code>UTF-8</code> a partir de ruby 2</li>
<li>Cambiamos la codificaci&#xF3;n de un fuente agregando en la primer l&#xED;nea un
comentario <code>#encoding: xxxx</code> donde xxx corresponde a la codificaci&#xF3;n</li>
</ul></li>
</ul>

<h2>Un ejemplo</h2>

<pre class="sh_ruby"><code>#encoding: iso-8859-1
txt = "dog"
puts "Encoding of #{txt.inspect} is #{txt.encoding}"</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="06-tipos-estandar/01_tipos-estandar/5">
<h1>Usando rangos como condiciones</h1>

<ul>
<li>Generalmente usamos rangos como secuencias y dependiendo del tipo del rango
pod&#xED;amos pedir: <code>min</code>, <code>max</code>, <code>include</code>, etc</li>
<li>Ahora veremos una forma de utilizar los rangos como condiciones, de forma tal
que el objeto rango mantendr&#xE1; el estado de las comparaciones que macheen desde
un valor (el inicial del rango) hasta el final (del rango)</li>
</ul>

<h2>Dos ejemplos</h2>

<pre class="sh_ruby"><code>100.times {|x| p x if x==50 .. x==55 }

while line = gets
    puts line if line =~ /start/ .. line =~ /end/
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="06-tipos-estandar/01_tipos-estandar/6">
<h1>Usando rangos como intervalos</h1>

<pre class="sh_ruby"><code>car_age = gets.to_f # let's assume it's 5.2
case car_age
    when 0...1
        puts "Mmm.. new car smell"
    when 1...3
        puts "Nice and new"
    when 3...6
        puts "Reliable but slightly dinged"
    when 6...10
        puts "Can be a struggle"
    when 10...30
        puts "Clunker"
    else
        puts "Vintage gem"
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="06-tipos-estandar/01_tipos-estandar/7">
<h1>Busncado el problema...</h1>

<pre class="sh_ruby"><code>car_age = gets.to_f # let's assume it's 5.2
case car_age
    when 0..0
        puts "Mmm.. new car smell"
    when 1..2
        puts "Nice and new"
    when 3..5
        puts "Reliable but slightly dinged"
    when 6..9
        puts "Can be a struggle"
    when 10..29
        puts "Clunker"
    else
        puts "Vintage gem"
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="07-metodos/01_metodos/1">
<h1>Un poco m&#xE1;s sobre m&#xE9;todos</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="07-metodos/01_metodos/2">
<h1>Definiendo un m&#xE9;todo</h1>

<ul>
<li>Los nombres de los m&#xE9;todos deben empezar con min&#xFA;scula o underescore

<ul>
<li><em>No es error que el nombre comience con may&#xFA;sucla, el problema es que en la
invocaci&#xF3;n, Ruby tratar&#xE1; de interpretarlo como una constante, y por tanto
parsear la llamada en forma incorrecta. Por convenci&#xF3;n, los m&#xE9;todos que
comienzan con may&#xFA;scula se utilizan para conversiones de tipos</em></li>
</ul></li>
<li>Cuando retornamos un boolean, es prolijo que el m&#xE9;todo termine con <code>?</code></li>
<li>Aquellos m&#xE9;todos <em>peligrosos</em> deben terminar con <code>!</code></li>
<li>Los m&#xE9;todos que aparecen a la izquierda de una asignaci&#xF3;n terminan con <code>=</code></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="07-metodos/01_metodos/3">
<h1>Argumentos</h1>

<ul>
<li>Los par&#xE1;mtros a un m&#xE9;todo se escriben como una lista de variables entre
par&#xE9;ntesis

<ul>
<li><em>Los par&#xE9;ntesis pueden omitirse; por convensi&#xF3;n se usar&#xE1;n par&#xE9;ntesis cuando
el m&#xE9;todo tenga argumentos, y omitirlos cuando no</em></li>
</ul></li>
<li>Es posible definir valores por defecto para los argumentos

<ul>
<li><em>Incluso usando como valor un par&#xE1;metro anterior</em></li>
</ul></li>
</ul>

<h2>Ejemplos</h2>

<pre class="sh_ruby"><code>def concat(a="a", b="b")
    "#{a},#{b}"
end

def surround(word, pad_width=word.length/2)
"[" * pad_width + word + "]" * pad_width
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="07-metodos/01_metodos/4">
<h1>Argumentos variables</h1>

<ul>
<li>Usando un <code>*</code> antes del nombre del argumento, luego de los par&#xE1;metros normales logramos este efecto

<ul>
<li>A partir de Ruby 1.9, es posible definir el argumento variable en cualquier
posici&#xF3;n. Lo importante es no tener m&#xE1;s de uno</li>
</ul></li>
<li>A esta t&#xE9;cnica se la suele llamar: <em>splatting an argument</em> </li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>def varargs(arg1, *rest)
    "arg1=#{arg1}. rest=#{rest.inspect}"
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="07-metodos/01_metodos/5">
<h1>Usos de splat</h1>

<ul>
<li>Es com&#xFA;n que se utilice splat en una subclase para pasar los par&#xE1;metros a la
superclase usando <code>super</code>

<ul>
<li>Si no se especifican par&#xE1;metros a <code>super</code>, entonces se invoca el m&#xE9;todo del
padre con todos los argumentos que se hayan recibido</li>
</ul></li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>class Child &lt; Parent
    def do_something(*not_used)
        # our processing
        super
    end
end</code></pre>

<h2>O en forma similar</h2>

<pre class="sh_ruby"><code>class Child &lt; Parent
    def do_something(*)
        # our processing
        super
    end
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="07-metodos/01_metodos/6">
<h1>Retornando valores</h1>

<ul>
<li>Los m&#xE9;todos siempre retornan un valor aunque el mismo no sea utilizado</li>
<li>Podemos usar <code>return</code> para forzar la salida

<ul>
<li>Si se env&#xED;an varios par&#xE1;metros a <code>return</code> se retorna un arreglo</li>
<li>El caso anterior se puede usar en asignaciones en paralelo</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="07-metodos/01_metodos/7">
<h1>Expandiendo collecciones en llamadas a m&#xE9;todos</h1>

<ul>
<li>Es la idea inversa a la explicaci&#xF3;n de splat previa</li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>def five(a, b, c, d, e)
    "I was passed #{a} #{b} #{c} #{d} #{e}"
end

five(1, 2, 3, 4, 5 )
five(1, 2, 3, *['a', 'b'])
five(*['a', 'b'], 1, 2, 3)
five(*(10..14))
five(*[1,2], 3, *(4..5))</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="07-metodos/01_metodos/8">
<h1>Haciendo m&#xE1;s din&#xE1;micos los bloques</h1>

<ul>
<li>Al igual que en el caso anterior de splat, podemos necesitar especificar que
uno de los par&#xE1;metros a un m&#xE9;todo es un bloque</li>
</ul>

<h2>En vez de</h2>

<pre class="sh_ruby"><code>(1..10).collect { |x| x*2}.join(',')</code></pre>

<h2>Podemos usar</h2>

<pre class="sh_ruby"><code>b = -&gt; x { x*2}
(1..10).collect(&amp;b).join ','</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="07-metodos/01_metodos/9">
<h1>Argumentos como Hash</h1>

<ul>
<li>Hasta Ruby 1.9 no exist&#xED;a la posibilidad de usar <em>keyword arguments</em> 

<ul>
<li>En vez de especificar los par&#xE1;metros en el orden en que se definieron, es posible
especificar qu&#xE9; valor tomar&#xE1; cada par&#xE1;metro indicando el hecho con el nombre
del argumento y su valor</li>
</ul></li>
<li>Hasta que Ruby 1.9 se utilizaba Hash en su reemplazo para obtener el mismo
resultado</li>
</ul>

<h2>Ejemplo con Hash</h2>

<pre class="sh_ruby"><code>class SongList
    def search(name, params)
    # ...
    end
end
list.search(:titles,
            { :genre              =&gt; "jazz",
              :duration_less_than =&gt; 270
            })</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="07-metodos/01_metodos/10">
<h1>Argumentos como Hash</h1>

<ul>
<li>En el ejemplo anterior el primer par&#xE1;metro indica qu&#xE9; atributo retornar
mientras que el segundo es un hash con el criterio de b&#xFA;squeda</li>
<li>Lo inc&#xF3;modo del ejemplo es la necesidad de usar <code>{}</code>, adem&#xE1;s de la posible
confusi&#xF3;n con la posibilidad de que se est&#xE9; indicando un bloque</li>
<li>Ruby ofrece una soluci&#xF3;n: puede usarse <code>clave =&gt; valor</code> en la lista de
argumentos siempre que:

<ul>
<li>Sea luego de los argumentos <em>normales</em></li>
<li>Antes de un splat y bloque</li>
<li>Ya no es necesario usar llaves</li>
</ul></li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code># Ruby &lt;= 1.9
list.search(:titles,
            :genre              =&gt; 'jazz',
            :duration_less_than =&gt; 270)

# Ruby &gt;= 1.9
list.search(:titles, genre: 'jazz', duration_less_than: 270)</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content small" ref="07-metodos/01_metodos/11">
<h1>Keyword arguments: solo Ruby 2.0</h1>

<h2>Asumimos un supuesto m&#xE9;todo <code>log</code></h2>

<pre class="sh_ruby"><code>def log(msg, level: "ERROR", time: Time.now)
    puts "#{ time.ctime } [#{ level }] #{ msg }"
end</code></pre>

<h2>En Ruby 1.9 ten&#xED;amos que:</h2>

<pre class="sh_ruby"><code>def log(msg, opt = {})
    level = opt[:level] || "ERROR"
    time  = opt[:time]  || Time.now
    puts "#{ time.ctime } [#{ level }] #{ msg }"
end
log("Hello!", level: "INFO")</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="07-metodos/01_metodos/12">
<h1>Keyword arguments: solo Ruby 2.0</h1>

<ul>
<li>Las cosas parecen simples, pero todo se complica un poco si sucede:

<ul>
<li>Queremos usar keyword arguments con splat</li>
<li>Lanzar excepciones cuando un argumento no es conocido</li>
</ul></li>
</ul>

<h2>Caer&#xED;amos en:</h2>

<pre class="sh_ruby"><code>def log(*msgs)
    opt = msgs.last.is_a?(Hash) ? msgs.pop : {}
    level = opt.key?(:level) ? opt.delete(:level) : "ERROR"
    time  = opt.key?(:time ) ? opt.delete(:time ) : Time.now
    raise "unknown keyword: #{ opt.keys.first }" if !opt.empty?
    msgs.each {|msg| puts "#{ time.ctime } [#{ level }] #{ msg }" }
end</code></pre>

<p><em>Pero nos gust&#xF3; preservar la primer versi&#xF3;n del ejemplo</em></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="07-metodos/01_metodos/13">
<h1>Keyword arguments: solo Ruby 2.0</h1>

<h2>Probamos los argumentos</h2>

<pre class="sh_ruby"><code>log("Hello")
log("Hello!", level: "ERROR", time: Time.now)</code></pre>

<h2>Y si cambiamos el orden</h2>

<pre class="sh_ruby"><code>log("Hello!", time: Time.now, level: "ERROR") 
log(level: "ERROR", time: Time.now, "Hello!")</code></pre>

<h2>Cuando enviamos un argumento no conocido</h2>

<pre class="sh_ruby"><code>log("Hello!", date: Time.new) </code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="07-metodos/01_metodos/14">
<h1>Keyword arguments: solo Ruby 2.0</h1>

<ul>
<li>Si queremos evitar las excepciones 

<ul>
<li>Podemos usar <code>**</code> para expl&#xED;citamente agrupar el resto de los keyword
arguments en un hash (como splat)</li>
</ul></li>
</ul>

<h2>Veamos como quedar&#xED;a</h2>

<pre class="sh_ruby"><code>def log(msg, level: "ERROR", time: Time.now, **kwrest)
  puts "#{ time.ctime } [#{ level }] #{ msg }"
end

log("Hello!", date: Time.now) </code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="07-metodos/01_metodos/15">
<h1>Keyword arguments: solo Ruby 2.0</h1>

<h2>Todos los casos</h2>

<pre class="sh_ruby"><code>def f(a, b, c, m = 1, n = 1, *rest, x, y, z, k: 1, 
      **kwrest, &amp;blk)
    puts "a: %p" % a
    puts "b: %p" % b
    puts "c: %p" % c
    puts "m: %p" % m
    puts "n: %p" % n
    puts "rest: [%p]" % rest.join(',')
    puts "x: %p" % x
    puts "y: %p" % y
    puts "z: %p" % z
    puts "k: %p" % k
    puts "kwrest: %p" % kwrest
    puts "blk: %p" % blk
end

f("a", "b", "c", 2, 3, "foo", "bar", "baz", "x", 
  "y", "z", k: 42, u: "unknown") { }</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="08-expresiones/01_expresiones/1">
<h1>Expresiones</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="08-expresiones/01_expresiones/2">
<h1>Operadores</h1>

<ul>
<li>Ya hemos usado los operadores +, -, *, /, etc</li>
<li>Estos operadores se implementan como llamadas a m&#xE9;todos</li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>a, b, c = 1, 2, 3
a * b + c
# O en forma similar
(a.*(b)).+(c)</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="08-expresiones/01_expresiones/3">
<h1>Operadores</h1>

<h2>Podemos redefinirlos incluso</h2>

<pre class="sh_ruby"><code>class Fixnum
    alias old_plus +
    def +(other)
        old_plus(other).succ
    end
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="08-expresiones/01_expresiones/4">
<h1>Operadores</h1>

<h2>Otro ejemplo con <code>&lt;&lt;</code></h2>

<pre class="sh_ruby"><code>class ScoreKeeper
    def initialize
        @total_score = 0
        @count = 0
    end

    def &lt;&lt;(score)
        @total_score += score
        @count += 1
        self
    end

    def average
        fail "No scores" if @count == 0
        Float(@total_score) / @count
    end
end

scores = ScoreKeeper.new
scores &lt;&lt; 10 &lt;&lt; 20 &lt;&lt; 40
puts "Average = #{scores.average}"</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="08-expresiones/01_expresiones/5">
<h1>Operadores</h1>

<h2>Incluso con <code>[]</code></h2>

<pre class="sh_ruby"><code>class SomeClass
    def []=(*params)
        value = params.pop
        puts "Indexed with #{params.join(', ')}"
        puts "value = #{value.inspect}"
    end
end

s = SomeClass.new
s[1] = 2
s['cat', 'dog'] = 'enemies'</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="08-expresiones/01_expresiones/6">
<h1>Expresiones de comando</h1>

<ul>
<li>Podemos usar comillas: <strong>`</strong>  &#xF3; <code>%x</code> para indicar la ejecuci&#xF3;n de un comando en el
sistema operativo subyacente</li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>`date`
`ls`.split[34]
%x{echo "Hello there"}
`ip address ls`.
    split("\n").
    select {|x| x =~ / inet / }.
    map do |x|
        x.scan(/((\d{1,3}\.?){4}\/(\d){1,2})/).flatten.shift 
    end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="08-expresiones/01_expresiones/7">
<h1>Expresiones de asignacion</h1>

<h2>Jugando con splat y asignaci&#xF3;n en paralelo</h2>

<pre class="sh_ruby"><code>a, b, c, d, e = *(1..2), 3, *[4, 5] # a=1, b=2, c=3, d=4, e=5

a1, *b1 = 1, 2, 3                   # a1=1, b1=[2, 3]

a2, *b2 = 1                         # a2=1, b2=[]

*a3, b3 = 1, 2, 3, 4                # a3=[1, 2, 3], b3=4

c, *d, e = 1, 2, 3, 4               # c=1, d=[2,3], e=4

f, *g, h, i, j = 1, 2, 3, 4         # f=1, g=[], h=2, i=3, j=4</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="08-expresiones/01_expresiones/8">
<h1>And</h1>

<ul>
<li>El operador <code>&amp;&amp;</code> y el m&#xE9;todo <code>and</code> funcionan similar 

<ul>
<li>Retornan el primer valor si es falso, sino el segundo. Ambos son iguales 
salvo por la precedencia: <code>and</code> es de menor precedencia que <code>&amp;&amp;</code></li>
</ul></li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>nil &amp;&amp; 99    # =&gt; nil
false &amp;&amp; 99  # =&gt; false
"cat" &amp;&amp; 99  # =&gt; 99
a = (true and false)
a = true and false # Check a, Why??</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="08-expresiones/01_expresiones/9">
<h1>Or</h1>

<ul>
<li>El operador <code>||</code> y el m&#xE9;todo <code>or</code> funcionan similar 

<ul>
<li>Retornan el primer valor si es verdadero, sino el segundo. Ambos son iguales 
salvo por la precedencia <code>or</code> es de menor precedencia que <code>||</code></li>
</ul></li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>nil || 99    # =&gt; 99
false || 99  # =&gt; 99
"cat" || 99  # =&gt; "cat"
b = (false or true)
b = false or true # Check b, Why??</code></pre>

<ul>
<li>Es muy com&#xFA;n utilizar la expresi&#xF3;n: <code>||=</code> para setear un valor si no fue
seteado: <code>var ||= "default value"</code></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="08-expresiones/01_expresiones/10">
<h1>Break, Redo y Next</h1>

<ul>
<li>Podemos alterar el flujo de ejecuci&#xF3;n de loops 

<ul>
<li><code>break</code>: termina en forma inmediata al loop en que encuentra m&#xE1;s pr&#xF3;ximo. El
control se devuelve a la sentencia siguiente al final del bloque</li>
<li><code>redo</code>: repite la iteraci&#xF3;n actual sin evaluar la condici&#xF3;n ni trayendo el
siguiente elemento si fuese un iterador</li>
<li><code>next</code>: avanza hasta el final del bloque continuando con la siguiente
iteraci&#xF3;n</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="08-expresiones/01_expresiones/11">
<h1>Ejemplos</h1>

<h2>Break</h2>

<pre class="sh_ruby"><code>a = 0
while a &lt; 20 do
    a +=1
    break if a == 10 
    p a 
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="08-expresiones/01_expresiones/12">
<h1>Ejemplos</h1>

<h2>Redo</h2>

<pre class="sh_ruby"><code>a = 0
while a &lt; 20 do
    a +=1
    redo if a == 10 
    p a 
end

# Y ahora?
a = 0
while a &lt; 20 do
    a +=1
    redo if a == 20 
    p a 
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="08-expresiones/01_expresiones/13">
<h1>Ejemplos</h1>

<h2>Next</h2>

<pre class="sh_ruby"><code>a = 0
while a &lt; 20 do
    a +=1
    next if a == 10 
    p a 
end

# Y ahora?
a = 0
while a &lt; 20 do
    a +=1
    next if a == 20 
    p a 
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="09-excepciones/01_excepciones/1">
<h1>Excepciones, catch y throw</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="09-excepciones/01_excepciones/2">
<h1>Introducci&#xF3;n</h1>

<ul>
<li>Las excepciones permiten empaquetar en un objeto informaci&#xF3;n sobre un error </li>
<li>El objeto <code>Exception</code> se propagar&#xE1; hacia arriba en la pila de ejecuci&#xF3;n hasta
que el sistema detecte c&#xF3;digo que sepa manejar dicha excepci&#xF3;n</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="09-excepciones/01_excepciones/3">
<h1>La clase <code>Exception</code></h1>

<ul>
<li>Ruby define una jerarqu&#xED;a de excepciones que son subclase de <code>Exception</code> </li>
<li>Esta jerarqu&#xED;a simplifica el manejo de excepciones

<ul>
<li>Al lanzar una excepci&#xF3;n, es posible hacerlo con cualquiera de las subclases de
<code>Exception</code> o con una clase propia que sea subclase de <code>StandardError</code> o alguna
de sus hijas. </li>
</ul></li>
<li>Toda excepci&#xF3;n tiene asociado un mensaje y una traza de ejecuci&#xF3;n

<ul>
<li>Si definimos excepciones propias, podemos agregar informaci&#xF3;n espec&#xED;fica</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="09-excepciones/01_excepciones/4">
<h1>Manejo de excepciones</h1>

<h2>Analizamos el siguiente c&#xF3;digo</h2>

<pre class="sh_ruby"><code>require 'open-uri'

web_page = open("http://pragprog.com/podcasts")
output = File.open("podcasts.html", "w")
while line = web_page.gets
    output.puts line
end
output.close</code></pre>

<ul>
<li>&#xBF;Qu&#xE9; sucede si ocurre un error en la mitad de la transferencia?

<ul>
<li>No queremos guardar una p&#xE1;gina por la mitad en el archivo de salida</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content small bullets" ref="09-excepciones/01_excepciones/5">
<h1>Manejo de excepciones</h1>

<h2>Agregamos el manejador de excepci&#xF3;n</h2>

<pre class="sh_ruby"><code>require 'open-uri'

page = "podcasts"
file_name = "#{page}.html"
web_page = open("http://pragprog.com/#{page}")
output = File.open(file_name, "w")
begin
    while line = web_page.gets
        output.puts line
    end
    output.close
rescue Exception
    STDERR.puts "Failed to download #{page}: #{$!}"
    output.close
    File.delete(file_name)
    raise
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="09-excepciones/01_excepciones/6">
<h1>Manejo de excepciones</h1>

<ul>
<li>Cuando sucede una excepci&#xF3;n se ubica una referencia al objeto con la excepci&#xF3;n
asociada en la variable global <code>$!</code></li>
<li>Luego de cerrar y eliminar el archivo, se invoca a <code>raise</code> sin par&#xE1;metros, que
relanza la excepci&#xF3;n en <code>$!</code></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="09-excepciones/01_excepciones/7">
<h1>Jerarqu&#xED;a de <code>Exception</code></h1>

<pre><code>Exception
    StandardError
        ArgumentError
        FiberError (1.9)
        IndexError
            KeyError (1.9)
            StopIteration (1.9)
        IOError
            EOFError
        LocalJumpError
        NameError
            NoMethodError
        RangeError
            FloatDomainError
        RegexpError
        RuntimeError
        SystemCallError
            system-dependent exceptions (Errno::xxx)
        ThreadError
        TypeError
        ZeroDivisionError</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="09-excepciones/01_excepciones/8">
<h1>Jerarqu&#xED;a de <code>Exception</code></h1>

<pre><code>Exception
    fatal
    NoMemoryError
    ScriptError
        LoadError
        NotImplementedError
        SyntaxError
    SecurityError 
    SignalException
        Interrupt
    SystemExit
    SystemStackError</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="09-excepciones/01_excepciones/9">
<h1>M&#xFA;ltiples <code>rescue</code></h1>

<ul>
<li>Es posible utilizar varios <code>rescue</code> para un bloque <code>begin</code></li>
<li>Cada <code>rescue</code> puede incluso indicar varias excepciones a catchear</li>
<li>Al final de cada <code>rescue</code>, podemos indicar el nombre de la variable que
usaremos para mapear la exepci&#xF3;n (en vez de usar <code>$!</code>)</li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>begin
    eval string
rescue SyntaxError, NameError =&gt; boom
    print "String doesn't compile: " + boom
rescue StandardError =&gt; bang
    print "Error running script: " + bang
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="09-excepciones/01_excepciones/10">
<h1>C&#xF3;mo funciona <code>rescue</code></h1>

<ul>
<li>La decisi&#xF3;n de qu&#xE9; <code>rescue</code> utilizar, es similar al caso de un <code>case</code></li>
<li>Para cada <code>rescue</code> compara la excepci&#xF3;n lanzada con cada uno de los par&#xE1;metros
nombrados

<ul>
<li>La comparaci&#xF3;n es: <code>par&#xE1;metro == $!</code></li>
<li>Esto significar&#xED;a que si el tipo de la excepci&#xF3;n lanzada coincide con el del
par&#xE1;metro</li>
</ul></li>
<li>Si se omiten par&#xE1;metros, se compara con <code>StandardError</code></li>
<li>Si no machea con ning&#xFA;n par&#xE1;metro, sale del bloque <code>begin/end</code> buscando en el
m&#xE9;todo que invoc&#xF3; un manejador para la misma, y as&#xED; siguiendo hacia arriba en
la pila</li>
<li>Casi siempre usaremos nombre de clases como par&#xE1;metros a <code>rescue</code>, pero
podemos usar expresiones que retornen una subclase de <code>Exception</code></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content small bullets" ref="09-excepciones/01_excepciones/11">
<h1>Asegurando la ejecuci&#xF3;n</h1>

<ul>
<li>Varias veces necesitamos ejecutar determinado c&#xF3;digo al finalizar un m&#xE9;todo de
forma segura, es decir independientemente de si se produce un error en la
mitad

<ul>
<li>Por ejemplo, tenemos un archivo abierto, que necesitamos sea cerrado antes
de finalizar el bloque</li>
</ul></li>
<li>La cl&#xE1;usula <code>ensure</code> cumple esta funci&#xF3;n</li>
<li>El c&#xF3;digo bajo <code>ensure</code> se ejecutar&#xE1; siempre, haya sido una ejecuci&#xF3;n exitosa
o con alg&#xFA;n problema</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="09-excepciones/01_excepciones/12">
<h1>Un ejemplo <code>ensure</code></h1>

<pre class="sh_ruby"><code>f = File.open("testfile")
begin
    # .. process
rescue
    # .. handle error
ensure
    f.close
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content small bullets" ref="09-excepciones/01_excepciones/13">
<h1>El <code>else</code> de <code>rescue</code></h1>

<ul>
<li>El <code>else</code> aplica cuando ninguno de los <code>rescue</code> manejan la excepci&#xF3;n</li>
<li>Tener cuidado porque <code>ensure</code> ejecutar&#xE1; siempre, incluso cuando no se produce
un error</li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>f = File.open("testfile")
begin
    # .. process
rescue
    # .. handle error
else
    puts "Congratulations-- no errors!"
ensure
    f.close
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="09-excepciones/01_excepciones/14">
<h1>Volver a empezar...</h1>

<ul>
<li>A veces podemos corregir una causa de excepci&#xF3;n</li>
<li>Para estos casos, podemos usar <code>retry</code> para volver a ejecutar el bloque
<code>begin/end</code></li>
<li>Es muy factible caer en loops infinitos </li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="09-excepciones/01_excepciones/15">
<h1>Ejemplo <code>retry</code></h1>

<pre class="sh_ruby"><code>@esmtp = true
begin
# First try an extended login. If it fails 
# because the server doesn't support it, 
# fall back to a normal login
if @esmtp then
    @command.ehlo(helodom)
else
    @command.helo(helodom)
end
rescue ProtocolError
    if @esmtp then
        @esmtp = false
        retry
    else
        raise
    end
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content small smbullets" ref="09-excepciones/01_excepciones/16">
<h1>Lanzando excepciones</h1>

<ul>
<li>Podemos lanzar excepciones usando el m&#xE9;todo <code>Kernel.raise</code></li>
</ul>

<h2>Ejemplos de uso</h2>

<pre class="sh_ruby"><code>raise
raise "bad mp3 encoding"
raise InterfaceException, "Keyboard failure", caller</code></pre>

<ul>
<li>La primer forma relanza una excepci&#xF3;n si la hubiere, o <code>RuntimeError</code> si no.
Generalmente se utiliza dentro de un manejador de excepci&#xF3;n</li>
<li>El segundo ejemplo, lanza <code>RuntimeError</code> con el mensaje indicado</li>
<li>El tercer ejemplo, utiliza el primer par&#xE1;metro para crear un excepci&#xF3;n con el
segundo par&#xE1;metro usado como mensaje y la pila de ejecuci&#xF3;n en el tercer
par&#xE1;metro (<code>Kernel.caller</code> normalmente se utiliza para generar la traza de
ejecuci&#xF3;n)</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content small bullets" ref="09-excepciones/01_excepciones/17">
<h1>Ejemplo de <code>raise</code></h1>

<pre class="sh_ruby"><code>raise
raise "Missing name" if name.nil?
if i &gt;= names.size
    raise IndexError, "#{i} &gt;= size (#{names.size})"
end
raise ArgumentError, "Name too big", caller</code></pre>

<ul>
<li>Generalmente no se incluye la traza en librer&#xED;as</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smaller smbullets" ref="09-excepciones/01_excepciones/18">
<h1><code>catch</code> y <code>throw</code></h1>

<ul>
<li>Veremos un ejemplo que aclarar&#xE1; el concepto

<ul>
<li>El siguiente c&#xF3;digo leer&#xE1; palabras que ir&#xE1; agregando en un arreglo que al
finalizar imprimir&#xE1; en orden inverso. Sin embargo, si alguna l&#xED;nea es
incorrecta deber&#xE1; salir sin hacer nada</li>
<li>El secreto es <code>throw(symbol, variable)</code>. <strong>En este ejemplo es importante que
el &#xFA;ltimo puts retorna <code>nil</code></strong></li>
</ul></li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>word_list = File.open("wordlist")
word_in_error = catch(:done) do
    result = []
    while line = word_list.gets
      word = line.chomp
      throw(:done, word) unless word =~ /^\w+$/
      result &lt;&lt; word
    end
    puts result.reverse
end
if word_in_error
    puts "Failed: '#{word_in_error}' found. Not a word"
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="10-unit-testing/01_unit-testing/1">
<h1>Unit testing</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="10-unit-testing/01_unit-testing/2">
<h1>Introducci&#xF3;n</h1>

<ul>
<li>Unit testing es testing que se focaliza en peque&#xF1;os bloques (o unidades)
de c&#xF3;digo

<ul>
<li>T&#xED;picamente se testean m&#xE9;todos individuales o l&#xED;neas complejas de un m&#xE9;todo</li>
<li>Se contrasta con otras estrategias de testing que ven al sistema como un
todo</li>
</ul></li>
<li>Los sistemas de hoy d&#xED;a se desarrollan en capas donde cada una deber&#xED;a poder
confiar en que la capa de abstracci&#xF3;n utilizada se desempe&#xF1;a correctamente, sin errores.

<ul>
<li>Un error en capas inferiores, causar&#xED;a errores de propagaci&#xF3;n a capas
superiores</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="10-unit-testing/01_unit-testing/3">
<h1>Introducci&#xF3;n</h1>

<h2>Una situaci&#xF3;n</h2>

<p>Juan desarrolla una funcionalidad que tiene alg&#xFA;n error no detectado. Unos dos
meses despu&#xE9;s, desarrollamos determinada funcionalidad que, indirectamente utiliza 
lo que Juan ha desarrollado. </p>

<p>Cuando nuestro c&#xF3;digo no devuelve los resultados
esperados, nos llevar&#xE1; un tiempo encontrar el problema dentro del c&#xF3;digo de 
Juan. Es entonces cuando consultamos con Juan: </p>

<p><strong><em>&#xBF;Por qu&#xE9; encaraste la soluci&#xF3;n as&#xED;?</em></strong> </p>

<p>y la respuesta inmediata ser&#xE1;: </p>

<p><strong>no recuerdo, fue hace varios meses</strong></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="10-unit-testing/01_unit-testing/4">
<h1>Introducci&#xF3;n</h1>

<ul>
<li>Si Juan hubira usado test de unidad para su c&#xF3;digo, dos cosas hubiesen sucedido: 

<ul>
<li>Juan podr&#xED;a haber encontrado el error cuando el c&#xF3;digo a&#xFA;n estaba <em>fresco en
su mente</em></li>
<li>Dado que el test de unidad s&#xF3;lo contempla las l&#xED;neas que Juan escribi&#xF3;,
cuando ocurri&#xF3; el problema, podr&#xED;a haber sido mucho m&#xE1;s r&#xE1;pido analizar el
problema entorno al c&#xF3;digo problem&#xE1;tico en vez de hacer arqueolog&#xED;a en b&#xFA;squeda
del problema en el resto del c&#xF3;digo</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="10-unit-testing/01_unit-testing/5">
<h1>&#xBF;Por qu&#xE9; conviene usar test de unidad?</h1>

<ul>
<li>Ayuda a los desarrolladores a escribir mejor c&#xF3;digo

<ul>
<li>Empezar escribiendo el test de unidad nos lleva a escribir c&#xF3;digo de mayor
calidad y dise&#xF1;os desacoplados</li>
<li>Es muy com&#xFA;n que nos suceda que por no pensar los tests antes de escribir el
c&#xF3;digo, testear el c&#xF3;digo sea un tanto engorroso o dif&#xED;cil de probar por el
alto acoplamiento de entidades</li>
</ul></li>
<li>Ayuda mientras escribimos el c&#xF3;digo, porque nos va dando feedback del
comportamiento del c&#xF3;digo y ante nuevas dudas que van surgiendo sobre posibles
casos extra&#xF1;os, nos permite escribir nuevos tests para agregar a nuestra suite
y as&#xED; quedarnos tranquilos que los casos contemplados en el c&#xF3;digo son testeados</li>
<li>Ayuda luego de haber escrito el c&#xF3;digo por dos razones:

<ul>
<li>Chequeando que el c&#xF3;digo sigue funcionando a medida que el desarrollo crece</li>
<li>Permite a otros desarrolladores entender mejor c&#xF3;mo utilizar nuestro c&#xF3;digo</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="10-unit-testing/01_unit-testing/6">
<h1>La trivialidad</h1>

<ul>
<li>Los tests de unidad son simples: </li>
</ul>

<p><em>consiste en correr un programa que invocan una parte del c&#xF3;digo de nuestra 
aplicaci&#xF3;n, obtiene algunos resultados y verifica que  dichos resultados 
sean los esperados</em></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="10-unit-testing/01_unit-testing/7">
<h1>Un ejemplo</h1>

<ul>
<li>Escribir una clase llamada <code>Roman</code> que permita crear objetos con un valor
num&#xE9;rico y que imprima el valor como un n&#xFA;mero romano</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smaller bullets" ref="10-unit-testing/01_unit-testing/8">
<h1>El programa</h1>

<pre class="sh_ruby"><code>class Roman
    MAX_ROMAN = 4999

    def initialize(value)
        if value &lt;= 0 || value &gt; MAX_ROMAN
            fail "Roman values must be &gt; 0 and &lt;= #{MAX_ROMAN}"
        end
        @value = value
    end

    FACTORS = [["m",1000], ["cm",900], ["d",500], ["cd",400],
               ["c",100], ["xc",90], ["l",50], ["xl",40],
               ["x",10], ["ix",9], ["v",5], ["iv",4], ["i",1]]

    def to_s
        value = @value
        roman = ""
        for code, factor in FACTORS
            count, value = value.divmod(factor)
            roman &lt;&lt; code unless count.zero?
        end
        roman
    end
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content small bullets" ref="10-unit-testing/01_unit-testing/9">
<h1>&#xA1;Lo probamos con los dientes!</h1>

<ul>
<li>Usando  <code>irb</code></li>
</ul>

<h2>Escribiendo un programa de test</h2>

<pre class="sh_ruby"><code>require 'roman'
r = Roman.new(1)
fail "'i' expected" unless r.to_s == "i"
r = Roman.new(9)
fail "'ix' expected" unless r.to_s == "ix"</code></pre>

<ul>
<li>Ruby ya incorpora un framework de tests de unidad:

<ul>
<li>Hasta 1.8 era Test::Unit</li>
<li>A partir de 1.9 es MiniTest</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content small smbullets" ref="10-unit-testing/01_unit-testing/10">
<h1>Test::Unit vs MiniTest::Unit</h1>

<ul>
<li>Durante muchos a&#xF1;os <code>Test::Unit</code> era la opci&#xF3;n de la mayor parte de los
desarrolladores</li>
<li>Sin embargo, el core team de ruby decidi&#xF3; optar por Minitest::Unit por ser
mucho m&#xE1;s liviano</li>
<li>La mayor parte de las <code>assertions</code> de <code>MiniTest</code> se espejan con las
definidas en <code>Test::Unit::TesCase</code></li>
</ul>

<h2>Las diferencias</h2>

<ul>
<li>Ausencia de <code>assert_not_raises</code> y <code>assert_not_throws</code> en <code>MiniTest</code></li>
<li>Mientras que en <code>Test::Unit</code> se usa <code>assert_not_nil(x)</code> y <code>assert_not(x), en</code>MiniTest usaremos
<code>refute_nil(x)</code> y <code>refute(x)</code> </li>
<li>Adem&#xE1;s:

<ul>
<li>Minitest remueve muchas caracteristicas de Test::Unit que no son tan usadas</li>
<li>Si corremos un archivo con tests, MiniTest no invocar&#xE1; los tests en ese
archivo</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="10-unit-testing/01_unit-testing/11">
<h1>MiniTest</h1>

<h2>Aparecen dos opciones de uso:</h2>

<ul>
<li><code>require 'minitest/unit'</code> similar a Test::Unit</li>
<li><code>require 'minitest/spec'</code> utiliza el formato de <em>specs</em> introducido por
<strong><a href="http://rspec.info/">rspec</a></strong></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="10-unit-testing/01_unit-testing/12">
<h1>El framework de testing</h1>

<ul>
<li>El framework de testing provisto por Ruby provee b&#xE1;sicamente tres
funcionalidades en un mismo paquete:

<ul>
<li>Provee una forma de expresar tests individuales</li>
<li>Provee un framework para la estructuraci&#xF3;n de los tests</li>
<li>Ofrece diversas formas flexibles de invocar los tests</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="10-unit-testing/01_unit-testing/13">
<h1>Assertions</h1>

<ul>
<li>En vez de escribir un mont&#xF3;n de <code>if/unless</code> se utilizan <strong>assertions</strong> que
provee el framework de test</li>
<li>Existen muchos tipos de assertions, pero b&#xE1;sicamente todos siguen el mismo
patr&#xF3;n: 

<ul>
<li>Cada assertion provee una forma de especificar un <em>resultado esperado</em> y la
forma de pasar el valor actual </li>
<li>Si el valor actual no es el <em>resultado esperado</em>, la assertion imprimir&#xE1; un
mensaje y contabilizar&#xE1; el fallo</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="10-unit-testing/01_unit-testing/14">
<h1>El ejemplo de Roman</h1>

<h2>Reescribimos los tests que hicimos con los dientes</h2>

<pre class="sh_ruby"><code>require_relative 'roman'
require 'minitest/autorun'
require 'minitest/unit'
class TestRoman &lt; MiniTest::Test
    def test_simple
      assert_equal("i", Roman.new(1).to_s)
      assert_equal("ix", Roman.new(9).to_s)
    end
end</code></pre>

<p><em>Lo probamos</em></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="10-unit-testing/01_unit-testing/15">
<h1>Agregamos m&#xE1;s assertions</h1>

<pre class="sh_ruby"><code>require_relative 'roman'
require 'minitest/autorun'
require 'minitest/unit'
class TestRoman &lt; MiniTest::Test
    def test_simple
      assert_equal("i",  Roman.new(1).to_s)
      assert_equal("ii", Roman.new(2).to_s)
      assert_equal("iii",Roman.new(3).to_s)
      assert_equal("iv", Roman.new(4).to_s)
      assert_equal("ix", Roman.new(9).to_s)
    end
end</code></pre>

<p><em>Lo probamos</em></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="10-unit-testing/01_unit-testing/16">
<h2>Encontramos un</h2>

<p><br/>
<div class="error"> ERROR </div> </p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="10-unit-testing/01_unit-testing/17">
<h1>Analizamos el problema</h1>

<h2>Miramos el <code>to_s</code></h2>

<pre class="sh_ruby"><code>def to_s
  value = @value
  roman = ""
  for code, factor in FACTORS
    count, value = value.divmod(factor)
    roman &lt;&lt; (code * code)
    # cambiamos: unless count.zero?
  end
  roman
end</code></pre>

<p><em>Lo probamos</em></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content small bullets" ref="10-unit-testing/01_unit-testing/18">
<h1>Refactorizando el test</h1>

<h2>Para no repetir los asserts, podemos:</h2>

<pre class="sh_ruby"><code>require_relative 'roman'
require 'minitest/autorun'
require 'minitest/unit'
class TestRoman &lt; MiniTest::Test
  NUMBERS = [
             [ 1, "i" ], [ 2, "ii" ], [ 3, "iii" ],
             [ 4, "iv"], [ 5, "v" ], [ 9, "ix" ]
            ]
  def test_simple
    NUMBERS.each do |arabic, roman|
      r = Roman.new(arabic)
      assert_equal(roman, r.to_s)
    end
  end
end</code></pre>

<ul>
<li>Podemos testear muchas cosas, por ejemplo el constructor de la clase <code>Roman</code></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content small bullets" ref="10-unit-testing/01_unit-testing/19">
<h1>Testeamos el rango de Roman</h1>

<h2>Verificamos si se lanzan las excepciones</h2>

<pre class="sh_ruby"><code>require_relative 'roman'
require 'minitest/autorun'
require 'minitest/unit'
class TestRoman &lt; MiniTest::Test
    def test_range
        # no exception for these two...
        Roman.new(1)
        Roman.new(4999)
        # but an exception for these
        assert_raises(RuntimeError) { Roman.new(0) }
        assert_raises(RuntimeError) { Roman.new(5000) }
    end
end</code></pre>

<ul>
<li>Analicemos qu&#xE9; m&#xE1;s testear en la clase <code>Roman</code> que genera n&#xFA;meros hasta 4999. Ver carpeta <code>samples/10/romans</code></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smaller bullets" ref="10-unit-testing/01_unit-testing/20">
<h1>Listado de assertions</h1>

<pre class="sh_ruby"><code>assert | refute(boolean, [ message ] )
# Fails if boolean is (is not) false or nil.

assert_block { block }
# Expects the block to return true.

assert_ | refute_empty(collection, [ message ] )
# Expects empty? on collection to return true (false).

assert_ | refute_equal(expected, actual, [ message ] )
# Expects actual to equal/not equal expected, using ==.

assert_ | refute_in_delta(expected_float, actual_float, 
                          delta, [ message ] )
# Expects that the actual floating-point value is (is not) 
# within delta of the expected value.

assert_ | refute_in_epsilon(expected_float, actual_float, 
                            epsilon=0.001, [ message ] )
# Calculates a delta value as epsilon * min(expected, actual),
# then calls the _in_delta test.

assert_ | refute_includes(collection, obj, [ message ] )
# Expects include?(obj) on collection to return true (false).</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smaller bullets" ref="10-unit-testing/01_unit-testing/21">
<h1>Listado de assertions</h1>

<pre class="sh_ruby"><code>assert_ | refute_instance_of(klass, obj, [ message ] )
# Expects obj to be (not to be) a instance of klass.

assert_ | refute_kind_of(klass, obj, [ message ] )
# Expects obj to be (not to be) a kind of klass.

assert_ | refute_match(regexp, string, [ message ] )
# Expects string to (not) match regexp.

assert_ | refute_nil(obj, [ message ] )
# Expects obj to be (not) nil.

assert_ | refute_operator(obj1, operator, obj2, [ message ] )
# Expects the result of sending the message operator to obj1 
# with parameter obj2 to be (not to be) true.

assert_raises(Exception, . . . ) { block }
# Expects the block to raise one of the listed exceptions.

assert_ | refute_respond_to(obj, message, [ message] )
# Expects obj to respond to (not respond to) message (a symbol).

assert_ | refute_same(expected, actual, [ message ] )
# Expects expected.equal?(actual).</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smaller bullets" ref="10-unit-testing/01_unit-testing/22">
<h1>Listado de assertions</h1>

<pre class="sh_ruby"><code>assert_send(send_array, [ message ] )
# Sends the message in send_array[1] to the receiver in 
# send_array[0], passing the rest of send_array as arguments. 
# Expects the return value to be true.

assert_throws(expected_symbol, [ message ] ) { block }
# Expects the block to throw the given symbol.

flunk(message="Epic Fail!")
# Always fails.

skip(message)
# Indicates that a test is deliberately not run.

pass
# Always passes.</code></pre>

<ul>
<li>Notar que el &#xFA;ltimo par&#xE1;metro es un mensaje que ser&#xE1; usado en la salida ante
un error.

<ul>
<li>Generalmente no es necesario usarlo porque el error es bastante claro,
salvo  <code>refute_nil</code> que devolver&#xED;a <em>Expected nil to not be nil</em></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smaller bullets" ref="10-unit-testing/01_unit-testing/23">
<h1>Minitest Spec</h1>

<p>Veamos ahora como ser&#xED;a el mismo &#xFA;ltimo test escrito en este nuevo formato</p>

<pre class="sh_ruby"><code>require_relative 'roman'
require 'minitest/autorun'
require 'minitest/spec'
describe Roman do
    NUMBERS = [ [ 1, "i" ], [ 2, "ii" ], [ 3, "iii" ],
        [ 4, "iv"], [ 5, "v" ], [ 9, "ix" ] ]
    describe 'when arbitrary numbers are converted' do
        it 'must return expected value' do
            NUMBERS.each do |arabic, roman|
                r = Roman.new(arabic)
                assert_equal(roman, r.to_s)
            end
        end
    end

    describe 'limits' do 
        it 'should not raise exceptions for these two' do
            Roman.new(1)
            Roman.new(4999)
        end
        it 'should raise an exception for limits' do
            assert_raises(RuntimeError) { Roman.new(0) }
            assert_raises(RuntimeError) { Roman.new(5000) }
        end
    end
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smaller bullets" ref="10-unit-testing/01_unit-testing/24">
<h1>Estructurando los tests</h1>

<ul>
<li><p>Los tests de unidad nos llevan a dos agrupamientos:</p>

<ul>
<li><strong>De alto nivel</strong>: llamados <em>test cases</em>. Contienen todos los tests para una
caracter&#xED;stica determinada. En el ejemplo de <code>Roman</code> alcanza con un &#xFA;nico
test case. Las clases que representan test cases, deben ser subclase de:
<code>Minitest::Test</code></li>
<li><strong>De bajo nivel</strong>: que ser&#xED;an los m&#xE9;todos de test en s&#xED;. Los assertions
podr&#xED;amos escribirlos todos mezclados, pero en su lugar los agrupamos en
m&#xE9;todos dentro del test case de forma de que los assertions en un m&#xE9;todo se
corresponden con un tipo de test: <em>uno testear&#xED;a manejo de errores, otro
m&#xE9;todos de inicializaci&#xF3;n, l&#xED;mites, etc</em>. Los m&#xE9;todos de test, deben
comenzar con el prefijo <strong>test</strong> para que sean seleccionados como tales</li>
</ul></li>
<li><p>Generalmente queremos ejecutar determinado c&#xF3;digo antes y luego de cada test.
Disponemos entonces de:</p>

<ul>
<li><code>setup</code> en Unit o <code>before</code> en Spec</li>
<li><code>teardown</code> en Unit o <code>after</code> en Spec</li>
<li>Ver <code>samples/10/setup-teardown</code></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smaller bullets" ref="10-unit-testing/01_unit-testing/25">
<h1>Otros agregados</h1>

<ul>
<li><p>Mocks</p>

<ul>
<li>minitest/mock</li>
<li>Mocha: https://github.com/freerange/mocha</li>
</ul></li>
<li><p>Coverage con <a href="https://github.com/colszowka/simplecov">simplecov</a></p></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="11-gems-bundler/01_gems/1">
<h1>Gem</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="11-gems-bundler/01_gems/2">
<h1>Introducci&#xF3;n</h1>

<ul>
<li>Una gema es un formato simple para publicar y compartir c&#xF3;digo Ruby.</li>
<li>Cada gema tiene un nombre, versi&#xF3;n y plataforma.</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="11-gems-bundler/01_gems/3">
<h1>Comandos b&#xE1;sicos</h1>

<ul>
<li>Instalar una gema: <code>gem install rake</code></li>
<li>Buscar una gema: <code>gem search sinatra</code></li>
<li>Listar gemas instaladas: <code>gem list</code></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="11-gems-bundler/02_bundler/1">
<h1>Bundler</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="11-gems-bundler/02_bundler/2">
<h1>Introducci&#xF3;n</h1>

<ul>
<li>Mantiene un entorno consistente para las aplicaciones ruby</li>
<li>Asegura que la aplicaci&#xF3;n que lo use tenga las dependencias necesarias
para que se ejecute sin errores.</li>
<li>Bundler es una gema: <code>gem install bundler</code></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="11-gems-bundler/02_bundler/3">
<h1>Ejemplo</h1>

<h2>Definimos las dependencias en el archivo <code>Gemfile</code></h2>

<pre class="sh_ruby"><code>source 'https://rubygems.org'

gem 'sinatra'</code></pre>

<h2>Luego instalamos las dependencias con <code>bundle install</code> o simplemente <code>bundle</code></h2>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="11-gems-bundler/02_bundler/4">
<h1>Comandos</h1>

<ul>
<li>Instalar dependencias: <code>bundle install</code></li>
<li>Actualizar dependencias a sus &#xFA;ltimas versiones: <code>bundle update</code></li>
<li>Ejecutar un script en el contexto del bundle actual: <code>bundle exec</code></li>
<li>Ver las gemas instaladas en el bundle actual: <code>bundle list</code></li>
<li>Ver donde est&#xE1; ubicada una gema: <code>bundle show NOMBRE_GEMA</code></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="11-gems-bundler/02_bundler/5">
<h1>Gemfile</h1>

<ul>
<li>Se escribe con una DSL propia de bundler (extraida de Rubygems)</li>
<li>Puede incluir cualquier c&#xF3;digo ruby!</li>
<li>La sentencia <code>gem</code> indica una dependencia y acepta los siguientes
par&#xE1;metros:

<ul>
<li>versi&#xF3;n, por ejemplo: <code>'&gt;= 1.1.0'</code>, <code>'~&gt; 3.1.2'</code></li>
<li>github (construir la gema a partir de un repositorio en github): <code>github: 'sinatra/sinatra'</code></li>
<li>path: para una gema local</li>
</ul></li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>source 'https://rubygems.org'
gem 'sinatra', github: 'sinatra/sinatra'
gem 'activerecord', '~&gt; 3.1.0'</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="11-gems-bundler/02_bundler/6">
<h1>Usando bundler</h1>

<ul>
<li>Con declarar las dependencias en el <code>Gemfile</code> no basta, hay que invocar a bundler.</li>
<li>Hay dos formas:</li>
</ul>

<h2>Bundler requiere los archivos</h2>

<pre class="sh_ruby"><code>require 'bundler'
Bundler.require</code></pre>

<h2>Bundler configura, pero los require son expl&#xED;citos</h2>

<pre class="sh_ruby"><code>require 'bundler'
Bundler.setup
require 'sinatra'</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="11-gems-bundler/02_bundler/7">
<h1>Con el Gemfile podremos establecer</h1>

<ul>
<li><p>La fuente de donde obtener las gemas: <code>source 'https://rubygems.org'</code></p>

<ul>
<li>Especificarlo para una gema en particular o agrupar gemas por sources</li>
</ul></li>
<li><p>C&#xF3;mo se require la gema: usando <code>require: 'string'</code> o
<code>require: false</code></p></li>
<li><p>Versi&#xF3;n de una gema: <code>&gt;= x.y</code> o <code>~&gt; x.y.z</code></p></li>
<li><p>Tag, branch o ref de un repo git</p></li>
<li><p>Grupos de gemas con el fin de poder requerir o instalarlas en forma modular:
<code>group: :development</code></p>

<ul>
<li>Relacionado con <code>Bundler.setup</code> y <code>Bundler.require</code></li>
</ul></li>
<li><p>Plataforma para la cual aplican determinadas gemas: <code>patforms:
[:jruby, :ruby]</code></p></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="11-gems-bundler/02_bundler/8">
<h1>Ejemplo de Gemfile</h1>

<pre class="sh_ruby"><code>source 'https://rubygems.org'

gem 'thin',  '~&gt;1.1'

gem 'rspec', :require =&gt; 'spec'

gem 'my_gem', '1.0', :source =&gt; 'https://gems.example.com'

gem 'mysql2', platform: :ruby
gem 'jdbc-mysql', platform: :jruby
gem 'activerecord-jdbc-adapter', platform: :jruby

source 'https://gems.example.com' do
    gem 'another_gem', '1.2.1'
end

gem 'nokogiri', 
    :git =&gt; 'https://github.com/tenderlove/nokogiri.git', 
    :branch =&gt; '1.4'

gem 'extracted_library', :path =&gt; './vendor/extracted_library'

gem 'wirble', :group =&gt; :development
gem 'debugger', :group =&gt; [:development, :test]
group :test do
    gem 'rspec'
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="12-sinatra/01_http/1">
<h1>HTTP</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/01_http/2">
<h1>Introducci&#xF3;n</h1>

<ul>
<li>Es un protocolo de red de la capa de aplicaci&#xF3;n</li>
<li>Se ha convertido en el principal protocolo de comunicaci&#xF3;n entre clientes y servidores</li>
<li>Cuando un cliente (un browser, una aplicaci&#xF3;n web, un servicio) quiere
interactuar con un servidor sobre HTTP le env&#xED;a un mensaje (<strong>Request</strong>)</li>
<li>Luego, cuando el servidor termina de procesar el Request puede comunicar
informaci&#xF3;n al cliente creando un mensaje HTTP propio (<strong>Response</strong>).</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/01_http/3">
<h1>Requerimiento HTTP</h1>

<ul>
<li><strong>Start line</strong>: Es la primera l&#xED;nea del Request. Identifica el
<strong>Verbo HTTP</strong>, a que recurso acceder y denota la versi&#xF3;n de HTTP a usar.</li>
<li><strong>Headers</strong>: Proveen informaci&#xF3;n adicional acerca del Request. Ejemplos de
headers son: los valores de las cookies para el dominio, el tipo de contenido
a aceptar, etc.</li>
<li><strong>Message Body</strong>: Puede contener datos binarios o de texto. Por ejemplo,
cuando se sube una imagen a facebook, los datos binarios de la foto son
enviados en este campo. Este campo no es obligatorio.</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content command small" ref="12-sinatra/01_http/4">
<h1>Ejemplo de requerimiento HTTP</h1>

<pre><code>GET /capacitacion-ruby-ttps/ HTTP/1.1

Host: ttps-ruby.github.io

Connection: keep-alive

Pragma: no-cache

Cache-Control: no-cache

Accept: text/html,application/xhtml+xml,\
        application/xml;q=0.9,image/webp,*/*;q=0.8

User-Agent: Mozilla/5.0 (X11; Linux x86_64)\ 
            AppleWebKit/537.36 (KHTML, like \
            Gecko) Chrome/38.0.2125.104 Safari/537.36

Accept-Encoding: gzip,deflate,sdch

Accept-Language: es-ES,es;q=0.8
</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/01_http/5">
<h1>Respuesta HTTP</h1>

<ul>
<li>El <strong>Response</strong> usualmente contiene la siguiente informaci&#xF3;n:

<ul>
<li><strong>status</strong>: si el <strong>Request</strong> del cliente fue exitoso, si ocurri&#xF3; un
error, etc.</li>
<li><strong>headers</strong>: por ejemplo que tipo de contenido se env&#xED;a al cliente, etc.</li>
<li><strong>body</strong>: por ejemplo, un documento HTML</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content command small" ref="12-sinatra/01_http/6">
<h1>Ejemplo de respuesta HTTP</h1>

<pre><code>HTTP/1.1 200 OK

Server: GitHub.com

Content-Type: text/html; charset=utf-8

Last-Modified: Tue, 21 Oct 2014 02:06:17 GMT

Expires: Sun, 26 Oct 2014 23:05:15 GMT

Cache-Control: max-age=600

Content-Encoding: gzip

Content-Length: 78296

Accept-Ranges: bytes

Date: Sun, 26 Oct 2014 22:55:48 GMT


...........{..W.....UT.&gt;.....$`...C.r ....L&amp;.?.T.
...gN...k_......=.{../.g'..~.../.&gt;..V......[_...Q
</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="12-sinatra/01_http/7">
<h1>Un poco de historia de HTTP</h1>

<ul>
<li>Protocolo usado para la WWW.</li>
<li>RFC 2616: http://www.ietf.org/rfc/rfc2616.txt</li>
<li>Lanzado en el a&#xF1;o 1999</li>
<li>Protocolo sin estado (Stateless)</li>
<li>El acceso a los recursos se hace por medio
de m&#xE9;todos:

<ul>
<li>HTTP 1.0: GET, HEAD, POST</li>
<li>HTTP 1.1: agrega PUT, DELETE, OPTIONS, TRACE, CONNECT</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="12-sinatra/01_http/8">
<h1>Algunos detalles del protocolo</h1>

<ul>
<li>Los m&#xE9;todos GET, HEAD, PUT, DELETE son considerados idempotentes: 

<ul>
<li>El resultado de invocar el m&#xE9;todo es el mismo que hacerlo N
veces (N &gt; 1)</li>
</ul></li>
<li>Lo mismo aplica para OPTIONS y TRACE dado que no deber&#xED;an tener efectos
secundarios, y por ende heredan la propiedad</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="12-sinatra/01_http/9">
<h1>Verbos HTTP</h1>

<ul>
<li><strong>GET</strong>: se usa para pedirle al servidor web la representaci&#xF3;n de un
recurso.</li>
<li><strong>POST</strong>: se usa para enviar datos a un servidor web.</li>
<li><strong>PUT</strong>: se usa para crear o actualizar la representaci&#xF3;n de un recurso en
un servidor web.</li>
<li><strong>DELETE</strong>: se usa para destruir un recurso en un servidor web.</li>
<li><strong>PATCH</strong>: se usa para actualizar una parte de un recurso.</li>
<li>La especificaci&#xF3;n de HTTP tambi&#xE9;n define <strong>OPTIONS</strong>, <strong>HEAD</strong>, <strong>TRACE</strong> y
<strong>CONNECT</strong>, los cuales dejaremos de lado.</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content commandline small" ref="12-sinatra/01_http/10">
<h1>El mejor amigo de HTTP: curl</h1>

<p>Curl y libcurl es una librer&#xED;a empleada para interactuar con varios protocolos,
especialmente HTTP. Si deseamos analizar cabeceras HTTP en implementaciones de
servicios WEB o verificar sitios, podemos utilizar esta herramienta. </p>

<h2>Un ejemplo de uso:</h2>

<pre><code><code class="command">$ curl -X GET \
    http://ttps-ruby.github.io/capacitacion-ruby-ttps/ -i</code>
<code class="result">HTTP/1.1 200 OK
Server: GitHub.com
Content-Type: text/html; charset=utf-8
Last-Modified: Tue, 21 Oct 2014 02:06:17 GMT
Expires: Sun, 26 Oct 2014 23:36:24 GMT
Cache-Control: max-age=600
Content-Length: 281844
Accept-Ranges: bytes
Date: Sun, 26 Oct 2014 23:26:24 GMT
Via: 1.1 varnish
Age: 0
Connection: keep-alive
X-Served-By: cache-iad2134-IAD
X-Cache: MISS
X-Cache-Hits: 0
X-Timer: S1414365984.304589,VS0,VE7
Vary: Accept-Encoding

&lt;...
</code></code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="12-sinatra/02_sinatra/1">
<h1>Sinatra</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/2">
<h1>Introducci&#xF3;n</h1>

<ul>
<li>Es una DSL para desarrollar aplicaciones y web services en Ruby basado en
<strong>Rack</strong> (Recordar este t&#xE9;rmino, lo nombraremos mucho de aqu&#xED; en adelante)</li>
<li>Hace &#xE9;nfasis en el desarrollo minimalista, ofreciendo s&#xF3;lo lo que es
esencial para manejar Requests HTTP y entregar Responses a los clientes.</li>
<li>Tiene una sintaxis simple</li>
<li>No es un framework:

<ul>
<li>No tiene un ORM</li>
<li>No tiene archivos de configuraci&#xF3;n</li>
<li>No hay estructura de archivos</li>
</ul></li>
<li>No fuerza a implementar MVC ni ning&#xFA;n otro patr&#xF3;n</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/3">
<h1>Ejemplo</h1>

<ul>
<li>Creamos un directorio e inicializamos con <code>bundle init</code></li>
</ul>

<h2>El Gemfile</h2>

<pre class="sh_ruby"><code>source 'https://rubygems.org'
gem 'sinatra'</code></pre>

<h2>El server</h2>

<pre class="sh_ruby"><code>require 'sinatra'

get '/' do
  'hello world'
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content commandline small" ref="12-sinatra/02_sinatra/4">
<h1>Probamos el server</h1>

<ul>
<li>Asumiendo el server se guarda en el archivo <code>server.rb</code>

<ul>
<li>Lo ejecutamos: <code>ruby server.rb</code></li>
</ul></li>
</ul>

<h2>Probamos con curl</h2>

<pre><code><code class="command">$ curl -v http://localhost:4567/</code>
<code class="result">&gt; GET / HTTP/1.1
&gt; User-Agent: curl/7.35.0
&gt; Host: localhost:4567
&gt; Accept: */*
&gt; 
&lt; HTTP/1.1 200 OK 
HTTP/1.1 200 OK 
&lt; Content-Type: text/html;charset=utf-8
Content-Type: text/html;charset=utf-8
&lt; Content-Length: 11
Content-Length: 11
&lt; X-Xss-Protection: 1; mode=block
X-Xss-Protection: 1; mode=block
&lt; X-Content-Type-Options: nosniff
X-Content-Type-Options: nosniff
&lt; X-Frame-Options: SAMEORIGIN
X-Frame-Options: SAMEORIGIN
* Server WEBrick/1.3.1 (Ruby/2.1.2/2014-05-08) is not blacklisted
&lt; Server: WEBrick/1.3.1 (Ruby/2.1.2/2014-05-08)
Server: WEBrick/1.3.1 (Ruby/2.1.2/2014-05-08)
&lt; Date: Sun, 26 Oct 2014 23:35:04 GMT
</code></code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/5">
<h1>Y c&#xF3;mo lo testeamos?</h1>

<ul>
<li>Para testear aplicaciones sinatra usaremos una gema llamada <code>rack-test</code></li>
<li>Para testear el ejemplo, haremos un request <code>GET /</code> y esperaremos que nos
devuelva un c&#xF3;digo de estado <code>200</code> (OK) y que el body sea <code>'hello world'</code></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/6">
<h1>Y c&#xF3;mo lo testeamos?</h1>

<pre class="sh_ruby"><code>require 'minitest/autorun'
require 'rack/test'
require_relative 'server'

class HelloWorldTest &lt; MiniTest::Test
    include Rack::Test::Methods

    def app
        Sinatra::Application
    end

    def test_get_root
        get '/'
        assert_equal 200, last_response.status
        assert last_response.ok?
        assert_equal 'hello world', last_response.body
    end
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/7">
<h1>Y si queremos usar mintest/spec</h1>

<pre class="sh_ruby"><code>require 'minitest/autorun'
require 'minitest/spec'
require 'rack/test'
require_relative 'server'

include Rack::Test::Methods

def app
    Sinatra::Application
end

describe 'my example server' do
    it 'should succeed' do
        get '/'
        last_response.status.must_equal 200
        last_response.must_be :ok?
        last_response.body.must_include 'hello world'
    end
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/8">
<h1>Rutas en Sinatra</h1>

<ul>
<li>En sinatra una ruta es la dupla de un m&#xE9;todo HTTP, con un patr&#xF3;n de URL</li>
<li>A cada ruta se le asocia un bloque</li>
<li>Las rutas se machean en el orden en que fueron definidas</li>
<li>Los patrones de rutas podr&#xE1;n:

<ul>
<li>Incluir par&#xE1;metros nombrados: accesibles usando el hash <code>params</code> o como un
par&#xE1;metro del bloque</li>
<li>Utilizar argumentos <strong>splat</strong>: accesibles mediante <code>params[:splat]</code> o
par&#xE1;mtros del bloque</li>
<li>Expresiones regulares</li>
<li>Incluir par&#xE1;metros de consulta: <code>?some_param=value&amp;other=other_value</code></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/9">
<h1>Ejemplos de rutas: verbos</h1>

<pre class="sh_ruby"><code>get '/' do
    .. show something ..
end

post '/' do
    .. create something ..
end

put '/' do
    .. replace something ..
end

patch '/' do
    .. modify something ..
end

delete '/' do
    .. annihilate something ..
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="12-sinatra/02_sinatra/10">
<h1>Ejemplos de rutas: verbos</h1>

<pre class="sh_ruby"><code>options '/' do
    .. appease something ..
end

link '/' do
    .. affiliate something ..
end

unlink '/' do
    .. separate something ..
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/11">
<h1>Ejemplos de rutas: patrones con par&#xE1;metros</h1>

<pre class="sh_ruby"><code>get '/hello/:name' do
    # matches "GET /hello/foo" and "GET /hello/bar"
    # params[:name] is 'foo' or 'bar'
    "Hello #{params[:name]}!"
end

# O usando variables de bloque
get '/hello/:name' do |n|
    # matches "GET /hello/foo" and "GET /hello/bar"
    # params[:name] is 'foo' or 'bar'
    # n stores params[:name]
    "Hello #{n}!"
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/12">
<h1>Ejemplos de rutas: patrones con splats</h1>

<pre class="sh_ruby"><code>get '/say/*/to/*' do
    # matches /say/hello/to/world
    params[:splat] # =&gt; ["hello", "world"]
end

get '/download/*.*' do
    # matches /download/path/to/file.xml
    params[:splat] # =&gt; ["path/to/file", "xml"]
end

# O usando variales de bloque
get '/download/*.*' do |path, ext|
    [path, ext] # =&gt; ["path/to/file", "xml"]
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/13">
<h1>Ejemplos de rutas: patrones basados en regexp</h1>

<pre class="sh_ruby"><code>get %r{/hello/([\w]+)} do
    "Hello, #{params[:captures].first}!"
end

# O usando variables de bloque
get %r{/hello/([\w]+)} do |c|
    "Hello, #{c}!"
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/14">
<h1>Ejemplos de rutas: con par&#xE1;metros de consulta</h1>

<pre class="sh_ruby"><code>get '/posts' do
    # matches "GET /posts?title=foo&amp;author=bar"
    title = params[:title]
    author = params[:author]
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="12-sinatra/02_sinatra/15">
<h1>Sinatra: Condiciones</h1>

<ul>
<li>Las rutas de sinatra pueden incluir condiciones de match como por ejemplo:

<ul>
<li><code>agent</code>: condiciones sobre el UA</li>
<li><code>provides</code>: condiciones sobre el content type</li>
<li><code>host_name</code>: condiciones sobre el server name</li>
<li>definidas por el usuario</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="12-sinatra/02_sinatra/16">
<h1>Ejemplo de Condiciones</h1>

<pre class="sh_ruby"><code>get '/foo', :agent =&gt; /Songbird (\d\.\d)[\d\/]*?/ do
    "You're using Songbird version #{params[:agent][0]}"
end

get '/foo' do
    # Matches non-songbird browsers
end</code></pre>

<h2>C&#xF3;mo probar?</h2>

<p><code>curl -i -v http://localhost:4567 -A 'Songbird 1.1'</code></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="12-sinatra/02_sinatra/17">
<h1>Ejemplo de condiciones con host_name y provides</h1>

<pre class="sh_ruby"><code>get '/', :host_name =&gt; /^admin\./ do
    "Admin Area, Access denied!"
end

get '/', :provides =&gt; 'html' do
    'HTML'
end

get '/', :provides =&gt; ['rss', 'atom', 'xml'] do
    'XML'
end</code></pre>

<h2>C&#xF3;mo probar?</h2>

<p><code>curl -i -v http://localhost:4567 -H "Accept: application/xml"</code></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/18">
<h1>Ejemplo de condiciones propias</h1>

<pre class="sh_ruby"><code>set(:probability) do |value| 
    condition { rand &lt;= value }
end

get '/win_a_car', :probability =&gt; 0.1 do
    "You won!"
end

get '/win_a_car' do
    "Sorry, you lost."
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="12-sinatra/02_sinatra/19">
<h1>Ejemplo de condiciones propias</h1>

<pre class="sh_ruby"><code>set(:auth) do |*roles|   # &lt;- notice the splat here
    condition do
        unless logged_in? &amp;&amp; 
            roles.any? {|role| current_user.in_role? role }
                redirect "/login/", 303
        end
    end
end

get "/my/account/", :auth =&gt; [:user, :admin] do
    "Your Account Details"
end

get "/only/admin/", :auth =&gt; :admin do
    "Only admins are allowed here!"
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/20">
<h1>Sinatra: valor de retorno</h1>

<ul>
<li>El valor de retorno de un bloque de ruta determina al menos el cuerpo de la
respuesta que se le pasa al cliente HTTP o al siguiente middleware en la pila
de Rack.</li>
<li>Lo m&#xE1;s com&#xFA;n es que sea un string, como en los ejemplos anteriores.</li>
<li>Sin embargo, otros valores tambi&#xE9;n son aceptados (no lo veremos ahora)</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/21">
<h1>Sinatra: caracter&#xED;sticas</h1>

<ul>
<li><strong>Archivos est&#xE1;ticos</strong>: Son servidos desde el directorio <code>public</code></li>
<li><strong>Vistas/Plantillas</strong>: Sinatra soporta numerosos template engines, y para
renderizar vistas de cada template engine se expone un m&#xE9;todo con su mismo
nombre. A estos m&#xE9;todos debe pas&#xE1;rsele un s&#xED;mbolo con el nombre de la vista
a utilizar, que debe ser guardado en el directorio <code>views</code></li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>get '/' do
  @name = 'Frank Sinatra'
  erb :index
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/22">
<h1>Sinatra: caracter&#xED;sticas (continuaci&#xF3;n)</h1>

<pre class="sh_html"><code>&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Welcome&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    Hello, &lt;%= @name %&gt;!
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/23">
<h1>Sinatra: caracter&#xED;sticas (continuaci&#xF3;n)</h1>

<ul>
<li><strong>Filtros</strong>: Los filtros <code>before</code> son evaluados antes de cada petici&#xF3;n
dentro del mismo contexto que las rutas. Pueden modificar la petici&#xF3;n y la
respuesta. Las variables de instancia asignadas en los filtros son accesibles
por las rutas y las plantillas (idem con <code>after</code>):</li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>before do
  @nota = 'Hey!'
end

get '/' do
  @nota #=&gt; 'Hey!'
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/24">
<h1>Sinatra: caracter&#xED;sticas (continuaci&#xF3;n)</h1>

<ul>
<li><strong>Helpers</strong>: Son m&#xE9;todos que pueden ser usados en los bloques de rutas y los
templates.</li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>helpers do
  def bar(name)
    "#{name}bar"
  end
end

get '/:name' do
  "#{bar params[:name]}"
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/25">
<h1>Sinatra: caracter&#xED;sticas (continuaci&#xF3;n)</h1>

<ul>
<li><strong>Sessions</strong>: Una sesi&#xF3;n es usada para mantener el estado a trav&#xE9;s de
distintas peticiones. Cuando est&#xE1;n activadas, proporciona un hash de sesi&#xF3;n
para cada sesi&#xF3;n de usuario:</li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>enable :sessions

get '/' do
  "value = " &lt;&lt; session[:value].inspect
end

get '/:value' do
  session[:value] = params[:value]
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/26">
<h1>Sinatra: caracter&#xED;sticas (continuaci&#xF3;n)</h1>

<ul>
<li><strong>Redirecciones del navegador</strong>: Pod&#xE9;s redireccionar al navegador con el
m&#xE9;todo redirect:</li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>get '/foo' do
  redirect to('/bar')
end

get '/bar' do
  'Hello!'
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="12-sinatra/02_sinatra/27">
<h1>Sinatra: caracter&#xED;sticas (continuaci&#xF3;n)</h1>

<ul>
<li><strong>Manejo de errores</strong>: Los manejadores de errores se ejecutan dentro del
mismo contexto que las rutas y los filtros before, lo que significa que pod&#xE9;s
usar, por ejemplo, haml, erb, halt, etc.</li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>not_found do
  'Ruta no encontrada'
end

error do
  'Disculp&#xE1;, ocurri&#xF3; un error horrible - ' +
    env['sinatra.error'].name
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="12-sinatra/03_referencias/1">
<h1>Referencias</h1>

<ul>
<li><a href="http://www.sinatrarb.com/">Sitio web de Sinatra</a></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="12-sinatra/03_referencias/2">
<h1>Otros recursos</h1>

<ul>
<li><a href="https://github.com/ttps-ruby/sinatra_app_template">sinatra_ app_ template</a></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="13-activerecord/01_activerecord/1">
<h1>Active Record</h1>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="13-activerecord/01_activerecord/2">
<h1>Introducci&#xF3;n</h1>

<ul>
<li>Representa la M de MVC (el modelo)</li>
<li>Conecta clases a tablas de una base de datos estableciendo una capa de
persistencia</li>
<li>La librer&#xED;a provee una clase base que al heredarse, mapea la nueva clase
con una tabla existente de una base de datos</li>
<li>En el contexto de una aplicaci&#xF3;n a estas clases suelen llamarselas <strong>modelos</strong></li>
<li>Los modelos pueden conectarse con otros modelos usando <strong>asociaciones</strong></li>
<li>Active Record se basa much&#xED;simo en convenciones de nombres de forma tal que
utiliza el nombre de una clase o asociaci&#xF3;n para establecer mapeos con tablas
de la base de datos y claves for&#xE1;neas.

<ul>
<li>A pesar de poder definir estos mapeos en forma expl&#xED;cita, es muy
recomendable seguir las convenciones de nombres, especialmente durante el
aprendizaje de la librer&#xED;a</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="13-activerecord/01_activerecord/3">
<h1>ORM</h1>

<ul>
<li>Object Relational Mapping (ORM) es una t&#xE9;cnica que conecta objetos de una
aplicaci&#xF3;n a tablas de un RDBMS. </li>
<li>Utilizando ORM, las propiedades y relaciones de los objetos en una aplicaci&#xF3;n
pueden ser f&#xE1;cilmente almacenados y recuperados de una base de datos <strong>sin</strong>
escribir SQL directamente, minimizando el c&#xF3;digo de base de datos</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="13-activerecord/01_activerecord/4">
<h1>Active Record como Framework de ORM</h1>

<ul>
<li>Representa modelos y sus datos</li>
<li>Representa asociaciones entre los modelos</li>
<li>Representa herencia entre modelos</li>
<li>Validaciones de modelos antes de ser persistidos</li>
<li>Operaciones de bases de datos de forma orientada a objetos</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="13-activerecord/01_activerecord/5">
<h1>Convention over configuration para Active Record</h1>

<ul>
<li>En la mayor&#xED;a de los frameworks ORM es necesario configurar varios archivos
para comenzar a operar</li>
<li>En Active Record, si se siguen las convenciones adoptadas por Rails, ser&#xE1;
necesario escribir muy pocas configuraciones (en algunos casos ninguna
configuraci&#xF3;n) para crear modelos</li>
<li>La configuraci&#xF3;n expl&#xED;cita ser&#xE1; necesaria s&#xF3;lo cuando no pueda seguirse la
convenci&#xF3;n estandar</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="13-activerecord/01_activerecord/6">
<h1>El primer ejemplo</h1>

<ul>
<li>Active Record mapea autom&#xE1;ticamente entre tablas y clases, atributos y
columnas</li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>class Product &lt; ActiveRecord::Base
end</code></pre>

<p>La clase <code>Product</code> <strong>se mapea autom&#xE1;ticamente a la tabla llamada <code>products</code></strong>, que
podr&#xED;a ser algo como:</p>

<pre class="sh_sql"><code>CREATE TABLE products (
    id int(11) NOT NULL auto_increment,
    name varchar(255),
    PRIMARY KEY  (id)
);</code></pre>

<p>Adem&#xE1;s se definen los siguientes accessors: <code>Product#name</code> y
<code>Product#name=(new_name)</code></p>

<p><em>Ver ejemplo <code>13/00-intro-ar</code> y notar que no funcionar&#xE1; si no existe la tabla
creada</em></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="13-activerecord/01_activerecord/7">
<h1>Convenciones de nombres</h1>

<ul>
<li>Los nombres de las clases se pluralizan para encontrar las tablas

<ul>
<li>Por ejemplo <code>Book</code> se mapea a <code>books</code> </li>
<li>El mecanismo de pluralizaci&#xF3;n (definido por Rails) es muy potente y puede
pluralizar (y singularizar) tanto palabras regulares como irregulares. </li>
<li>Cuando las clases se componen de m&#xE1;s de una palabra, se utiliza <strong>CamelCase</strong> 
y el nombre de la tabla se compone de las palabras separadas por
underscores. Por ejemplo: la clase <code>BookClub</code> se mapear&#xE1; a la tabla
<code>book_clubs</code></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="13-activerecord/01_activerecord/8">
<h1>Ejemplo de mapeos</h1>

<pre><code>
    +---------------+---------------+
    | Model / Class | Table / Schema|
    +---------------+---------------+
    | Post          | posts         |
    | LineItem      | line_items    |
    | Deer          | deers         |
    | Mouse         | mice          |
    | Person        | people        |
    +---------------+---------------+</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="13-activerecord/01_activerecord/9">
<h1>Convenciones sobre los esquemas</h1>

<ul>
<li>Active Record utiliza convenciones para las columnas de las tablas,
dependiendo del prop&#xF3;sito de estas columnas

<ul>
<li><strong>Claves for&#xE1;neas:</strong> deben llamarse de la siguiente forma:
<code>nombre_en_singular_id</code> (por ejemplo: <code>item_id</code>, <code>order_id</code>). Estos ser&#xE1;n
los campos por los que Active Record buscar&#xE1; cuando se creen asociaciones entre
modelos</li>
<li><strong>Claves primarias:</strong> por defecto, Active Record utilizar&#xE1; una columna de
tipo entero llamada <code>id</code> como clave primaria. Cuando se usan <em>Migraciones de
Active Record</em> para crear las tablas, esta columna se crear&#xE1; autom&#xE1;ticamente</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="13-activerecord/01_activerecord/10">
<h1>M&#xE1;s convenciones sobre los esquemas</h1>

<ul>
<li><code>created_at</code>: esta columna autom&#xE1;ticamente setea la fecha y hora cuando el
registro es creado</li>
<li><code>updated_at</code>: esta columna autom&#xE1;ticamente setea la fecha y hora cuando el
registro es actualizado</li>
<li><code>lock_version</code>: agrega <a href="http://api.rubyonrails.org/classes/ActiveRecord/Locking/Optimistic.html">optimistic
locking</a> al modelo</li>
<li><code>type</code>: especifica que el modelo utiliza <a href="http://api.rubyonrails.org/classes/ActiveRecord/Base.html#label-Single+table+inheritance">Single Table
Inheritance</a></li>
<li><code>(association_name)_type</code>: especifica el tipo de <a href="http://edgeguides.rubyonrails.org/association_basics.html#polymorphic-associations">asociaciones
polim&#xF3;rifcas</a></li>
<li><code>(table_name)_count</code>: usado para cachear el n&#xFA;mero de registros que pertenecen
a una asociaci&#xF3;n. Por ejemplo, una columna <code>comments_count</code> en la clase <code>Post</code> que tiene muchas instancias de <code>Comment</code>, cachear&#xE1; el n&#xFA;mero de comentarios existentes para cada post.</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="13-activerecord/01_activerecord/11">
<h1>Creando modelos en Active Record</h1>

<ul>
<li>Es muy simple crear modelos con Active Record

<ul>
<li>Simplemente se subclasea <code>ActiveRecord::Base</code> y listo</li>
</ul></li>
</ul>

<h2>Por ejemplo</h2>

<pre class="sh_ruby"><code>class Product &lt; ActiveRecord::Base
end
p = Product.new
p.name = "Some Book"
puts p.name # "Some Book"</code></pre>

<ul>
<li>Esto crear&#xE1; el mapeo entre <code>Product</code> y la tabla <code>products</code>. </li>
<li>Adem&#xE1;s exisitr&#xE1; el mapeo de cada campo en la tabla a accessors del objeto.</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="13-activerecord/01_activerecord/12">
<h1>CRUD: Leyendo y escribiendo datos</h1>

<ul>
<li>CRUD significa <strong>C</strong>reate, <strong>R</strong>ead, <strong>U</strong>pdate, <strong>D</strong>elete</li>
<li>Active Record provee m&#xE9;todos que permiten a la aplicaci&#xF3;n leer y escribir
datos en las tablas</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="13-activerecord/01_activerecord/13">
<h1>Creaci&#xF3;n</h1>

<ul>
<li>Los objetos Active Record pueden crearse desde:

<ul>
<li>Un Hash</li>
<li>Un bloque</li>
<li>Setear manualmente los atributos luego de la creaci&#xF3;n</li>
</ul></li>
<li>El m&#xE9;todo <code>new</code> retornar&#xE1; un objeto <strong>nuevo</strong> mientras que <code>create</code> retornar&#xE1;
un objeto y lo <strong>guardar&#xE1;</strong> en la base de datos</li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>user = User.create(name: "David",
                   occupation: "Code Artist")
# es lo mismo que:
user = User.new
user.name = "David"
user.occupation = "Code Artist"
user.save</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="13-activerecord/01_activerecord/14">
<h1>Creaci&#xF3;n con bloques</h1>

<pre class="sh_ruby"><code>user = User.new do |u|
    u.name = "David"
    u.occupation = "Code Artist"
end</code></pre>

<p><em>funciona tanto con <code>new</code> como <code>create</code></em></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="13-activerecord/01_activerecord/15">
<h1>Lectura</h1>

<ul>
<li>Active Record provee una completa API para acceder a los datos de una base de
datos</li>
</ul>

<h2>Ejemplos</h2>

<pre class="sh_ruby"><code># return a collection with all users
users = User.all

# return the first user
user = User.first

# find all users named David who are Code Artists and 
# sort by created_at inreverse chronological order
users = User.where(name: 'David', 
                   occupation: 'Code Artist').
                   order('created_at DESC')</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="13-activerecord/01_activerecord/16">
<h1>Actualizaci&#xF3;n</h1>

<ul>
<li>Una vez que un dato es recuperado, sus atributos pueden modificarse y luego
almacenarse en la base de datos nuevamente</li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>user = User.find_by(name: 'David')
user.name = 'Dave'
user.save

# Lo mismo pero m&#xE1;s corto
user = User.find_by(name: 'David')
user.update(name: 'Dave')

# Para cambios masivos
User.update_all "max_attempts = 3, must_change_pwd = 'true'"</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="13-activerecord/01_activerecord/17">
<h1>Eliminaci&#xF3;n</h1>

<ul>
<li>De igual forma, una vez recuperado un objeto Active Record, podr&#xE1; destruirse 
y a su vez eliminarse de la base de datos</li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>user = User.find_by(name: 'David')
user.destroy</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="13-activerecord/01_activerecord/18">
<h1>Validaciones</h1>

<ul>
<li>Active Record permite validar el estado de un modelo antes de que sea escrito
a la base de datos</li>
<li>Existen varios mecanismos para validar y chequear que ciertos atributos no
sean blanco, no vac&#xED;o, &#xFA;nicos, tener un formato espec&#xED;fico, etc. </li>
<li>Las validaciones deben ser consideradas a la hora de persistir datos en la
base de datos

<ul>
<li>Por ello, los m&#xE9;todos como <code>create</code>, <code>save</code> y <code>update</code> consideran las
validaciones. </li>
<li>Retornan <code>false</code> cuando la validaci&#xF3;n falla y no actualizan el dato en la
base de datos</li>
<li>Todos estos m&#xE9;todos tiene sus correspondientes con bang! (<code>create!</code>,
<code>save!</code>y <code>update!</code>) que son estrictos en cuanto a lanzar una excepci&#xF3;n <code>ActiveRecord::RecordInvalid</code>
cuando la validaci&#xF3;n falla.</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="13-activerecord/01_activerecord/19">
<h1>Ejemplo de Validaciones</h1>

<pre class="sh_ruby"><code>class User &lt; ActiveRecord::Base
    validates :name, presence: true
end

User.create  
# =&gt; false
User.create! 
# =&gt; ActiveRecord::RecordInvalid: 
#    Validation failed: 
#    Name can't be blank</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="13-activerecord/01_activerecord/20">
<h1>Callbacks</h1>

<ul>
<li>Active Record callbacks permiten adjuntar c&#xF3;digo a ciertos eventos en el ciclo
de vida de los modelos.</li>
<li>Permiten agregar comportamiento a los modelos que es ejecutado de forma transparente 
cuando estos eventos suceden.</li>
<li>Pueden agregarse eventos cuando se crea un nuevo registro, al modificarse, al
eliminarse, etc.</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="13-activerecord/01_activerecord/21">
<h1>Migraciones</h1>

<ul>
<li>Las migraciones son una DSL para el manejo de esquemas de bases de datos
llamados migraciones</li>
<li>Las migraciones se almacenan en archivos que son ejecutados contra una base de
datos soportada por Active Record usando <code>rake</code></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="13-activerecord/01_activerecord/22">
<h1>Migraciones</h1>

<h2>Ejemplo de una migraci&#xF3;n que crea una tabla</h2>

<pre class="sh_ruby"><code>class CreatePublications &lt; ActiveRecord::Migration
    def change
        create_table :publications do |t|
            t.string :title
            t.text :description
            t.references :publication_type
            t.integer :publisher_id
            t.string :publisher_type
            t.boolean :single_issue

            t.timestamps
        end
        add_index :publications, :publication_type_id
    end
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="13-activerecord/01_activerecord/23">
<h1>Migraciones</h1>

<ul>
<li>Las migraciones permiten tener un registro en la misma base de datos que
indica qu&#xE9; cambios se han aplicado</li>
<li>Los cambios entonces pueden versionarse y comitirse o deshacerse en la base de
datos</li>
<li>Para aplicar las migraciones pendientes: <code>rake db:migrate</code></li>
<li>Para deshacer un cambio hecho: <code>rake db:rollback</code></li>
<li>La DSL es agn&#xF3;stico a la base de datos: funciona en MySQL, SQLite, Oracle,
Postgres, etc</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="13-activerecord/01_activerecord/24">
<h1>Referencias</h1>

<ul>
<li><a href="http://api.rubyonrails.org/classes/ActiveRecord/Base.html">API</a></li>
<li><a href="http://edgeguides.rubyonrails.org/active_record_basics.html">Active Record base</a></li>
<li><a href="http://guides.rubyonrails.org/association_basics.html">Active Record Associations</a></li>
<li><a href="http://edgeguides.rubyonrails.org/active_record_querying.html">Active Record Querying</a></li>
<li><a href="http://edgeguides.rubyonrails.org/active_record_validations.html">Active Record Validations</a></li>
<li><a href="http://edgeguides.rubyonrails.org/active_record_callbacks.html">Active Record
Callbacks</a></li>
<li><a href="http://edgeguides.rubyonrails.org/migrations.html">Active Record Migrations</a></li>
</ul>

<h2>Desde Sinatra</h2>

<ul>
<li><a href="https://github.com/janko-m/sinatra-activerecord">Active Record y Sinatra</a></li>
<li><a href="https://github.com/svenfuchs/micro_migrations">Active Record micro_migrations</a></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content center" ref="14-rails/00-introduccion/1">
<p><img src="./file/14-rails/rails_logo.png" alt="Rails"/>

<h1>Rails</h1>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="14-rails/00-introduccion/2">
<h1>C&#xF3;mo funciona la web</h1>

<ul>
<li>Contenidos: HTML, imagenes, CSS, JS</li>
<li>Contenidos est&#xE1;ticos</li>
<li>Contenidos din&#xE1;micos

<ul>
<li>Porque se conecta a una DB / Servicio (Facebook)</li>
<li>Para simplificar el armado de un HTML modularizando el armado (partials)</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="14-rails/00-introduccion/3">
<h1>Qu&#xE9; es rails</h1>

<ul>
<li>Conjunto de estructuras y convenciones</li>
<li>Es una librer&#xED;a o conjunto de gemas</li>
<li>Al usar rails,  estaremos usando pr&#xE1;cticas estandar que simplificar&#xE1;n la
colaboraci&#xF3;n y el mantenimiento del c&#xF3;digo</li>
<li>Promueve <a href="http://en.wikipedia.org/wiki/Separation_of_concerns">Separation of Concerns (SoC)</a>, lo cual permite obtener programas modulares y mantenibles</li>
<li>El principal patr&#xF3;n de dise&#xF1;o que implementa es MVC</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="14-rails/00-introduccion/4">
<h1>Stacks</h1>

<p>Un stack es un conjunto de tecnolog&#xED;as o librer&#xED;as utilizadas para desarrollar
una aplicaci&#xF3;n o para servir una p&#xE1;gina</p>

<h2>Ejemplos de stack</h2>

<ul>
<li>Facebook usa algo como:

<ul>
<li>Linux (operating system)</li>
<li>Apache (web server)</li>
<li>MySQL (database)</li>
<li>PHP (programming language)</li>
</ul></li>
<li>Para el desarrollo con rails generalmente es:

<ul>
<li>Mac OS X, Linux, or Windows</li>
<li>WEBrick (web server)</li>
<li>SQLite (database)</li>
<li>Ruby on Rails (language and framework)</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="14-rails/00-introduccion/5">
<h1>Componentes y alternativas</h1>

<ul>
<li>Un cl&#xE1;sico stack de rails ser&#xE1;:

<ul>
<li>ERB for view templates</li>
<li>MySQL for databases</li>
<li>MiniTest for testing</li>
</ul></li>
<li>Una alternativa:

<ul>
<li>Haml for view templates</li>
<li>PostgreSQL for databases</li>
<li>Rspec for testing</li>
</ul></li>
</ul>

<p>Las componentes podr&#xE1;n intercambiarse f&#xE1;cilmente, habiendo m&#xFA;ltiples
alternativas. Seguir las tendencias o componentes populares es una buena
elecci&#xF3;n</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="14-rails/00-introduccion/6">
<h1>Ayuda</h1>

<h2>&#xBF;C&#xF3;mo obtener ayuda?</h2>

<ul>
<li>Google: pero considerar resultados actuales</li>
<li><a href="http://stackoverflow.com/questions/tagged/ruby-on-rails">Stack Overflow</a></li>
<li><a href="http://guides.rubyonrails.org/">Rails Guides</a></li>
<li><a href="http://api.rubyonrails.org/">Rails Documentation</a></li>
<li><a href="http://pragtob.github.io/rails-beginner-cheatsheet/index.html">Rails Begginer Chat
Sheet</a></li>
<li><a href="http://railscasts.com/">Railscasts</a></li>
</ul>

<h2>Mantenerse actualizado</h2>

<ul>
<li><a href="http://rubyweekly.com/">Ruby Weekly</a></li>
<li><a href="http://www.rubyflow.com/">Ruby Flow</a></li>
<li><a href="http://ruby5.envylabs.com/">Ruby5</a></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content commandline incremental" ref="14-rails/00-introduccion/7">
<h1>Instalando</h1>

<pre><code><code class="command">$ gem install rails</code>
<code class="result">Successfully installed rails-4.0.1

</code><code class="command">$ rails -v</code>
<code class="result">Rails 4.0.1
</code></code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content commandline smaller" ref="14-rails/00-introduccion/8">
<h1>Exploramos el comando <code>rails new</code></h1>

<ul>
<li>Es importante saber que disponemos de mensajes de ayuda para cada comando
rails</li>
<li>Rails provee el comando <code>rails new</code> para crear una aplicaci&#xF3;n Rails b&#xE1;sica</li>
</ul>

<h2>Veamos la ayuda disponible para <code>rails new</code>:</h2>

<pre><code><code class="command">$ rails new --help</code>
</code></pre>

<ul>
<li>La ayuda puede parecer un tanto cr&#xED;ptica a primera vista, pero es importante
leer las opciones para ver qu&#xE9; alternativas tenemos.</li>
<li>No usaremos ninguna opci&#xF3;n en esta primer instancia</li>
<li>Como resultado de la ejecuci&#xF3;n, se crear&#xE1; un directorio con carpetas y
archivos en ella.</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content commandline" ref="14-rails/00-introduccion/9">
<h1>Creamos nuestra primer aplicaci&#xF3;n</h1>

<p>Primero creamos nuestra aplicaci&#xF3;n</p>

<pre><code><code class="command">$ rails new learn-rails</code>
</code></pre>

<p>El par&#xE1;metro <strong>learn-rails</strong> indica el nombre del proyecto. Puede usarse
cualquier nombre</p>

<p>Se instalar&#xE1;n varias gemas nuevas usando <code>bundler</code></p>

<pre><code><code class="command">$ cd learn-rails</code>
</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content commandline" ref="14-rails/00-introduccion/10">
<h1>Probando la nueva aplicaci&#xF3;n</h1>

<p>Con los pasos anteriores hemos creado una aplicaci&#xF3;n simple con valores por
defecto que ya puede usarse</p>

<h2>Iniciando el servidor web</h2>

<p>Es posible iniciar la aplicaci&#xF3;n usando <code>rails server</code> o <code>rails s</code></p>

<pre><code><code class="command">$ bundle exec rails s</code>
<code class="result">... Could not find a JavaScript runtime....
</code></code></pre>

<p>Para solucionar este error debe instalarse <strong>nodejs</strong> o agregar la gema
<strong>therubyracer</strong> al <code>Gemfile</code> (notar que ya est&#xE1; pero comentada)</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content commandline small" ref="14-rails/00-introduccion/11">
<h1>Iniciando el web server</h1>

<pre><code><code class="command">$ bundle exec rails s</code>
<code class="result">=&gt; Booting WEBrick
=&gt; Rails 4.0.1 application starting in development on http://0.0.0.0:3000
=&gt; Run `rails server -h` for more startup options
=&gt; Ctrl-C to shutdown server
[2013-11-30 19:41:53] INFO  WEBrick 1.3.1
[2013-11-30 19:41:53] INFO  ruby 2.0.0 (2013-06-27) [x86_64-linux]
[2013-11-30 19:41:53] INFO  WEBrick::HTTPServer#start: pid=15338 port=3000
</code></code></pre>

<ul>
<li>Visualizamos la aplicaci&#xF3;n accediendo a <a href="http://localhost:3000">http://localhost:3000</a></li>
<li>Observar que al usar el navegador, la consola donde se inici&#xF3; el web server
se actualiza con informaci&#xF3;n

<ul>
<li>Estos mismos mensajes se van almacenando en <code>log/development.log</code></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="14-rails/00-introduccion/12">
<h1>Parando el web server</h1>

<ul>
<li>El web server puede pararse con <strong>Control+C</strong></li>
<li>No es necesario reiniciar el servidor en caso de modificar el proyecto</li>
<li>Los casos que requiere reiniciar son: 

<ul>
<li>Cuando se cambia el <code>Gemfile</code></li>
<li>Al cambiar archivos de configuraci&#xF3;n </li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover">
  <div class="content bullets" ref="14-rails/01-estructura/1">
<h1>La estructura del proyecto</h1>

<h2>Carpetas y archivos importantes</h2>

<table>
  <tr>
    <td>Gemfile</td>
    <td> Lists all the gems used by the application.</td>
  </tr>
  <tr>
    <td>Gemfile.lock</td>
    <td>Lists gem versions and dependencies.</td>
  <tr>
    <td>README.rdoc</td>
    <td>A page for documentation.</td>
  <tr>
    <td>app/</td>
    <td>Application folders and files.</td>
  </tr>
  <tr>
    <td>config/ </td>
    <td>Configuration folders and files.</td>
  </tr>
  <tr>
    <td>db/ </td>
    <td>Database folders and files.</td>
  </tr>
  <tr>
    <td>public/ </td>
    <td>Files for web pages that do not contain Ruby code, such as error
pages.</td>
  </tr>
</tr>
</tr>
</table>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="14-rails/01-estructura/2">
<h1>La estructura del proyecto</h1>

<h2>Carpetas y archivos no tan importantes</h2>

<p>No son importantes cuando estamos aprendiendo rails...</p>

<table>
  <tr>
    <td>Rakefile</td>
    <td>Directives for the Rake utility program.</td>
  </tr>
  <tr>
    <td>bin/ </td>
    <td>Folder for binary (executable) programs.</td>
  </tr>
  <tr>
    <td>config.ru </td>
    <td>Configuration file for Rack (a software library for web servers).</td>
  </tr>
  <tr>
    <td>lib/</td> 
    <td>Folder for miscellaneous Ruby code.</td>
  </tr>
  <tr>
    <td>log/ </td>
    <td>Folder for application server logfiles.</td>
  </tr>
  <tr>
    <td>tmp/ </td>
    <td>Temporary files created when your application is running.</td>
  </tr>
  <tr>
    <td>vendor/ </td>
    <td>Folder for Ruby software libraries that are not gems.</td>
  </tr>
</table>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="14-rails/01-estructura/3">
<h1>El directorio <code>app/</code></h1>

<ul>
<li>Si listamos el contenido del directorio, nos encontramos con seis carpetas que
estar&#xE1;n presentes en todo proyecto rails:

<ul>
<li>assets</li>
<li><strong>controllers</strong></li>
<li>helpers</li>
<li>mailers</li>
<li><strong>models</strong></li>
<li><strong>views</strong></li>
</ul></li>
<li>Aqu&#xED; se hace evidente el patr&#xF3;n <em>model view controller</em></li>
<li>La carpeta <code>mailers/</code> contempla c&#xF3;digo para el env&#xED;o de mails</li>
<li>La carpeta <code>helpers/</code> contiene <em>view helpers</em>, que son peque&#xF1;as porciones de
c&#xF3;digo reusable que generan HTML. Podr&#xED;amos definirnos como macros que
expanden un peque&#xF1;o comando en strings m&#xE1;s extensos de tags HTML y contenido</li>
<li>La carpeta <code>assets/</code> contiene estilos CSS y Javascripts que son procesados
por <em>sprockets</em></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="14-rails/02-rails-gems/1">
<h1>Las Gemas de Rails</h1>

<ul>
<li>Rails en s&#xED; es una gema que, de hecho, requiere un conjunto de otras gemas

<ul>
<li>Esto puede verse en
<a href="https://rubygems.org/gems/rails">Rubygems</a></li>
</ul></li>
<li>Las gemas en que depende rails son:

<ul>
<li><a href="https://github.com/rails/rails/tree/master/actionmailer">actionmailer</a> - framework para env&#xED;o de email y testing</li>
<li><a href="https://github.com/rails/rails/tree/master/actionpack">actionpack</a> - framework para el ruteo y respuestas a requerimientos WEB. <em>Es el VC de MVC</em></li>
<li><a href="https://github.com/rails/rails/tree/master/activerecord">activerecord</a> - framework para la conexi&#xF3;n a bases de datos. <em>Es el M de MVC</em></li>
<li><a href="https://github.com/rails/activeresource">activeresource</a> - framework para la abstracci&#xF3;n de servicios REST. <em>Es el M' de MVC</em></li>
<li><a href="https://github.com/rails/rails/tree/master/activesupport">activesupport</a> - extensiones a Ruby y clases que proveen mayor funcionalidad</li>
<li><a href="http://gembundler.com/">bundler</a> - Manejo de gemas</li>
<li><a href="https://github.com/rails/rails/tree/master/railties">railties</a> - comandos de consola y generadores</li>
</ul></li>
</ul>

<p>Estas gemas a su vez tienen dependencias, dando un total de aproximadamente 44
gemas</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="14-rails/02-rails-gems/2">
<h1>M&#xE1;s gemas</h1>

<ul>
<li>Adem&#xE1;s de la gema de rails, el comando <code>rails new</code> agrega otras gemas:

<ul>
<li><a href="https://github.com/luislavena/sqlite3-ruby">sqlite3</a> - adaptador para bases de datos SQLite</li>
<li><a href="https://github.com/rails/sass-rails">sass-rails</a> - habilita el uso de sintaxis SCSS para los estilos</li>
<li><a href="https://github.com/lautis/uglifier">uglifier</a> - compresor de JavaScript</li>
<li><a href="https://github.com/rails/coffee-rails">coffee-rails</a> - habilita el uso de sintaxis CoffeeScript para JavaScript</li>
<li><a href="https://github.com/rails/jquery-rails">jquery-rails</a> - agrega la librer&#xED;a JavaScript jQuery </li>
<li><a href="https://github.com/rails/turbolinks">turbolinks</a> - t&#xE9;cnica que acelera la carga de p&#xE1;ginas web</li>
<li><a href="https://github.com/rails/jbuilder">jbuilder</a> - utilidad para la codificacion de datos en JSON</li>
</ul></li>
</ul>

<p>Puede que no se utilice ni SQLite, SCSS, jQuery u otras gemas, pero la mayor&#xED;a
de los desarrollos las utilizan y por ello se consideran</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="14-rails/02-rails-gems/3">
<h1>Algunas gemas &#xFA;tiles</h1>

<ul>
<li>De prop&#xF3;sito general

<ul>
<li><a href="https://github.com/softace/activerecord-tableless">activerecord-tableless</a> - permite usar modelos de Rails sin bases de datos</li>
<li><a href="https://github.com/thoughtbot/high_voltage">high_voltage</a> - Para la creaci&#xF3;n de p&#xE1;ginas est&#xE1;ticas como <em>about</em></li>
<li><a href="https://github.com/laserlemon/figaro">figaro</a> - Para la configuracion del
proyecto</li>
<li><a href="https://github.com/plataformatec/simple_form">simple_form</a> - simplifica el uso de forms</li>
</ul></li>
<li>Para mejorar el estilo visual

<ul>
<li><a href="https://github.com/Compass/compass-rails">compass-rails</a> - simplifica el manejo de estilos para poder usar <a href="http://foundation.zurb.com/">Zurb Fundation</a> por ejemplo</li>
<li><a href="https://github.com/zurb/foundation">zurb-foundation</a> - front-end framework</li>
</ul></li>
<li>Para simplificar la labor de desarrollo

<ul>
<li><a href="https://github.com/charliesome/better_errors">better_errors</a> - simplifica
la b&#xFA;squeda de errores</li>
<li><a href="https://github.com/evrone/quiet_assets">quiet_assets</a> - elimina mensajes
que distraen en los logs</li>
<li><a href="https://github.com/RailsApps/rails_layout">rails_layout</a> - genera archivos para el layout de la aplicaci&#xF3;n usando Twitter Bootstrap o Zurb Fundation</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="14-rails/03-configuracion/1">
<h1>Configuraciones</h1>

<ul>
<li>Rails es conocido por su lema: <strong>convention over configuration</strong>

<ul>
<li>Al aplicarlo, se reducen muchas configuraciones</li>
<li>No todas las configuraciones pueden eliminarse</li>
<li>Las aplicaciones requieren credenciales o API keys para poder funcionar</li>
</ul></li>
<li>El verisonado con <strong>git</strong> debe evitar el guardado de estas credenciales</li>
<li>Una buena pr&#xE1;ctica para configurar estos datos es usar variables de entorno
dado que:

<ul>
<li>La soportan todos SO como Windows, Mac y Linux, as&#xED; como Heroku y otras
plataformas de deployment</li>
<li>Las variables de ambiente pueden accederse desde ruby</li>
<li>Mantienen la privacidad del proyecto de forma independiente</li>
<li>La gema <strong><a href="https://github.com/laserlemon/figaro">figaro</a></strong> permite setear
variables desde el shell o desde un archivo de configuraci&#xF3;n</li>
<li>La gema <strong><a href="https://github.com/bkeepers/dotenv">dotenv</a></strong> permite setear</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="14-rails/03-configuracion/2">
<h1>C&#xF3;mo usar las variables de entorno</h1>

<ul>
<li>Las variables de entorno se usan mediante la constante <strong>ENV</strong>. </li>
<li>Supongamos que se necesita configurar en alguna parte de nuestra aplicaci&#xF3;n
rails, un servidor de mail</li>
</ul>

<h2>Ejemplo de configuraci&#xF3;n de mail</h2>

<pre class="sh_ruby"><code>config.action_mailer.smtp_settings = {
  address: "smtp.gmail.com",
  port: 587,
  domain: ENV["DOMAIN_NAME"],
  authentication: "plain",
  enable_starttls_auto: true,
  user_name: ENV["GMAIL_USERNAME"],
  password: ENV["GMAIL_PASSWORD"]
}</code></pre>

<p>&#xBF;De qu&#xE9; forma seteamos los valores <strong>DOMAIN_NAME</strong>, <strong>GMAIL_USERNAME</strong> y <strong>GMAIL_PASSWORD</strong>?</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="14-rails/03-configuracion/3">
<h1>Como setear las variables con figaro</h1>

<pre class="sh_ruby"><code>gem 'figaro'</code></pre>

<h2>Instalamos la gema con bundler</h2>

<pre class="sh_bash"><code>$ bundle install
...
Using rails (4.0.1) 
Installing figaro (0.7.0) 
Using jbuilder (1.5.2) 
...</code></pre>

<h2>Verificamos se instal&#xF3;</h2>

<pre class="sh_bash"><code>$ bundle exec rails generate
...
Figaro:
    figaro:install
...</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="14-rails/03-configuracion/4">
<h1>Usando figaro</h1>

<ul>
<li>Esta gema setea las variables de entorno antes de hacer cualquier otra cosa</li>
<li>Los valores se leen desde un archivo: <code>config/application.yml</code></li>
<li>La gema entra en acci&#xF3;n cuando se ejecute: <code>rails generate figaro:install</code></li>
<li>Al instalar figaro, se crea el archivo <code>config/application.yml</code> y apendea al
<code>.gitignore</code> que se ignore esta configuracion

<ul>
<li><em>De esta forma, los valores quedar&#xE1;n privados y no en el repositorio de git</em></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="14-rails/03-configuracion/5">
<h1>Usando figaro</h1>

<h2>Instalando figaro</h2>

<pre class="sh_bash"><code>$ bundle exec rails generate figaro:install
        create  config/application.yml
        append  .gitignore</code></pre>

<h2>Editamos <code>config/application.yml</code></h2>

<pre class="sh_yaml"><code>GMAIL_USERNAME: mygmailusername
GMAIL_PASSWORD: mygmailpassword
development:
  GMAIL_USERNAME: otherusername
  GMAIL_PASSWORD: otherpassword</code></pre>

<p><em>Podemos setear las variables seg&#xFA;n el entorno</em></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="14-rails/04-routing-y-static-pages/1">
<h1>P&#xE1;ginas est&#xE1;ticas y ruteo</h1>

<ul>
<li>Una aplicaci&#xF3;n rails puede servir p&#xE1;ginas est&#xE1;ticas como cualquier web server</li>
<li>Estas p&#xE1;ginas no contienen c&#xF3;digo ruby

<ul>
<li>Esto hace que se sirvan de forma m&#xE1;s r&#xE1;pida y usando menos recursos</li>
</ul></li>
<li>Empezar por crear p&#xE1;ginas est&#xE1;ticas nos ayudar&#xE1; a entender el ruteo en rails</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="14-rails/04-routing-y-static-pages/2">
<h1>Agregamos la home page</h1>

<ul>
<li>Nos aseguramos tener iniciado el server rails: <code>bundle exec rails s</code></li>
<li>Ingresamos a <a href="http://localhost:3000/">http://localhost:3000/</a>

<ul>
<li>Veremos la p&#xE1;gina de informaci&#xF3;n por defecto de rails</li>
</ul></li>
</ul>

<h2>Creemos el archivo <code>public/index.html</code></h2>

<pre class="sh_html"><code>&lt;h1&gt; Hello World &lt;/h1&gt;</code></pre>

<ul>
<li>Actualizamos la p&#xE1;gina y...</li>
<li>rails observar&#xE1; los cambios de la carpeta <code>public/</code></li>
<li>Si no se especifica ningun archivo en la URL, se asume <strong>index.html</strong>

<ul>
<li>La raz&#xF3;n de este hecho data de 1993 con la creaci&#xF3;n del primer web server</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="14-rails/04-routing-y-static-pages/3">
<h1>Error de ruteo</h1>

<ul>
<li>Qu&#xE9; sucede si accedemos a <a href="http://localhost:3000/about.html">http://localhost:3000/about.html</a></li>
</ul>

<p><img src="./file/14-rails/01-routing-error.png" alt="routing error"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="14-rails/04-routing-y-static-pages/4">
<h1>Agregamos <code>public/about.html</code></h1>

<pre class="sh_html"><code>&lt;h1&gt; About &lt;/h1&gt;</code></pre>

<p><em>Ahora todo deber&#xED;a funcionar bien</em></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="14-rails/04-routing-y-static-pages/5">
<h1>Introduciendo el ruteo</h1>

<ul>
<li>El principio de <em>convention over configuration</em> gobierna el ruteo en rails</li>
<li>Si un navegador solicita <strong>index.html</strong> entonces Rails servir&#xE1; la p&#xE1;gina desde
el directorio <code>public/</code> por defecto

<ul>
<li>No se necesita configuraci&#xF3;n para ello</li>
</ul></li>
<li>&#xBF;Si queremos cambiar este comportamiento?

<ul>
<li>Haremos que la home page sea ahora el about</li>
<li>Debemos <strong>eliminar</strong> public/index.html: <code>rm public/index.html</code></li>
</ul></li>
</ul>

<h2>Editamos <code>config/routes.rb</code></h2>

<pre class="sh_ruby"><code>LearnRails::Application.routes.draw do
    root to: redirect('/about.html')
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="14-rails/04-routing-y-static-pages/6">
<h1>Una reflexi&#xF3;n</h1>

<ul>
<li>El caso anterior es un ejemplo de la <em>magia de rails</em> </li>
<li>Algunos desarrolladores consideran que <em>convention over configuration</em> es
<strong>magia negra</strong></li>
<li>No es obvio el por qu&#xE9; las p&#xE1;ginas se sirven de <code>public/</code></li>
<li>Si se desconoce esta convenci&#xF3;n, podemos rompernos la cabeza buscando donde se
mapea que http://localhost:3000 sirva <code>public/index.html</code>

<ul>
<li>El c&#xF3;digo que implementa esto, est&#xE1; enterrado profundamente en el coraz&#xF3;n de
rails</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="14-rails/05-ciclo-request-response/1">
<h1>Request &amp; response</h1>

<ul>
<li>Analizaremos el patron MVC desde la perspectiva de la web</li>
<li>Debemos considerar que la WEB no es m&#xE1;s que navegadores que solicitan p&#xE1;ginas
a un servidor</li>
<li>Los navegadores realizan <strong>requerimientos</strong> (request)</li>
<li>Los servidores <strong>responden</strong> (response) a estos requerimientos, enviando, por ejemplo, un
HTML.

<ul>
<li>Dependiendo en los encabezados del HTML, el navegador deber&#xE1; realizar m&#xE1;s
requerimientos para obtener estilos, javascripts e imagenes</li>
</ul></li>
<li>La simplicidad de HTTP hace que no haya m&#xE1;s que los requerimientos de un
navegador y las respuestas de un servidor

<ul>
<li>Hoy d&#xED;a existe adem&#xE1;s el streaming de audio/video que requieren un pipe
entre el navegador y el servidor, pero a&#xFA;n as&#xED;, un requerimiento y respuesta inicial 
hacen posible la incializaci&#xF3;n del stream</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="14-rails/05-ciclo-request-response/2">
<h1>El ciclo request / response</h1>

<p><img src="./file/14-rails/02-request-response.png" alt="request repsonse"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="14-rails/05-ciclo-request-response/3">
<h1>Analizando el ciclo desde el navegador</h1>

<ul>
<li>Es aconsejable usar <a href="https://www.google.com/chrome">Google Chrome</a></li>
<li>Antes de investigar algo, es conveniente utilizar el <strong>modo inc&#xF3;gnito</strong>: que
se accede usando <strong>Shift+Ctrl+N</strong> (<strong>Shift+Ctrl+P</strong> en Firefox)

<ul>
<li>Alternativamente puede limpiarse la cach&#xE9; del navegador para as&#xED; limpiar
cualquier solicitud previamente cacheada por el navegador </li>
</ul></li>
<li>Abrimos la vista <em>Developer Tools</em> usando <strong>Shift+Ctrl+I</strong>

<ul>
<li>Seleccionamos el tab <strong>Network</strong></li>
<li>Realizamos el requerimiento <a href="http://localhost:3000/about.html">http://localhost:3000/about.html</a></li>
<li>Visualizaremos los archivos recibidos desde el servidor: s&#xF3;lo uno
<strong>about.html</strong></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="14-rails/05-ciclo-request-response/4">
<h1>Analizando el ciclo desde el navegador</h1>

<h2>As&#xED; debe verse el requerimiento</h2>

<p><img src="./file/14-rails/03-navegador-ok.png" alt="ejemplo chrome ok"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="14-rails/05-ciclo-request-response/5">
<h1>Analizando el ciclo desde el navegador</h1>

<h2>Notar cuando no es "fresco" el requerimineto</h2>

<p><img src="./file/14-rails/03-navegador-not-ok.png" alt="ejemplo chrome ok"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="14-rails/05-ciclo-request-response/6">
<h1>El detalle del requerimiento</h1>

<p>Cliqueando sobre el nombre del archivo, y luego sobre la solapa <strong>Headers</strong>, se visualiza el detalle del requerimiento y su respuesta</p>

<p><img src="./file/14-rails/04-navegador-detalle.png" alt="ejemplo chrome detalle"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="14-rails/05-ciclo-request-response/7">
<h1>Analizamos lo que muestra el navegador</h1>

<ul>
<li>Que el requerimiento se compone de:

<ul>
<li>Un request a la URL http://localhost:3000/about.html </li>
<li>Que el m&#xE9;todo HTTP empleado fue GET</li>
<li>Los headers del request incluyendo cookies y el identificador del UA</li>
</ul></li>
<li>La respuesta se compone de:

<ul>
<li>El c&#xF3;digo de estado: 200 OK o 304 Not modified</li>
<li>Los headers de la respuesta: incluyendo fecha y hora, as&#xED; como el
identificador del servidor</li>
<li>HTML</li>
</ul></li>
</ul>

<p>Ahora podemos analizar c&#xF3;mo el requerimiento a <strong>http://localhost:3000/</strong>
devuelve dos entradas por el redirect</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="14-rails/05-ciclo-request-response/8">
<h1>Analizamos ahora desde el lado del servidor</h1>

<ul>
<li>Hasta ahora vimos las herramientas que disponemos desde el navegador

<ul>
<li>Pero no podemos visualizar qu&#xE9; es lo que sucede en el servidor</li>
</ul></li>
</ul>

<h2>La ventana de consola del servidor muestra:</h2>

<pre class="sh_bash"><code>Started GET "/" for 127.0.0.1 at ...</code></pre>

<ul>
<li>Es importante destacar que no hay logs para los archivos servidos desde la
carpeta <code>public/</code></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="14-rails/05-ciclo-request-response/9">
<h1>MVC</h1>

<p>El siguiente gr&#xE1;fico muestra qu&#xE9; sucede en el servidor durante el ciclo
request-response </p>

<p><img src="./file/14-rails/05-ciclo-completo-rails.png" alt="ciclo request response"/>

<p>Algunos expertos opinan que la arquitectura de la web no se ajusta al original
  dise&#xF1;o de MVC creado para aplicaciones visuales de escritorio</p>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="14-rails/05-ciclo-request-response/10">
<h1>MVC en rails</h1>

<p><img src="./file/14-rails/06-mvc-rails.png" alt="MVC en rails"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="14-rails/05-ciclo-request-response/11">
<h1>MVC en rails</h1>

<ul>
<li>En la base del stack est&#xE1; el navegador: el requerimiento fluye subiendo por
las capas hasta llegar al <strong>router</strong> que despachar&#xE1; al controlador apropiado</li>
<li>Existe un &#xFA;nico <code>config/routes.rb</code> y m&#xFA;ltiples controladores, modelos y vistas</li>
<li>El controlador, al recibir el flujo, obtendr&#xE1; datos de alg&#xFA;n <strong>modelo</strong></li>
<li>Con los datos listos, el controlador renderizar&#xE1; la respuesta combinando los
datos del modelo con una componente de <strong>vista</strong> que provea layout y markup</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="14-rails/05-ciclo-request-response/12">
<h1>MVC en rails</h1>

<ul>
<li>Los archivos del model, controller y view ser&#xE1;n c&#xF3;digo ruby</li>
<li>Cada archivo tendr&#xE1; una estructura y sintaxis espec&#xED;fica basada en c&#xF3;mo se ha
definido por el mismo framework</li>
<li>Cada model, view y controller que creemos <em>heradar&#xE1;</em> comportamiento de
superclases que son parte del farmework, minimizando lo que debemos codificar</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="14-rails/05-ciclo-request-response/13">
<h1>Models en Rails</h1>

<ul>
<li>En la mayor parte de las aplicaciones rails, un modelo obtiene datos de una base de datos</li>
<li>Sin embargo, en otros casos se obtienen de conexiones a otros servidores</li>
<li>Ejemplos:

<ul>
<li>El model <strong>User</strong> podr&#xED;a obtener el nombre y email desde una base de datos
local</li>
<li>El mismo modelo, podr&#xED;a adem&#xE1;s obtener los tweets recientes de Twitter para
este mismo usuario, o la ciudad en la que vive desde Facebook</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="14-rails/05-ciclo-request-response/14">
<h1>Controllers en Rails</h1>

<ul>
<li>Un controlador podr&#xED;a obtener datos de m&#xE1;s de un modelo si fuera necesario</li>
<li>Generalmente un controlador posee m&#xE1;s de una <strong>acci&#xF3;n</strong>.
Por ejemplo, un controlador para User podr&#xED;a tener acciones para listar los
usuarios, agregar o eliminar un usuario de la lista</li>
<li>El archivo <code>config/routes.rb</code> machear&#xE1; el requermiento web a una acci&#xF3;n del
controlador</li>
<li>En Rails se trata de limitar las acciones en un controlador a las siete
acciones siguientes: <code>index</code>, <code>show</code>, <code>new</code>, <code>create</code>, <code>edit</code>, <code>update</code> y
<code>destroy</code>

<ul>
<li>Un controlador que implementa estas acciones se dice que es <strong>RESTful</strong></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="14-rails/05-ciclo-request-response/15">
<h1>Views en Rails</h1>

<ul>
<li>Una vista combina c&#xF3;digo ruby con markup HTML. </li>
<li>Generalmente tendremos una vista asociada a cada acci&#xF3;n de un controlador

<ul>
<li>Una vista para <strong>index</strong> deber&#xED;a mostrar una lista de usuarios</li>
<li>La vista <strong>show</strong> proveer&#xE1; detalles del perfil de un usuario</li>
</ul></li>
<li>Las vistas tendr&#xE1;n una sintaxis muy similar a HTML convencional, pero con
algunos datos que se extraen de variables ruby o estructuras de control como
loops que permitir&#xE1;n crear tablas.

<ul>
<li>Siguiendo el principio de SoC, es considerada una buena pr&#xE1;ctica limitar el
uso de c&#xF3;digo ruby en las vistas a s&#xF3;lo utilizarlo para imprimir valores de
variables.</li>
<li>Cualquier otra cosa ser&#xE1; responsabilidad del modelo</li>
</ul></li>
<li>No todas las acciones tendr&#xE1;n una vista: por ejemplo la acci&#xF3;n <strong>destroy</strong>
usualmente redirige al <strong>index</strong>, y <strong>create</strong> redirige o al <strong>show</strong> o al
<strong>new</strong></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="14-rails/06-home-dinamica/1">
<h1>Home din&#xE1;mica</h1>

<p>Planificamos nuestro trabajo definiendo un User story</p>

<pre><code>*Birthday countdown*
As a visitor to the website
I want to see the owner's name
I want to see the owner's birthdate
I want to see how many days until the 
  owner's next birthday
In order to send birthday greetings</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="14-rails/06-home-dinamica/2">
<h1>La elecci&#xF3;n de nombres</h1>

<ul>
<li>Mucho en el arte de la programaci&#xF3;n radica en elegir nombres correctos para
nuestras creaciones</li>
<li>Necesitamos un modelo que represente el site owner. 

<ul>
<li>Elegiremos el nombre m&#xE1;s obvio: <strong>Owner</strong> y cremos el archivo
<code>app/models/owner.rb</code></li>
</ul></li>
<li>El nombre del controlador abre otro debate

<ul>
<li>Nos podr&#xED;amos tentar por <em>Home controller</em> o <em>Welcome controller</em></li>
<li>Si bien son nombres aceptables, si consideramos el <strong>User Story</strong> el nombre
<strong>Visitors controller</strong> es m&#xE1;s adecuado porque <strong>visitor</strong> es el actor</li>
<li>Creamos entonces <code>app/controllers/visitors_controller.rb</code></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="14-rails/06-home-dinamica/3">
<h1>Convenciones de nombres</h1>

<ul>
<li>En rails es importante como se llaman los archivos y clases definidas en
ellos.</li>
<li>Esto se debe al principio CoC</li>
<li>Esto evita configuraciones innecesarias</li>
<li>Al escribir c&#xF3;digo

<ul>
<li><code>class Visitor &lt; ActiveRecord::Base</code> - los nombres de las clases de modelo
son en singular y en may&#xFA;scula</li>
<li><code>class VisitorsController &lt; ApplicationController</code> - los nombres de
controladores son la combinaci&#xF3;n de un nombre de modelo en singular con
<em>Controller</em> en camel case</li>
</ul></li>
<li>Los archivos:

<ul>
<li>Los archivos de modelo coinciden con el nombre del modelo , pero en
min&#xFA;scula: <code>app/models/visitor.rb</code></li>
<li>Los archvios de controlador coinciden con la clase, pero usando snake case:
<code>app/controllers/visitors_controller.rb</code></li>
<li>La carpeta de las vistas coinciden con el nombre de la clase del modelo,
pero en plural y en min&#xFA;scula: <code>app/views/visitors</code></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="14-rails/06-home-dinamica/4">
<h1>Routing</h1>

<p>Crearemos primero el ruteo antes de implementar el model y controller</p>

<h2>Editamos <code>config/routes.rb</code></h2>

<pre class="sh_ruby"><code>LearnRails::Application.routes.draw do
    root to: 'visitors#new'
end</code></pre>

<ul>
<li>Notramos que el nombre del m&#xF3;dulo donde se define <strong>Application.routes</strong> es
<strong>LearnRails</strong>

<ul>
<li>Esto se debe al nombre de la aplicaci&#xF3;n que creamos con el comando <code>rails
new learn_rails</code></li>
</ul></li>
<li>Los detalles de la sintaxis en el arcchivo <code>config/routes.rb</code> pueden
entenderse bien leyendo <a href="http://guides.rubyonrails.org/routing.html">Rails Guide: Routing from outside in</a></li>
<li>Modificando <code>config/routes.rb</code> no requiere reiniciar la aplicaci&#xF3;n</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="14-rails/06-home-dinamica/5">
<h1>Probamos http://localhost:3000</h1>

<h2>Esperamos obtener un error</h2>

<p><img src="./file/14-rails/07-no-better-errors.png" alt="Error sin better errors"/>

<p>El error es claro: <strong>uninitialized constant VisitorsController</strong> indicando que
Rails busca la clase y no puede encontrarla</p>

<p>Podemos mejorar el error agregando la gema <code>better_errors</code> al <code>Gemfile</code></p>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="14-rails/06-home-dinamica/6">
<h1>El mismo error con better_errors</h1>

<h2>Mensajes m&#xE1;s claros</h2>

<p><img src="./file/14-rails/07-better-errors-no-repl.png" alt="Error better errors"/>

<p>Si hacemos caso al mensaje marcado en rojo, podemos agregar una consola REPL
como irb que nos permitir&#xE1; debugear el c&#xF3;digo. 
El mensaje sugiere agregar la gema <code>binding_of_caller</code> al <code>Gemfile</code></p>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="14-rails/06-home-dinamica/7">
<h1>El mismo error con better_errors</h1>

<h2>Mensajes m&#xE1;s claros + consola</h2>

<p><img src="./file/14-rails/07-better-errors-repl.png" alt="Error better errors"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="14-rails/06-home-dinamica/8">
<h1>El modelo</h1>

<ul>
<li>La mayor&#xED;a de los modelos rails obtienen datos desde una base de datos</li>
<li>Cuando se utiliza una base de datos, es posible usar el comando: <code>rails
generate model</code> para crear un modelo que hereda de <strong>ActiveRecord</strong>
y conoce como conectarse con la base de datos</li>
<li>Para este ejemplo no necesitamos una base de datos

<ul>
<li>Nuestra clase simplemente definir&#xE1; los m&#xE9;todos necesarios</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="14-rails/06-home-dinamica/9">
<h1>Implementamos el Modelo</h1>

<pre class="sh_ruby"><code>class Owner
    def name
        name = 'Foobar Kadigan'
    end

    def birthdate
        birthdate = Date.new(1990, 12, 22)
    end

    def countdown
        today = Date.today
        birthday = Date.new(today.year, 
                        birthdate.month, 
                        birthdate.day)
        if birthday &gt; today
            countdown = (birthday - today).to_i
        else
            countdown = (birthday.next_year - today).to_i
        end
    end

end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="14-rails/06-home-dinamica/10">
<h1>La Vista</h1>

<ul>
<li>Como ya mencionamos en las convenciones de nombres, las vistas van en
<code>app/views/</code></li>
<li>En una aplicaci&#xF3;n convencional, un controlador puede renderizar m&#xFA;ltiples
vistas, por lo tanto se crea un directorio para cada controlador

<ul>
<li>En nuestro caso creamos <code>mkdir app/views/visitors</code></li>
</ul></li>
</ul>

<h2>Creamos entonces <code>app/views/visitors/new.html.erb</code></h2>

<pre class="sh_html"><code>&lt;h3&gt;Home&lt;/h3&gt;
&lt;p&gt;Welcome to the home of &lt;%= @owner.name %&gt;.&lt;/p&gt;
&lt;p&gt;I was born on &lt;%= @owner.birthdate %&gt;.&lt;/p&gt;
&lt;p&gt;Only &lt;%= @owner.countdown %&gt; days until my birthday!&lt;/p&gt;</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="14-rails/06-home-dinamica/11">
<h1>La Vista</h1>

<ul>
<li>Con lo anterior tenemos &#xFA;nicamente la vista <strong>new</strong> para el controlador
visitor</li>
<li>La extensi&#xF3;n es <strong>erb</strong> porque usamos el motor ERB para armar nuestros
templates</li>
<li>En el ejemplo, y por defecto en rails, se utiliza ERB en rails, pero es posible utilizar gemas que
proveen <a href="http://railsapps.github.io/rails-haml.html">Haml</a> o <a href="http://slim-lang.com/">Slim</a> como motores de templating. 

<ul>
<li>Si usaramos por ejemplo haml, la vista ser&#xED;a <strong>new.html.haml</strong></li>
</ul></li>
<li>En la vista, podemos ver que el markup de ERB utiliza los tags <code>&lt;%=</code> y
<code>%&gt;</code></li>
<li>El acceso a los datos del modelo <strong>Owner</strong> se hace a trav&#xE9;s de <code>@owner</code>

<ul>
<li>Esto se entender&#xE1; mejor cuando creemos el controlador</li>
</ul></li>
<li>Podr&#xED;amos preguntarnos por qu&#xE9; usar <code>&lt;%= @owner.countdown %&gt;</code> en vez de <code>&lt;%=
(Date.new(today.year, @owner.birthdate.month, @owner.birthdate.day) -
Date.today).to_i %&gt;</code>

<ul>
<li>Podr&#xED;amos hacerlo, pero violar&#xED;amos SoC</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="14-rails/06-home-dinamica/12">
<h1>El controlador</h1>

<ul>
<li>Ser&#xE1; el <em>pegamento</em> entre el modelo Owner y la vista
<strong>VisitorsController#new</strong>

<ul>
<li>Cuando hagamos referencia a una acci&#xF3;n en un controlador, usaremos la
notaci&#xF3;n <em>VisitorsController#new</em> uniendo el nombre de la clase del
controlador con el de la acci&#xF3;n (que es un m&#xE9;todo). En este contexto, el
caracter <strong>#</strong> es una convenci&#xF3;n usada en la documentaci&#xF3;n </li>
<li>El nombre de la clase ser&#xE1; <code>VisitorsController</code> pero el nombre del archivo
<strong>visitors_controller.rb</strong></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="14-rails/06-home-dinamica/13">
<h1>Escribimos el controlador</h1>

<h2>Creamos <code>app/controllers/visitors_controller.rb</code></h2>

<pre class="sh_ruby"><code>class VisitorsController &lt; ApplicationController
    def new
        @owner = Owner.new
    end
end</code></pre>

<h2>&#xBF;Qu&#xE9; hace?</h2>

<ul>
<li>Al ser subclase de ApplicationController hereda todo el comportamiento
definido por la API de rails</li>
<li>Solo implementa el m&#xE9;todo <code>new</code>

<ul>
<li>Creamos una variable de instancia <code>@owner</code> dado que en la vista
correspondiente estar&#xE1; disponible. </li>
<li>El controller se comunica con la vista a trav&#xE9;s de variables de instancia</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="14-rails/06-home-dinamica/14">
<h1>Relaci&#xF3;n controlador y vista</h1>

<ul>
<li>Ya creamos una vista llamada <code>app/views/visitors/new.html.erb</code></li>
<li>El controlador es muy simple dado que el comportamiento oculto que invoca la
vista <em>new</em> es heredado de la API de rails.

<ul>
<li>Podemos hacer expl&#xED;cita esta relaci&#xF3;n</li>
</ul></li>
</ul>

<h2>Indicando qu&#xE9; vista usar en el controlador</h2>

<pre class="sh_ruby"><code>class VisitorsController &lt; ApplicationController
    def new
        @owner = Owner.new
        render 'visitors/new'
    end
end</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="14-rails/06-home-dinamica/15">
<h1>Scaffolding</h1>

<ul>
<li>La mejor forma de entender la arquitectura MVC de rails es examinando cada una
de las partes como hemos hecho hasta aqu&#xED;</li>
<li>Si se lee la gu&#xED;a de rails: <a href="http://guides.rubyonrails.org/getting_started.html">Rails Guides: Getting Started with Rails</a> veremos que se utiliza mucho el comando <code>rails generate scaffold</code> que permite crear MVC en una &#xFA;nica operaci&#xF3;n

<ul>
<li>Esta operaci&#xF3;n es muy usada para desarrollar m&#xF3;dulos simples en rails</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="14-rails/07-resolviendo-problemas/1">
<h1>Resolviendo problemas</h1>

<ul>
<li>Veremos algunas t&#xE9;cnicas que ayudan a resolver problemas

<ul>
<li>Rails console</li>
<li>Rails logger</li>
<li>Stack trace</li>
<li>Raising exceptions</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="14-rails/07-resolviendo-problemas/2">
<h1>Rails console</h1>

<ul>
<li>IRB solamente eval&#xFA;a expresiones que so definidas por la API de ruby</li>
<li>IRB no conoce las clases de rails</li>
<li>Rails console carga toda la aplicaci&#xF3;n rails en una consola IRB</li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_bash"><code>$ bundle exec rails console
Loading development environment (Rails 4.0.1)
irb(main):001:0&gt; </code></pre>

<p><em>Notamos que se carg&#xF3; el ambiente de development</em></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets" ref="14-rails/07-resolviendo-problemas/3">
<h1>Rails console</h1>

<h2>Inspeccionamos el modelo</h2>

<pre class="sh_bash"><code>irb(main):001:0&gt; owner = Owner.new
=&gt; #&lt;Owner:0x007f7eccd77e48&gt;

irb(main):002:0&gt; owner.name
=&gt; "Foobar Kadigan"</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="14-rails/07-resolviendo-problemas/4">
<h1>Rails logger</h1>

<ul>
<li>Las aplicaciones rails env&#xED;an informaci&#xF3;n de diagn&#xF3;stico a un <em>archivo de log</em></li>
<li>Dependiendo del ambiente en el que corre la aplicaci&#xF3;n, el log ser&#xE1;:

<ul>
<li><strong>log/development.log</strong></li>
<li><strong>log/production.log</strong></li>
</ul></li>
<li>En el ambiente de desarrollo, todo log escrito en el archivo es adem&#xE1;s enviado
a la consola de donde se corre el comando <code>rails server</code></li>
<li>Adem&#xE1;s de los logs por defecto de rails, podemos usar nosotros en <strong>logger</strong></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="14-rails/07-resolviendo-problemas/5">
<h1>Rails logger</h1>

<h2>Modificamos <code>app/controllers/visitors_controller.rb</code></h2>

<pre class="sh_ruby"><code>class VisitorsController &lt; ApplicationController
    def new
        Rails.logger.debug 'DEBUG: entering new method'
        @owner = Owner.new
        Rails.logger.debug "DEBUG: Owner name is #{@owner.name}"
    end
end</code></pre>

<h2>Ahora la salida en la consola ser&#xE1;</h2>

<pre class="sh_bash"><code>Started GET "/" for 127.0.0.1 at ...
Processing by VisitorsController#new as HTML
DEBUG: entering new method
DEBUG: Owner name is Foobar Kadigan
Rendered visitors/new.html.erb within layouts/application (0.2ms)
Completed 200 OK in 8ms (Views: 4.6ms | ActiveRecord: 0.0ms)</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="14-rails/07-resolviendo-problemas/6">
<h1>Rails logger</h1>

<ul>
<li>Podemos usar <strong>Rails.logger</strong> en nuestros modelos</li>
<li>En los controladores, es posible usar el m&#xE9;todo <strong>logger</strong> directamente</li>
<li>Es posible usar:

<ul>
<li><code>logger.debug</code></li>
<li><code>logger.info</code></li>
<li><code>logger.warn</code></li>
<li><code>logger.error</code></li>
<li><code>logger.fatal</code></li>
</ul></li>
<li>En el ambiente de desarrollo todos los logs se mostrar&#xE1;n</li>
<li>En el ambiente de producci&#xF3;n no se visualizar&#xE1;n los logs enviados a
<code>logger.debug</code></li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets smaller" ref="14-rails/07-resolviendo-problemas/7">
<h1>El Stack Trace</h1>

<ul>
<li>Si bien el logger es muy &#xFA;til, hay casos en donde el programa se colgar&#xE1; y la
consola mostrar&#xE1; un <em>stack trace</em></li>
<li>Provocamos un error agregando en el controlador un error</li>
</ul>

<h2>Generamos el error</h2>

<pre class="sh_ruby"><code>class VisitorsController &lt; ApplicationController
    def new
        Rails.logger.debug 'DEBUG: entering new method'
        @owner = Owner.new
        Rails.logger.debug 'DEBUG: Owner name is ' + @owner.name
        DISASTER
    end
end</code></pre>

<h2>Al ingresar a la p&#xE1;gina veremos</h2>

<p><img src="./file/14-rails/08-stacktrace.png" alt="error stack trace"/>
</p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets smaller" ref="14-rails/07-resolviendo-problemas/8">
<h1>El Stack Trace</h1>

<ul>
<li>La captura muestra el error as&#xED; porque usamos la gema <strong>better_errors</strong></li>
</ul>

<h2>En la consola veremos</h2>

<pre class="sh_bash"><code>Started GET "/" for 127.0.0.1 at 2013-12-08 20:09:18 -0300
Processing by VisitorsController#new as HTML
DEBUG: entering new method
DEBUG: Owner name is Foobar Kadigan
Completed 500 Internal Server Error in 2ms

NameError - uninitialized constant VisitorsController::DISASTER:
    activesupport (4.0.1) lib/active_support/dependencies.rb:501:in `load_missing_constant'
    ...</code></pre>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets" ref="14-rails/07-resolviendo-problemas/9">
<h1>El Stack Trace</h1>

<ul>
<li>No hay que sentirse abrumado por la cantidad de informaci&#xF3;n</li>
<li>Muchas veces la explicaci&#xF3;n del problema est&#xE1; en la primer l&#xED;nea</li>
<li>Otras veces tenemos que avanzar sobre la pila leyendo cuidadosamente el
problema</li>
</ul>
</div>
</div><div class="slide" data-transition="uncover"><div class="content smbullets small" ref="14-rails/07-resolviendo-problemas/10">
<h1>Lanzando excepciones</h1>

<ul>
<li>El ejemplo del stack trace hace uso de una directiva desconocida por rails</li>
<li>Una soluci&#xF3;n m&#xE1;s elegante ser&#xED;a lanzar una excepci&#xF3;n</li>
</ul>

<h2>Ejemplo</h2>

<pre class="sh_ruby"><code>class VisitorsController &lt; ApplicationController
def new
    Rails.logger.debug 'DEBUG: entering new method'
        @owner = Owner.new
        Rails.logger.debug ".."
        raise 'Deliberate Failure'
    end
end</code></pre>

<h2>M&#xE1;s recursos...</h2>

<p><a href="http://guides.rubyonrails.org/debugging_rails_applications.html">RailsGuide: Debugging Rails Applications</a></p>
</div>
</div><div class="slide" data-transition="uncover"><div class="content bullets small" ref="14-rails/99-referencias">
<h1>Referencias</h1>

<ul>
<li><a href="http://learn-rails.com/learn-ruby-on-rails.html">Learn Ruby on Rails</a></li>
<li><a href="http://guides.rubyonrails.org/">Rails Guides</a></li>
<li><a href="http://api.rubyonrails.org/">Rails Documentation</a></li>
<li><a href="http://pragtob.github.io/rails-beginner-cheatsheet/index.html">Rails Beginner Cheat Sheet</a></li>
<li><a href="http://railscasts.com/">Railscasts</a></li>
<li><a href="http://37signals.com/svn/posts/3372-put-chubby-models-on-a-diet-with-concerns">Uso de concerns: como poner a dieta los modelos regordetes</a></li>
</ul>
</div>
</div></div>
<div id="pauseScreen">
  
</div>

</body>
</html>
